"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/manifesto.js";
exports.ids = ["vendor-chunks/manifesto.js"];
exports.modules = {

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Annotation.js":
/*!***************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Annotation.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Annotation: () => (/* binding */ Annotation)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar Annotation = /** @class */ (function (_super) {\n    __extends(Annotation, _super);\n    function Annotation(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    Annotation.prototype.getBody = function () {\n        var bodies = [];\n        var body = this.getProperty(\"body\");\n        // todo: make this a generic \"property that can be an object or array enumerator\" util\n        if (body) {\n            if (Array.isArray(body)) {\n                for (var i = 0; i < body.length; i++) {\n                    var b = body[i];\n                    if (b.items) {\n                        for (var i_1 = 0; i_1 < b.items.length; i_1++) {\n                            // todo: don't ignore that it's a choice. maybe add isChoice() to IAnnotationBody?\n                            var c = b.items[i_1];\n                            bodies.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationBody(c, this.options));\n                        }\n                    }\n                    else {\n                        bodies.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationBody(b, this.options));\n                    }\n                }\n            }\n            else if (body.items) {\n                for (var i = 0; i < body.items.length; i++) {\n                    var b = body.items[i];\n                    bodies.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationBody(b, this.options));\n                }\n            }\n            else {\n                bodies.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationBody(body, this.options));\n            }\n        }\n        return bodies;\n    };\n    Annotation.prototype.getMotivation = function () {\n        var motivation = this.getProperty(\"motivation\");\n        if (motivation) {\n            //const key: string | undefined = Object.keys(AnnotationMotivationEnum).find(k => AnnotationMotivationEnum[k] === motivation);\n            return motivation;\n        }\n        return null;\n    };\n    // open annotation\n    Annotation.prototype.getOn = function () {\n        return this.getProperty(\"on\");\n    };\n    Annotation.prototype.getTarget = function () {\n        return this.getProperty(\"target\");\n    };\n    Annotation.prototype.getResource = function () {\n        return new _internal__WEBPACK_IMPORTED_MODULE_0__.Resource(this.getProperty(\"resource\"), this.options);\n    };\n    return Annotation;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=Annotation.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQW5ub3RhdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDdUU7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxpQkFBaUI7QUFDakQ7QUFDQTtBQUNBLDBDQUEwQyxzQkFBc0I7QUFDaEU7QUFDQTtBQUNBLDRDQUE0QyxxREFBYztBQUMxRDtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MscURBQWM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsdUJBQXVCO0FBQ3ZEO0FBQ0Esb0NBQW9DLHFEQUFjO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxxREFBYztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLCtDQUFRO0FBQzNCO0FBQ0E7QUFDQSxDQUFDLENBQUMsdURBQWdCO0FBQ0k7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9Bbm5vdGF0aW9uLmpzP2YxOTMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBBbm5vdGF0aW9uQm9keSwgTWFuaWZlc3RSZXNvdXJjZSwgUmVzb3VyY2UgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIEFubm90YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFubm90YXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQW5ub3RhdGlvbihqc29ubGQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCwgb3B0aW9ucykgfHwgdGhpcztcbiAgICB9XG4gICAgQW5ub3RhdGlvbi5wcm90b3R5cGUuZ2V0Qm9keSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJvZGllcyA9IFtdO1xuICAgICAgICB2YXIgYm9keSA9IHRoaXMuZ2V0UHJvcGVydHkoXCJib2R5XCIpO1xuICAgICAgICAvLyB0b2RvOiBtYWtlIHRoaXMgYSBnZW5lcmljIFwicHJvcGVydHkgdGhhdCBjYW4gYmUgYW4gb2JqZWN0IG9yIGFycmF5IGVudW1lcmF0b3JcIiB1dGlsXG4gICAgICAgIGlmIChib2R5KSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShib2R5KSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm9keS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGJvZHlbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChiLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpXzEgPSAwOyBpXzEgPCBiLml0ZW1zLmxlbmd0aDsgaV8xKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0b2RvOiBkb24ndCBpZ25vcmUgdGhhdCBpdCdzIGEgY2hvaWNlLiBtYXliZSBhZGQgaXNDaG9pY2UoKSB0byBJQW5ub3RhdGlvbkJvZHk/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLml0ZW1zW2lfMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9kaWVzLnB1c2gobmV3IEFubm90YXRpb25Cb2R5KGMsIHRoaXMub3B0aW9ucykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYm9kaWVzLnB1c2gobmV3IEFubm90YXRpb25Cb2R5KGIsIHRoaXMub3B0aW9ucykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYm9keS5pdGVtcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm9keS5pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGJvZHkuaXRlbXNbaV07XG4gICAgICAgICAgICAgICAgICAgIGJvZGllcy5wdXNoKG5ldyBBbm5vdGF0aW9uQm9keShiLCB0aGlzLm9wdGlvbnMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBib2RpZXMucHVzaChuZXcgQW5ub3RhdGlvbkJvZHkoYm9keSwgdGhpcy5vcHRpb25zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJvZGllcztcbiAgICB9O1xuICAgIEFubm90YXRpb24ucHJvdG90eXBlLmdldE1vdGl2YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtb3RpdmF0aW9uID0gdGhpcy5nZXRQcm9wZXJ0eShcIm1vdGl2YXRpb25cIik7XG4gICAgICAgIGlmIChtb3RpdmF0aW9uKSB7XG4gICAgICAgICAgICAvL2NvbnN0IGtleTogc3RyaW5nIHwgdW5kZWZpbmVkID0gT2JqZWN0LmtleXMoQW5ub3RhdGlvbk1vdGl2YXRpb25FbnVtKS5maW5kKGsgPT4gQW5ub3RhdGlvbk1vdGl2YXRpb25FbnVtW2tdID09PSBtb3RpdmF0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBtb3RpdmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgLy8gb3BlbiBhbm5vdGF0aW9uXG4gICAgQW5ub3RhdGlvbi5wcm90b3R5cGUuZ2V0T24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwib25cIik7XG4gICAgfTtcbiAgICBBbm5vdGF0aW9uLnByb3RvdHlwZS5nZXRUYXJnZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwidGFyZ2V0XCIpO1xuICAgIH07XG4gICAgQW5ub3RhdGlvbi5wcm90b3R5cGUuZ2V0UmVzb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVzb3VyY2UodGhpcy5nZXRQcm9wZXJ0eShcInJlc291cmNlXCIpLCB0aGlzLm9wdGlvbnMpO1xuICAgIH07XG4gICAgcmV0dXJuIEFubm90YXRpb247XG59KE1hbmlmZXN0UmVzb3VyY2UpKTtcbmV4cG9ydCB7IEFubm90YXRpb24gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFubm90YXRpb24uanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Annotation.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationBody.js":
/*!*******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/AnnotationBody.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AnnotationBody: () => (/* binding */ AnnotationBody)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar AnnotationBody = /** @class */ (function (_super) {\n    __extends(AnnotationBody, _super);\n    function AnnotationBody(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    AnnotationBody.prototype.getFormat = function () {\n        var format = this.getProperty(\"format\");\n        if (format) {\n            return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getMediaType(format);\n        }\n        return null;\n    };\n    AnnotationBody.prototype.getType = function () {\n        var type = this.getProperty(\"type\");\n        if (type) {\n            return (_internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(this.getProperty(\"type\")));\n        }\n        return null;\n    };\n    AnnotationBody.prototype.getWidth = function () {\n        return this.getProperty(\"width\");\n    };\n    AnnotationBody.prototype.getHeight = function () {\n        return this.getProperty(\"height\");\n    };\n    return AnnotationBody;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=AnnotationBody.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQW5ub3RhdGlvbkJvZHkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ29EO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNENBQUs7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDRDQUFLO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLHVEQUFnQjtBQUNRO0FBQzFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQW5ub3RhdGlvbkJvZHkuanM/ZWZhYSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IE1hbmlmZXN0UmVzb3VyY2UsIFV0aWxzIH0gZnJvbSBcIi4vaW50ZXJuYWxcIjtcbnZhciBBbm5vdGF0aW9uQm9keSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5ub3RhdGlvbkJvZHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQW5ub3RhdGlvbkJvZHkoanNvbmxkLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBqc29ubGQsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFubm90YXRpb25Cb2R5LnByb3RvdHlwZS5nZXRGb3JtYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmb3JtYXQgPSB0aGlzLmdldFByb3BlcnR5KFwiZm9ybWF0XCIpO1xuICAgICAgICBpZiAoZm9ybWF0KSB7XG4gICAgICAgICAgICByZXR1cm4gVXRpbHMuZ2V0TWVkaWFUeXBlKGZvcm1hdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBBbm5vdGF0aW9uQm9keS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHR5cGUgPSB0aGlzLmdldFByb3BlcnR5KFwidHlwZVwiKTtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiAoVXRpbHMubm9ybWFsaXNlVHlwZSh0aGlzLmdldFByb3BlcnR5KFwidHlwZVwiKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQW5ub3RhdGlvbkJvZHkucHJvdG90eXBlLmdldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eShcIndpZHRoXCIpO1xuICAgIH07XG4gICAgQW5ub3RhdGlvbkJvZHkucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJoZWlnaHRcIik7XG4gICAgfTtcbiAgICByZXR1cm4gQW5ub3RhdGlvbkJvZHk7XG59KE1hbmlmZXN0UmVzb3VyY2UpKTtcbmV4cG9ydCB7IEFubm90YXRpb25Cb2R5IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Bbm5vdGF0aW9uQm9keS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationBody.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationList.js":
/*!*******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/AnnotationList.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AnnotationList: () => (/* binding */ AnnotationList)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar AnnotationList = /** @class */ (function (_super) {\n    __extends(AnnotationList, _super);\n    function AnnotationList(label, jsonld, options) {\n        var _this = _super.call(this, jsonld) || this;\n        _this.label = label;\n        _this.options = options;\n        return _this;\n    }\n    AnnotationList.prototype.getIIIFResourceType = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(this.getProperty(\"type\"));\n    };\n    AnnotationList.prototype.getLabel = function () {\n        return this.label;\n    };\n    AnnotationList.prototype.getResources = function () {\n        var _this = this;\n        var resources = this.getProperty(\"resources\");\n        return resources.map(function (resource) { return new _internal__WEBPACK_IMPORTED_MODULE_0__.Annotation(resource, _this.options); });\n    };\n    AnnotationList.prototype.load = function () {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (_this.isLoaded) {\n                resolve(_this);\n            }\n            else {\n                var id = _this.__jsonld.id;\n                if (!id) {\n                    id = _this.__jsonld[\"@id\"];\n                }\n                _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.loadManifest(id)\n                    .then(function (data) {\n                    _this.__jsonld = data;\n                    _this.context = _this.getProperty(\"context\");\n                    _this.id = _this.getProperty(\"id\");\n                    _this.isLoaded = true;\n                    resolve(_this);\n                })\n                    .catch(reject);\n            }\n        });\n    };\n    return AnnotationList;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.JSONLDResource));\n\n//# sourceMappingURL=AnnotationList.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQW5ub3RhdGlvbkxpc3QuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQzhEO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsNENBQUs7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsV0FBVyxpREFBVSw0QkFBNEI7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDRDQUFLO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDLENBQUMscURBQWM7QUFDVTtBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0Ly4vbm9kZV9tb2R1bGVzL21hbmlmZXN0by5qcy9kaXN0LWVzbW9kdWxlL0Fubm90YXRpb25MaXN0LmpzPzY4NzAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBBbm5vdGF0aW9uLCBKU09OTERSZXNvdXJjZSwgVXRpbHMgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIEFubm90YXRpb25MaXN0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBbm5vdGF0aW9uTGlzdCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbm5vdGF0aW9uTGlzdChsYWJlbCwganNvbmxkLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubGFiZWwgPSBsYWJlbDtcbiAgICAgICAgX3RoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQW5ub3RhdGlvbkxpc3QucHJvdG90eXBlLmdldElJSUZSZXNvdXJjZVR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5ub3JtYWxpc2VUeXBlKHRoaXMuZ2V0UHJvcGVydHkoXCJ0eXBlXCIpKTtcbiAgICB9O1xuICAgIEFubm90YXRpb25MaXN0LnByb3RvdHlwZS5nZXRMYWJlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGFiZWw7XG4gICAgfTtcbiAgICBBbm5vdGF0aW9uTGlzdC5wcm90b3R5cGUuZ2V0UmVzb3VyY2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgcmVzb3VyY2VzID0gdGhpcy5nZXRQcm9wZXJ0eShcInJlc291cmNlc1wiKTtcbiAgICAgICAgcmV0dXJuIHJlc291cmNlcy5tYXAoZnVuY3Rpb24gKHJlc291cmNlKSB7IHJldHVybiBuZXcgQW5ub3RhdGlvbihyZXNvdXJjZSwgX3RoaXMub3B0aW9ucyk7IH0pO1xuICAgIH07XG4gICAgQW5ub3RhdGlvbkxpc3QucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IF90aGlzLl9fanNvbmxkLmlkO1xuICAgICAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBfdGhpcy5fX2pzb25sZFtcIkBpZFwiXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgVXRpbHMubG9hZE1hbmlmZXN0KGlkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fX2pzb25sZCA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbnRleHQgPSBfdGhpcy5nZXRQcm9wZXJ0eShcImNvbnRleHRcIik7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlkID0gX3RoaXMuZ2V0UHJvcGVydHkoXCJpZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2gocmVqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQW5ub3RhdGlvbkxpc3Q7XG59KEpTT05MRFJlc291cmNlKSk7XG5leHBvcnQgeyBBbm5vdGF0aW9uTGlzdCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QW5ub3RhdGlvbkxpc3QuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationList.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationPage.js":
/*!*******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/AnnotationPage.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AnnotationPage: () => (/* binding */ AnnotationPage)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar AnnotationPage = /** @class */ (function (_super) {\n    __extends(AnnotationPage, _super);\n    function AnnotationPage(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    AnnotationPage.prototype.getItems = function () {\n        return this.getProperty(\"items\");\n    };\n    return AnnotationPage;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=AnnotationPage.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQW5ub3RhdGlvblBhZ2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQzZDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx1REFBZ0I7QUFDUTtBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0Ly4vbm9kZV9tb2R1bGVzL21hbmlmZXN0by5qcy9kaXN0LWVzbW9kdWxlL0Fubm90YXRpb25QYWdlLmpzPzIwMjIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBNYW5pZmVzdFJlc291cmNlIH0gZnJvbSBcIi4vaW50ZXJuYWxcIjtcbnZhciBBbm5vdGF0aW9uUGFnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5ub3RhdGlvblBhZ2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQW5ub3RhdGlvblBhZ2UoanNvbmxkLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBqc29ubGQsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFubm90YXRpb25QYWdlLnByb3RvdHlwZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJpdGVtc1wiKTtcbiAgICB9O1xuICAgIHJldHVybiBBbm5vdGF0aW9uUGFnZTtcbn0oTWFuaWZlc3RSZXNvdXJjZSkpO1xuZXhwb3J0IHsgQW5ub3RhdGlvblBhZ2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFubm90YXRpb25QYWdlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationPage.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Canvas.js":
/*!***********************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Canvas.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Canvas: () => (/* binding */ Canvas)\n/* harmony export */ });\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n/* harmony import */ var lodash_flatten__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash/flatten */ \"(ssr)/./node_modules/lodash/flatten.js\");\n/* harmony import */ var lodash_flatten__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_flatten__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash_flattenDeep__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/flattenDeep */ \"(ssr)/./node_modules/lodash/flattenDeep.js\");\n/* harmony import */ var lodash_flattenDeep__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash_flattenDeep__WEBPACK_IMPORTED_MODULE_3__);\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n// @ts-ignore\n\n// @ts-ignore\n\nvar Canvas = /** @class */ (function (_super) {\n    __extends(Canvas, _super);\n    function Canvas(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    // http://iiif.io/api/image/2.1/#canonical-uri-syntax\n    Canvas.prototype.getCanonicalImageUri = function (w) {\n        var id = null;\n        var region = \"full\";\n        var rotation = 0;\n        var quality = \"default\";\n        var width = w;\n        var size;\n        // if an info.json has been loaded\n        if (this.externalResource &&\n            this.externalResource.data &&\n            this.externalResource.data[\"@id\"]) {\n            id = this.externalResource.data[\"@id\"];\n            if (!width) {\n                width = this.externalResource.data.width;\n            }\n            if (this.externalResource.data[\"@context\"]) {\n                if (this.externalResource.data[\"@context\"].indexOf(\"/1.0/context.json\") >\n                    -1 ||\n                    this.externalResource.data[\"@context\"].indexOf(\"/1.1/context.json\") >\n                        -1 ||\n                    this.externalResource.data[\"@context\"].indexOf(\"/1/context.json\") > -1) {\n                    quality = \"native\";\n                }\n            }\n        }\n        else {\n            // info.json hasn't been loaded yet\n            var images = void 0;\n            // presentation 2.0\n            images = this.getImages();\n            if (images && images.length) {\n                var firstImage = images[0];\n                var resource = firstImage.getResource();\n                var services = resource.getServices();\n                if (!width) {\n                    width = resource.getWidth();\n                }\n                var service = services\n                    ? services.find(function (service) {\n                        return (_internal__WEBPACK_IMPORTED_MODULE_1__.Utils.isImageProfile(service.getProfile()) ||\n                            _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.isImageServiceType(service.getIIIFResourceType()));\n                    })\n                    : null;\n                if (service) {\n                    id = service.id;\n                    quality = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.getImageQuality(service.getProfile());\n                }\n                else if (width === resource.getWidth()) {\n                    // if the passed width is the same as the resource width\n                    // i.e. not looking for a thumbnail\n                    // return the full size image.\n                    // used for download options when loading static images.\n                    return resource.id;\n                }\n            }\n            // presentation 3.0\n            images = this.getContent();\n            if (images && images.length) {\n                var firstImage = images[0];\n                var body = firstImage.getBody();\n                var anno = body[0];\n                var services = anno.getServices();\n                if (!width) {\n                    width = anno.getWidth();\n                }\n                var service = services\n                    ? services.find(function (service) {\n                        return _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.isImageServiceType(service.getIIIFResourceType());\n                    })\n                    : null;\n                if (service) {\n                    id = service.id;\n                    quality = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.getImageQuality(service.getProfile());\n                }\n                else if (width === anno.getWidth()) {\n                    // if the passed width is the same as the resource width\n                    // i.e. not looking for a thumbnail\n                    // return the full size image.\n                    // used for download options when loading static images.\n                    return anno.id;\n                }\n            }\n            // todo: should this be moved to getThumbUri?\n            if (!id) {\n                var thumbnail = this.getProperty(\"thumbnail\");\n                if (thumbnail) {\n                    if (typeof thumbnail === \"string\") {\n                        return thumbnail;\n                    }\n                    else {\n                        if (thumbnail[\"@id\"]) {\n                            return thumbnail[\"@id\"];\n                        }\n                        else if (thumbnail.length) {\n                            return thumbnail[0].id;\n                        }\n                    }\n                }\n            }\n        }\n        size = width + \",\";\n        // trim off trailing '/'\n        if (id && id.endsWith(\"/\")) {\n            id = id.substr(0, id.length - 1);\n        }\n        var uri = [id, region, size, rotation, quality + \".jpg\"].join(\"/\");\n        return uri;\n    };\n    Canvas.prototype.getMaxDimensions = function () {\n        var maxDimensions = null;\n        var profile;\n        if (this.externalResource &&\n            this.externalResource.data &&\n            this.externalResource.data.profile) {\n            profile = this.externalResource.data.profile;\n            if (Array.isArray(profile)) {\n                profile = profile.filter(function (p) { return p[\"maxWidth\" || 0]; })[0];\n                if (profile) {\n                    maxDimensions = new _internal__WEBPACK_IMPORTED_MODULE_1__.Size(profile.maxWidth, profile.maxHeight ? profile.maxHeight : profile.maxWidth);\n                }\n            }\n        }\n        return maxDimensions;\n    };\n    // Presentation API 3.0\n    Canvas.prototype.getContent = function () {\n        var content = [];\n        var items = this.__jsonld.items || this.__jsonld.content;\n        if (!items)\n            return content;\n        // should be contained in an AnnotationPage\n        var annotationPage = null;\n        if (items.length) {\n            annotationPage = new _internal__WEBPACK_IMPORTED_MODULE_1__.AnnotationPage(items[0], this.options);\n        }\n        if (!annotationPage) {\n            return content;\n        }\n        var annotations = annotationPage.getItems();\n        for (var i = 0; i < annotations.length; i++) {\n            var a = annotations[i];\n            var annotation = new _internal__WEBPACK_IMPORTED_MODULE_1__.Annotation(a, this.options);\n            content.push(annotation);\n        }\n        return content;\n    };\n    Canvas.prototype.getDuration = function () {\n        return this.getProperty(\"duration\");\n    };\n    // presentation 2.0\n    Canvas.prototype.getImages = function () {\n        var images = [];\n        if (!this.__jsonld.images)\n            return images;\n        for (var i = 0; i < this.__jsonld.images.length; i++) {\n            var a = this.__jsonld.images[i];\n            var annotation = new _internal__WEBPACK_IMPORTED_MODULE_1__.Annotation(a, this.options);\n            images.push(annotation);\n        }\n        return images;\n    };\n    Canvas.prototype.getIndex = function () {\n        return this.getProperty(\"index\");\n    };\n    Canvas.prototype.getOtherContent = function () {\n        var _this = this;\n        var otherContent = Array.isArray(this.getProperty(\"otherContent\"))\n            ? this.getProperty(\"otherContent\")\n            : [this.getProperty(\"otherContent\")];\n        var canonicalComparison = function (typeA, typeB) {\n            if (typeof typeA !== \"string\" || typeof typeB !== \"string\") {\n                return false;\n            }\n            return typeA.toLowerCase() === typeA.toLowerCase();\n        };\n        var otherPromises = otherContent\n            .filter(function (otherContent) {\n            return otherContent &&\n                canonicalComparison(otherContent[\"@type\"], \"sc:AnnotationList\");\n        })\n            .map(function (annotationList, i) {\n            return new _internal__WEBPACK_IMPORTED_MODULE_1__.AnnotationList(annotationList[\"label\"] || \"Annotation list \" + i, annotationList, _this.options);\n        })\n            .map(function (annotationList) { return annotationList.load(); });\n        return Promise.all(otherPromises);\n    };\n    // Prefer thumbnail service to image service if supplied and if\n    // the thumbnail service can provide a satisfactory size +/- x pixels.\n    // this is used to get thumb URIs *before* the info.json has been requested\n    // and populate thumbnails in a viewer.\n    // the publisher may also provide pre-computed fixed-size thumbs for better performance.\n    //getThumbUri(width: number): string {\n    //\n    //    var uri;\n    //    var images: IAnnotation[] = this.getImages();\n    //\n    //    if (images && images.length) {\n    //        var firstImage = images[0];\n    //        var resource: IResource = firstImage.getResource();\n    //        var services: IService[] = resource.getServices();\n    //\n    //        for (let i = 0; i < services.length; i++) {\n    //            var service: IService = services[i];\n    //            var id = service.id;\n    //\n    //            if (!_endsWith(id, '/')) {\n    //                id += '/';\n    //            }\n    //\n    //            uri = id + 'full/' + width + ',/0/' + Utils.getImageQuality(service.getProfile()) + '.jpg';\n    //        }\n    //    }\n    //\n    //    return uri;\n    //}\n    //getType(): CanvasType {\n    //    return new CanvasType(this.getProperty('@type').toLowerCase());\n    //}\n    Canvas.prototype.getWidth = function () {\n        return this.getProperty(\"width\");\n    };\n    Canvas.prototype.getHeight = function () {\n        return this.getProperty(\"height\");\n    };\n    Canvas.prototype.getViewingHint = function () {\n        return this.getProperty(\"viewingHint\");\n    };\n    Object.defineProperty(Canvas.prototype, \"imageResources\", {\n        get: function () {\n            var _this = this;\n            var resources = lodash_flattenDeep__WEBPACK_IMPORTED_MODULE_3___default()([\n                this.getImages().map(function (i) { return i.getResource(); }),\n                this.getContent().map(function (i) { return i.getBody(); })\n            ]);\n            return lodash_flatten__WEBPACK_IMPORTED_MODULE_2___default()(resources.map(function (resource) {\n                switch (resource.getProperty(\"type\").toLowerCase()) {\n                    case _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ExternalResourceType.CHOICE:\n                    case _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ExternalResourceType.OA_CHOICE:\n                        return new Canvas({\n                            images: lodash_flatten__WEBPACK_IMPORTED_MODULE_2___default()([\n                                resource.getProperty(\"default\"),\n                                resource.getProperty(\"item\")\n                            ]).map(function (r) { return ({ resource: r }); })\n                        }, _this.options)\n                            .getImages()\n                            .map(function (i) { return i.getResource(); });\n                    default:\n                        return resource;\n                }\n            }));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Canvas.prototype, \"resourceAnnotations\", {\n        get: function () {\n            return lodash_flattenDeep__WEBPACK_IMPORTED_MODULE_3___default()([this.getImages(), this.getContent()]);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Returns a given resource Annotation, based on a contained resource or body\n     * id\n     */\n    Canvas.prototype.resourceAnnotation = function (id) {\n        return this.resourceAnnotations.find(function (anno) {\n            return anno.getResource().id === id ||\n                lodash_flatten__WEBPACK_IMPORTED_MODULE_2___default()(new Array(anno.getBody())).some(function (body) { return body.id === id; });\n        });\n    };\n    /**\n     * Returns the fragment placement values if a resourceAnnotation is placed on\n     * a canvas somewhere besides the full extent\n     */\n    Canvas.prototype.onFragment = function (id) {\n        var resourceAnnotation = this.resourceAnnotation(id);\n        if (!resourceAnnotation)\n            return undefined;\n        // IIIF v2\n        var on = resourceAnnotation.getProperty(\"on\");\n        // IIIF v3\n        var target = resourceAnnotation.getProperty(\"target\");\n        if (!on || !target) {\n            return undefined;\n        }\n        var fragmentMatch = (on || target).match(/xywh=(.*)$/);\n        if (!fragmentMatch)\n            return undefined;\n        return fragmentMatch[1].split(\",\").map(function (str) { return parseInt(str, 10); });\n    };\n    Object.defineProperty(Canvas.prototype, \"iiifImageResources\", {\n        get: function () {\n            return this.imageResources.filter(function (r) { return r && r.getServices()[0] && r.getServices()[0].id; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Canvas.prototype, \"imageServiceIds\", {\n        get: function () {\n            return this.iiifImageResources.map(function (r) { return r.getServices()[0].id; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Canvas.prototype, \"aspectRatio\", {\n        get: function () {\n            return this.getWidth() / this.getHeight();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Canvas;\n}(_internal__WEBPACK_IMPORTED_MODULE_1__.Resource));\n\n//# sourceMappingURL=Canvas.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQ2FudmFzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ3FFO0FBQ3lCO0FBQy9GO0FBQ3FDO0FBQ3JDO0FBQzZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyw0Q0FBSztBQUNyQyw0QkFBNEIsNENBQUs7QUFDakMscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw0Q0FBSztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsNENBQUs7QUFDcEMscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw0Q0FBSztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCx1QkFBdUIsQ0FBVSxJQUFJO0FBQzdGO0FBQ0Esd0NBQXdDLDJDQUFJO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMscURBQWM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQSxpQ0FBaUMsaURBQVU7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlDQUFpQztBQUN6RDtBQUNBLGlDQUFpQyxpREFBVTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLHVCQUF1QixxREFBYztBQUNyQyxTQUFTO0FBQ1QsNkNBQTZDLCtCQUErQjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHFCQUFxQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix5REFBVztBQUN2QyxvREFBb0QseUJBQXlCO0FBQzdFLHFEQUFxRCxxQkFBcUI7QUFDMUU7QUFDQSxtQkFBbUIscURBQU87QUFDMUI7QUFDQSx5QkFBeUIsZ0ZBQW9CO0FBQzdDLHlCQUF5QixnRkFBb0I7QUFDN0M7QUFDQSxvQ0FBb0MscURBQU87QUFDM0M7QUFDQTtBQUNBLGtEQUFrRCxVQUFVLGFBQWEsSUFBSTtBQUM3RSx5QkFBeUI7QUFDekI7QUFDQSxnREFBZ0QseUJBQXlCO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsbUJBQW1CLHlEQUFXO0FBQzlCLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHFEQUFPLG1EQUFtRCx3QkFBd0I7QUFDbEcsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLDJCQUEyQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsMERBQTBEO0FBQ3ZILFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw4REFBOEQsK0JBQStCO0FBQzdGLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQyxDQUFDLCtDQUFRO0FBQ1E7QUFDbEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9DYW52YXMuanM/NDFlMyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IEV4dGVybmFsUmVzb3VyY2VUeXBlIH0gZnJvbSBcIkBpaWlmL3ZvY2FidWxhcnkvZGlzdC1jb21tb25qc1wiO1xuaW1wb3J0IHsgQW5ub3RhdGlvbiwgQW5ub3RhdGlvbkxpc3QsIEFubm90YXRpb25QYWdlLCBSZXNvdXJjZSwgU2l6ZSwgVXRpbHMgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IGZsYXR0ZW4gZnJvbSBcImxvZGFzaC9mbGF0dGVuXCI7XG4vLyBAdHMtaWdub3JlXG5pbXBvcnQgZmxhdHRlbkRlZXAgZnJvbSBcImxvZGFzaC9mbGF0dGVuRGVlcFwiO1xudmFyIENhbnZhcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2FudmFzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENhbnZhcyhqc29ubGQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCwgb3B0aW9ucykgfHwgdGhpcztcbiAgICB9XG4gICAgLy8gaHR0cDovL2lpaWYuaW8vYXBpL2ltYWdlLzIuMS8jY2Fub25pY2FsLXVyaS1zeW50YXhcbiAgICBDYW52YXMucHJvdG90eXBlLmdldENhbm9uaWNhbEltYWdlVXJpID0gZnVuY3Rpb24gKHcpIHtcbiAgICAgICAgdmFyIGlkID0gbnVsbDtcbiAgICAgICAgdmFyIHJlZ2lvbiA9IFwiZnVsbFwiO1xuICAgICAgICB2YXIgcm90YXRpb24gPSAwO1xuICAgICAgICB2YXIgcXVhbGl0eSA9IFwiZGVmYXVsdFwiO1xuICAgICAgICB2YXIgd2lkdGggPSB3O1xuICAgICAgICB2YXIgc2l6ZTtcbiAgICAgICAgLy8gaWYgYW4gaW5mby5qc29uIGhhcyBiZWVuIGxvYWRlZFxuICAgICAgICBpZiAodGhpcy5leHRlcm5hbFJlc291cmNlICYmXG4gICAgICAgICAgICB0aGlzLmV4dGVybmFsUmVzb3VyY2UuZGF0YSAmJlxuICAgICAgICAgICAgdGhpcy5leHRlcm5hbFJlc291cmNlLmRhdGFbXCJAaWRcIl0pIHtcbiAgICAgICAgICAgIGlkID0gdGhpcy5leHRlcm5hbFJlc291cmNlLmRhdGFbXCJAaWRcIl07XG4gICAgICAgICAgICBpZiAoIXdpZHRoKSB7XG4gICAgICAgICAgICAgICAgd2lkdGggPSB0aGlzLmV4dGVybmFsUmVzb3VyY2UuZGF0YS53aWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmV4dGVybmFsUmVzb3VyY2UuZGF0YVtcIkBjb250ZXh0XCJdKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZXh0ZXJuYWxSZXNvdXJjZS5kYXRhW1wiQGNvbnRleHRcIl0uaW5kZXhPZihcIi8xLjAvY29udGV4dC5qc29uXCIpID5cbiAgICAgICAgICAgICAgICAgICAgLTEgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHRlcm5hbFJlc291cmNlLmRhdGFbXCJAY29udGV4dFwiXS5pbmRleE9mKFwiLzEuMS9jb250ZXh0Lmpzb25cIikgPlxuICAgICAgICAgICAgICAgICAgICAgICAgLTEgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHRlcm5hbFJlc291cmNlLmRhdGFbXCJAY29udGV4dFwiXS5pbmRleE9mKFwiLzEvY29udGV4dC5qc29uXCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVhbGl0eSA9IFwibmF0aXZlXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaW5mby5qc29uIGhhc24ndCBiZWVuIGxvYWRlZCB5ZXRcbiAgICAgICAgICAgIHZhciBpbWFnZXMgPSB2b2lkIDA7XG4gICAgICAgICAgICAvLyBwcmVzZW50YXRpb24gMi4wXG4gICAgICAgICAgICBpbWFnZXMgPSB0aGlzLmdldEltYWdlcygpO1xuICAgICAgICAgICAgaWYgKGltYWdlcyAmJiBpbWFnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0SW1hZ2UgPSBpbWFnZXNbMF07XG4gICAgICAgICAgICAgICAgdmFyIHJlc291cmNlID0gZmlyc3RJbWFnZS5nZXRSZXNvdXJjZSgpO1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlcyA9IHJlc291cmNlLmdldFNlcnZpY2VzKCk7XG4gICAgICAgICAgICAgICAgaWYgKCF3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IHJlc291cmNlLmdldFdpZHRoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gc2VydmljZXNcbiAgICAgICAgICAgICAgICAgICAgPyBzZXJ2aWNlcy5maW5kKGZ1bmN0aW9uIChzZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFV0aWxzLmlzSW1hZ2VQcm9maWxlKHNlcnZpY2UuZ2V0UHJvZmlsZSgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLmlzSW1hZ2VTZXJ2aWNlVHlwZShzZXJ2aWNlLmdldElJSUZSZXNvdXJjZVR5cGUoKSkpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBzZXJ2aWNlLmlkO1xuICAgICAgICAgICAgICAgICAgICBxdWFsaXR5ID0gVXRpbHMuZ2V0SW1hZ2VRdWFsaXR5KHNlcnZpY2UuZ2V0UHJvZmlsZSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAod2lkdGggPT09IHJlc291cmNlLmdldFdpZHRoKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIHBhc3NlZCB3aWR0aCBpcyB0aGUgc2FtZSBhcyB0aGUgcmVzb3VyY2Ugd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgLy8gaS5lLiBub3QgbG9va2luZyBmb3IgYSB0aHVtYm5haWxcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoZSBmdWxsIHNpemUgaW1hZ2UuXG4gICAgICAgICAgICAgICAgICAgIC8vIHVzZWQgZm9yIGRvd25sb2FkIG9wdGlvbnMgd2hlbiBsb2FkaW5nIHN0YXRpYyBpbWFnZXMuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvdXJjZS5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBwcmVzZW50YXRpb24gMy4wXG4gICAgICAgICAgICBpbWFnZXMgPSB0aGlzLmdldENvbnRlbnQoKTtcbiAgICAgICAgICAgIGlmIChpbWFnZXMgJiYgaW1hZ2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdEltYWdlID0gaW1hZ2VzWzBdO1xuICAgICAgICAgICAgICAgIHZhciBib2R5ID0gZmlyc3RJbWFnZS5nZXRCb2R5KCk7XG4gICAgICAgICAgICAgICAgdmFyIGFubm8gPSBib2R5WzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlcyA9IGFubm8uZ2V0U2VydmljZXMoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gYW5uby5nZXRXaWR0aCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2VydmljZSA9IHNlcnZpY2VzXG4gICAgICAgICAgICAgICAgICAgID8gc2VydmljZXMuZmluZChmdW5jdGlvbiAoc2VydmljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFV0aWxzLmlzSW1hZ2VTZXJ2aWNlVHlwZShzZXJ2aWNlLmdldElJSUZSZXNvdXJjZVR5cGUoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc2VydmljZSkge1xuICAgICAgICAgICAgICAgICAgICBpZCA9IHNlcnZpY2UuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHF1YWxpdHkgPSBVdGlscy5nZXRJbWFnZVF1YWxpdHkoc2VydmljZS5nZXRQcm9maWxlKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh3aWR0aCA9PT0gYW5uby5nZXRXaWR0aCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBwYXNzZWQgd2lkdGggaXMgdGhlIHNhbWUgYXMgdGhlIHJlc291cmNlIHdpZHRoXG4gICAgICAgICAgICAgICAgICAgIC8vIGkuZS4gbm90IGxvb2tpbmcgZm9yIGEgdGh1bWJuYWlsXG4gICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiB0aGUgZnVsbCBzaXplIGltYWdlLlxuICAgICAgICAgICAgICAgICAgICAvLyB1c2VkIGZvciBkb3dubG9hZCBvcHRpb25zIHdoZW4gbG9hZGluZyBzdGF0aWMgaW1hZ2VzLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5uby5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB0b2RvOiBzaG91bGQgdGhpcyBiZSBtb3ZlZCB0byBnZXRUaHVtYlVyaT9cbiAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGh1bWJuYWlsID0gdGhpcy5nZXRQcm9wZXJ0eShcInRodW1ibmFpbFwiKTtcbiAgICAgICAgICAgICAgICBpZiAodGh1bWJuYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGh1bWJuYWlsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGh1bWJuYWlsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRodW1ibmFpbFtcIkBpZFwiXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aHVtYm5haWxbXCJAaWRcIl07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aHVtYm5haWwubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRodW1ibmFpbFswXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzaXplID0gd2lkdGggKyBcIixcIjtcbiAgICAgICAgLy8gdHJpbSBvZmYgdHJhaWxpbmcgJy8nXG4gICAgICAgIGlmIChpZCAmJiBpZC5lbmRzV2l0aChcIi9cIikpIHtcbiAgICAgICAgICAgIGlkID0gaWQuc3Vic3RyKDAsIGlkLmxlbmd0aCAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1cmkgPSBbaWQsIHJlZ2lvbiwgc2l6ZSwgcm90YXRpb24sIHF1YWxpdHkgKyBcIi5qcGdcIl0uam9pbihcIi9cIik7XG4gICAgICAgIHJldHVybiB1cmk7XG4gICAgfTtcbiAgICBDYW52YXMucHJvdG90eXBlLmdldE1heERpbWVuc2lvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtYXhEaW1lbnNpb25zID0gbnVsbDtcbiAgICAgICAgdmFyIHByb2ZpbGU7XG4gICAgICAgIGlmICh0aGlzLmV4dGVybmFsUmVzb3VyY2UgJiZcbiAgICAgICAgICAgIHRoaXMuZXh0ZXJuYWxSZXNvdXJjZS5kYXRhICYmXG4gICAgICAgICAgICB0aGlzLmV4dGVybmFsUmVzb3VyY2UuZGF0YS5wcm9maWxlKSB7XG4gICAgICAgICAgICBwcm9maWxlID0gdGhpcy5leHRlcm5hbFJlc291cmNlLmRhdGEucHJvZmlsZTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHByb2ZpbGUpKSB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZSA9IHByb2ZpbGUuZmlsdGVyKGZ1bmN0aW9uIChwKSB7IHJldHVybiBwW1wibWF4V2lkdGhcIiB8fCBcIm1heHdpZHRoXCJdOyB9KVswXTtcbiAgICAgICAgICAgICAgICBpZiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBtYXhEaW1lbnNpb25zID0gbmV3IFNpemUocHJvZmlsZS5tYXhXaWR0aCwgcHJvZmlsZS5tYXhIZWlnaHQgPyBwcm9maWxlLm1heEhlaWdodCA6IHByb2ZpbGUubWF4V2lkdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF4RGltZW5zaW9ucztcbiAgICB9O1xuICAgIC8vIFByZXNlbnRhdGlvbiBBUEkgMy4wXG4gICAgQ2FudmFzLnByb3RvdHlwZS5nZXRDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29udGVudCA9IFtdO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLl9fanNvbmxkLml0ZW1zIHx8IHRoaXMuX19qc29ubGQuY29udGVudDtcbiAgICAgICAgaWYgKCFpdGVtcylcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICAvLyBzaG91bGQgYmUgY29udGFpbmVkIGluIGFuIEFubm90YXRpb25QYWdlXG4gICAgICAgIHZhciBhbm5vdGF0aW9uUGFnZSA9IG51bGw7XG4gICAgICAgIGlmIChpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGFubm90YXRpb25QYWdlID0gbmV3IEFubm90YXRpb25QYWdlKGl0ZW1zWzBdLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYW5ub3RhdGlvblBhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbm5vdGF0aW9ucyA9IGFubm90YXRpb25QYWdlLmdldEl0ZW1zKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5ub3RhdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYW5ub3RhdGlvbnNbaV07XG4gICAgICAgICAgICB2YXIgYW5ub3RhdGlvbiA9IG5ldyBBbm5vdGF0aW9uKGEsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICBjb250ZW50LnB1c2goYW5ub3RhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfTtcbiAgICBDYW52YXMucHJvdG90eXBlLmdldER1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eShcImR1cmF0aW9uXCIpO1xuICAgIH07XG4gICAgLy8gcHJlc2VudGF0aW9uIDIuMFxuICAgIENhbnZhcy5wcm90b3R5cGUuZ2V0SW1hZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW1hZ2VzID0gW107XG4gICAgICAgIGlmICghdGhpcy5fX2pzb25sZC5pbWFnZXMpXG4gICAgICAgICAgICByZXR1cm4gaW1hZ2VzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX19qc29ubGQuaW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMuX19qc29ubGQuaW1hZ2VzW2ldO1xuICAgICAgICAgICAgdmFyIGFubm90YXRpb24gPSBuZXcgQW5ub3RhdGlvbihhLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgaW1hZ2VzLnB1c2goYW5ub3RhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGltYWdlcztcbiAgICB9O1xuICAgIENhbnZhcy5wcm90b3R5cGUuZ2V0SW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwiaW5kZXhcIik7XG4gICAgfTtcbiAgICBDYW52YXMucHJvdG90eXBlLmdldE90aGVyQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG90aGVyQ29udGVudCA9IEFycmF5LmlzQXJyYXkodGhpcy5nZXRQcm9wZXJ0eShcIm90aGVyQ29udGVudFwiKSlcbiAgICAgICAgICAgID8gdGhpcy5nZXRQcm9wZXJ0eShcIm90aGVyQ29udGVudFwiKVxuICAgICAgICAgICAgOiBbdGhpcy5nZXRQcm9wZXJ0eShcIm90aGVyQ29udGVudFwiKV07XG4gICAgICAgIHZhciBjYW5vbmljYWxDb21wYXJpc29uID0gZnVuY3Rpb24gKHR5cGVBLCB0eXBlQikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0eXBlQSAhPT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgdHlwZUIgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHlwZUEudG9Mb3dlckNhc2UoKSA9PT0gdHlwZUEudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG90aGVyUHJvbWlzZXMgPSBvdGhlckNvbnRlbnRcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKG90aGVyQ29udGVudCkge1xuICAgICAgICAgICAgcmV0dXJuIG90aGVyQ29udGVudCAmJlxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbENvbXBhcmlzb24ob3RoZXJDb250ZW50W1wiQHR5cGVcIl0sIFwic2M6QW5ub3RhdGlvbkxpc3RcIik7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChhbm5vdGF0aW9uTGlzdCwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBbm5vdGF0aW9uTGlzdChhbm5vdGF0aW9uTGlzdFtcImxhYmVsXCJdIHx8IFwiQW5ub3RhdGlvbiBsaXN0IFwiICsgaSwgYW5ub3RhdGlvbkxpc3QsIF90aGlzLm9wdGlvbnMpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoYW5ub3RhdGlvbkxpc3QpIHsgcmV0dXJuIGFubm90YXRpb25MaXN0LmxvYWQoKTsgfSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChvdGhlclByb21pc2VzKTtcbiAgICB9O1xuICAgIC8vIFByZWZlciB0aHVtYm5haWwgc2VydmljZSB0byBpbWFnZSBzZXJ2aWNlIGlmIHN1cHBsaWVkIGFuZCBpZlxuICAgIC8vIHRoZSB0aHVtYm5haWwgc2VydmljZSBjYW4gcHJvdmlkZSBhIHNhdGlzZmFjdG9yeSBzaXplICsvLSB4IHBpeGVscy5cbiAgICAvLyB0aGlzIGlzIHVzZWQgdG8gZ2V0IHRodW1iIFVSSXMgKmJlZm9yZSogdGhlIGluZm8uanNvbiBoYXMgYmVlbiByZXF1ZXN0ZWRcbiAgICAvLyBhbmQgcG9wdWxhdGUgdGh1bWJuYWlscyBpbiBhIHZpZXdlci5cbiAgICAvLyB0aGUgcHVibGlzaGVyIG1heSBhbHNvIHByb3ZpZGUgcHJlLWNvbXB1dGVkIGZpeGVkLXNpemUgdGh1bWJzIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UuXG4gICAgLy9nZXRUaHVtYlVyaSh3aWR0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAvL1xuICAgIC8vICAgIHZhciB1cmk7XG4gICAgLy8gICAgdmFyIGltYWdlczogSUFubm90YXRpb25bXSA9IHRoaXMuZ2V0SW1hZ2VzKCk7XG4gICAgLy9cbiAgICAvLyAgICBpZiAoaW1hZ2VzICYmIGltYWdlcy5sZW5ndGgpIHtcbiAgICAvLyAgICAgICAgdmFyIGZpcnN0SW1hZ2UgPSBpbWFnZXNbMF07XG4gICAgLy8gICAgICAgIHZhciByZXNvdXJjZTogSVJlc291cmNlID0gZmlyc3RJbWFnZS5nZXRSZXNvdXJjZSgpO1xuICAgIC8vICAgICAgICB2YXIgc2VydmljZXM6IElTZXJ2aWNlW10gPSByZXNvdXJjZS5nZXRTZXJ2aWNlcygpO1xuICAgIC8vXG4gICAgLy8gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VydmljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAvLyAgICAgICAgICAgIHZhciBzZXJ2aWNlOiBJU2VydmljZSA9IHNlcnZpY2VzW2ldO1xuICAgIC8vICAgICAgICAgICAgdmFyIGlkID0gc2VydmljZS5pZDtcbiAgICAvL1xuICAgIC8vICAgICAgICAgICAgaWYgKCFfZW5kc1dpdGgoaWQsICcvJykpIHtcbiAgICAvLyAgICAgICAgICAgICAgICBpZCArPSAnLyc7XG4gICAgLy8gICAgICAgICAgICB9XG4gICAgLy9cbiAgICAvLyAgICAgICAgICAgIHVyaSA9IGlkICsgJ2Z1bGwvJyArIHdpZHRoICsgJywvMC8nICsgVXRpbHMuZ2V0SW1hZ2VRdWFsaXR5KHNlcnZpY2UuZ2V0UHJvZmlsZSgpKSArICcuanBnJztcbiAgICAvLyAgICAgICAgfVxuICAgIC8vICAgIH1cbiAgICAvL1xuICAgIC8vICAgIHJldHVybiB1cmk7XG4gICAgLy99XG4gICAgLy9nZXRUeXBlKCk6IENhbnZhc1R5cGUge1xuICAgIC8vICAgIHJldHVybiBuZXcgQ2FudmFzVHlwZSh0aGlzLmdldFByb3BlcnR5KCdAdHlwZScpLnRvTG93ZXJDYXNlKCkpO1xuICAgIC8vfVxuICAgIENhbnZhcy5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwid2lkdGhcIik7XG4gICAgfTtcbiAgICBDYW52YXMucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJoZWlnaHRcIik7XG4gICAgfTtcbiAgICBDYW52YXMucHJvdG90eXBlLmdldFZpZXdpbmdIaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eShcInZpZXdpbmdIaW50XCIpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENhbnZhcy5wcm90b3R5cGUsIFwiaW1hZ2VSZXNvdXJjZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgcmVzb3VyY2VzID0gZmxhdHRlbkRlZXAoW1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW1hZ2VzKCkubWFwKGZ1bmN0aW9uIChpKSB7IHJldHVybiBpLmdldFJlc291cmNlKCk7IH0pLFxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudCgpLm1hcChmdW5jdGlvbiAoaSkgeyByZXR1cm4gaS5nZXRCb2R5KCk7IH0pXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIHJldHVybiBmbGF0dGVuKHJlc291cmNlcy5tYXAoZnVuY3Rpb24gKHJlc291cmNlKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChyZXNvdXJjZS5nZXRQcm9wZXJ0eShcInR5cGVcIikudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIEV4dGVybmFsUmVzb3VyY2VUeXBlLkNIT0lDRTpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBFeHRlcm5hbFJlc291cmNlVHlwZS5PQV9DSE9JQ0U6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENhbnZhcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VzOiBmbGF0dGVuKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UuZ2V0UHJvcGVydHkoXCJkZWZhdWx0XCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZS5nZXRQcm9wZXJ0eShcIml0ZW1cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKS5tYXAoZnVuY3Rpb24gKHIpIHsgcmV0dXJuICh7IHJlc291cmNlOiByIH0pOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgX3RoaXMub3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0SW1hZ2VzKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChpKSB7IHJldHVybiBpLmdldFJlc291cmNlKCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENhbnZhcy5wcm90b3R5cGUsIFwicmVzb3VyY2VBbm5vdGF0aW9uc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZsYXR0ZW5EZWVwKFt0aGlzLmdldEltYWdlcygpLCB0aGlzLmdldENvbnRlbnQoKV0pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZ2l2ZW4gcmVzb3VyY2UgQW5ub3RhdGlvbiwgYmFzZWQgb24gYSBjb250YWluZWQgcmVzb3VyY2Ugb3IgYm9keVxuICAgICAqIGlkXG4gICAgICovXG4gICAgQ2FudmFzLnByb3RvdHlwZS5yZXNvdXJjZUFubm90YXRpb24gPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzb3VyY2VBbm5vdGF0aW9ucy5maW5kKGZ1bmN0aW9uIChhbm5vKSB7XG4gICAgICAgICAgICByZXR1cm4gYW5uby5nZXRSZXNvdXJjZSgpLmlkID09PSBpZCB8fFxuICAgICAgICAgICAgICAgIGZsYXR0ZW4obmV3IEFycmF5KGFubm8uZ2V0Qm9keSgpKSkuc29tZShmdW5jdGlvbiAoYm9keSkgeyByZXR1cm4gYm9keS5pZCA9PT0gaWQ7IH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGZyYWdtZW50IHBsYWNlbWVudCB2YWx1ZXMgaWYgYSByZXNvdXJjZUFubm90YXRpb24gaXMgcGxhY2VkIG9uXG4gICAgICogYSBjYW52YXMgc29tZXdoZXJlIGJlc2lkZXMgdGhlIGZ1bGwgZXh0ZW50XG4gICAgICovXG4gICAgQ2FudmFzLnByb3RvdHlwZS5vbkZyYWdtZW50ID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciByZXNvdXJjZUFubm90YXRpb24gPSB0aGlzLnJlc291cmNlQW5ub3RhdGlvbihpZCk7XG4gICAgICAgIGlmICghcmVzb3VyY2VBbm5vdGF0aW9uKVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgLy8gSUlJRiB2MlxuICAgICAgICB2YXIgb24gPSByZXNvdXJjZUFubm90YXRpb24uZ2V0UHJvcGVydHkoXCJvblwiKTtcbiAgICAgICAgLy8gSUlJRiB2M1xuICAgICAgICB2YXIgdGFyZ2V0ID0gcmVzb3VyY2VBbm5vdGF0aW9uLmdldFByb3BlcnR5KFwidGFyZ2V0XCIpO1xuICAgICAgICBpZiAoIW9uIHx8ICF0YXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZyYWdtZW50TWF0Y2ggPSAob24gfHwgdGFyZ2V0KS5tYXRjaCgveHl3aD0oLiopJC8pO1xuICAgICAgICBpZiAoIWZyYWdtZW50TWF0Y2gpXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gZnJhZ21lbnRNYXRjaFsxXS5zcGxpdChcIixcIikubWFwKGZ1bmN0aW9uIChzdHIpIHsgcmV0dXJuIHBhcnNlSW50KHN0ciwgMTApOyB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDYW52YXMucHJvdG90eXBlLCBcImlpaWZJbWFnZVJlc291cmNlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VSZXNvdXJjZXMuZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiByICYmIHIuZ2V0U2VydmljZXMoKVswXSAmJiByLmdldFNlcnZpY2VzKClbMF0uaWQ7IH0pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2FudmFzLnByb3RvdHlwZSwgXCJpbWFnZVNlcnZpY2VJZHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlpaWZJbWFnZVJlc291cmNlcy5tYXAoZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZ2V0U2VydmljZXMoKVswXS5pZDsgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDYW52YXMucHJvdG90eXBlLCBcImFzcGVjdFJhdGlvXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRXaWR0aCgpIC8gdGhpcy5nZXRIZWlnaHQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIENhbnZhcztcbn0oUmVzb3VyY2UpKTtcbmV4cG9ydCB7IENhbnZhcyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q2FudmFzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Canvas.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Collection.js":
/*!***************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Collection.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Collection: () => (/* binding */ Collection)\n/* harmony export */ });\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar Collection = /** @class */ (function (_super) {\n    __extends(Collection, _super);\n    function Collection(jsonld, options) {\n        var _this = _super.call(this, jsonld, options) || this;\n        _this.items = [];\n        _this._collections = null;\n        _this._manifests = null;\n        jsonld.__collection = _this;\n        return _this;\n    }\n    Collection.prototype.getCollections = function () {\n        if (this._collections) {\n            return this._collections;\n        }\n        return (this._collections = (this.items.filter(function (m) { return m.isCollection(); })));\n    };\n    Collection.prototype.getManifests = function () {\n        if (this._manifests) {\n            return this._manifests;\n        }\n        return (this._manifests = (this.items.filter(function (m) { return m.isManifest(); })));\n    };\n    Collection.prototype.getCollectionByIndex = function (collectionIndex) {\n        var collections = this.getCollections();\n        var collection;\n        for (var i = 0; i < collections.length; i++) {\n            var c = collections[i];\n            if (c.index === collectionIndex) {\n                collection = c;\n            }\n        }\n        if (collection) {\n            collection.options.index = collectionIndex;\n            // id for collection MUST be dereferenceable\n            return collection.load();\n        }\n        else {\n            throw new Error(\"Collection index not found\");\n        }\n    };\n    Collection.prototype.getManifestByIndex = function (manifestIndex) {\n        var manifests = this.getManifests();\n        var manifest;\n        for (var i = 0; i < manifests.length; i++) {\n            var m = manifests[i];\n            if (m.index === manifestIndex) {\n                manifest = m;\n            }\n        }\n        if (manifest) {\n            manifest.options.index = manifestIndex;\n            return manifest.load();\n        }\n        else {\n            throw new Error(\"Manifest index not found\");\n        }\n    };\n    Collection.prototype.getTotalCollections = function () {\n        return this.getCollections().length;\n    };\n    Collection.prototype.getTotalManifests = function () {\n        return this.getManifests().length;\n    };\n    Collection.prototype.getTotalItems = function () {\n        return this.items.length;\n    };\n    Collection.prototype.getViewingDirection = function () {\n        if (this.getProperty(\"viewingDirection\")) {\n            return this.getProperty(\"viewingDirection\");\n        }\n        return _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingDirection.LEFT_TO_RIGHT;\n    };\n    /**\n     * Note: this only will return the first behavior as per the manifesto convention\n     * IIIF v3 supports multiple behaviors\n     */\n    Collection.prototype.getBehavior = function () {\n        var behavior = this.getProperty(\"behavior\");\n        if (Array.isArray(behavior)) {\n            behavior = behavior[0];\n        }\n        if (behavior) {\n            return behavior;\n        }\n        return null;\n    };\n    Collection.prototype.getViewingHint = function () {\n        return this.getProperty(\"viewingHint\");\n    };\n    /**\n     * Get a tree of sub collections and manifests, using each child manifest's first 'top' range.\n     */\n    Collection.prototype.getDefaultTree = function () {\n        _super.prototype.getDefaultTree.call(this);\n        //console.log(\"get default tree for \", this.id);\n        this.defaultTree.data.type = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_1__.TreeNodeType.COLLECTION);\n        this._parseManifests(this);\n        this._parseCollections(this);\n        _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.generateTreeNodeIds(this.defaultTree);\n        return this.defaultTree;\n    };\n    Collection.prototype._parseManifests = function (parentCollection) {\n        if (parentCollection.getManifests() &&\n            parentCollection.getManifests().length) {\n            for (var i = 0; i < parentCollection.getManifests().length; i++) {\n                var manifest = parentCollection.getManifests()[i];\n                var tree = manifest.getDefaultTree();\n                tree.label =\n                    manifest.parentLabel ||\n                        manifest.getLabel().getValue(this.options.locale) ||\n                        \"manifest \" + (i + 1);\n                tree.navDate = manifest.getNavDate();\n                tree.data.id = manifest.id;\n                tree.data.type = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_1__.TreeNodeType.MANIFEST);\n                parentCollection.defaultTree.addNode(tree);\n            }\n        }\n    };\n    Collection.prototype._parseCollections = function (parentCollection) {\n        //console.log(\"parse collections for \", parentCollection.id);\n        if (parentCollection.getCollections() &&\n            parentCollection.getCollections().length) {\n            for (var i = 0; i < parentCollection.getCollections().length; i++) {\n                var collection = parentCollection.getCollections()[i];\n                var tree = collection.getDefaultTree();\n                tree.label =\n                    collection.parentLabel ||\n                        collection.getLabel().getValue(this.options.locale) ||\n                        \"collection \" + (i + 1);\n                tree.navDate = collection.getNavDate();\n                tree.data.id = collection.id;\n                tree.data.type = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_1__.TreeNodeType.COLLECTION);\n                parentCollection.defaultTree.addNode(tree);\n            }\n        }\n    };\n    return Collection;\n}(_internal__WEBPACK_IMPORTED_MODULE_1__.IIIFResource));\n\n//# sourceMappingURL=Collection.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQ29sbGVjdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ2lFO0FBQ0g7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSwwQkFBMEI7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSx3QkFBd0I7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0JBQXdCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRFQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsNENBQUssZUFBZSxtREFBWTtBQUNyRTtBQUNBO0FBQ0EsUUFBUSw0Q0FBSztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNENBQTRDO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsNENBQUssZUFBZSxtREFBWTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDhDQUE4QztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDRDQUFLLGVBQWUsbURBQVk7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyxtREFBWTtBQUNRO0FBQ3RCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvQ29sbGVjdGlvbi5qcz8xNTA2Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgVmlld2luZ0RpcmVjdGlvbiB9IGZyb20gXCJAaWlpZi92b2NhYnVsYXJ5L2Rpc3QtY29tbW9uanNcIjtcbmltcG9ydCB7IElJSUZSZXNvdXJjZSwgVHJlZU5vZGVUeXBlLCBVdGlscyB9IGZyb20gXCIuL2ludGVybmFsXCI7XG52YXIgQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ29sbGVjdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKGpzb25sZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBqc29ubGQsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLml0ZW1zID0gW107XG4gICAgICAgIF90aGlzLl9jb2xsZWN0aW9ucyA9IG51bGw7XG4gICAgICAgIF90aGlzLl9tYW5pZmVzdHMgPSBudWxsO1xuICAgICAgICBqc29ubGQuX19jb2xsZWN0aW9uID0gX3RoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb2xsZWN0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbGxlY3Rpb25zO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAodGhpcy5fY29sbGVjdGlvbnMgPSAodGhpcy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0uaXNDb2xsZWN0aW9uKCk7IH0pKSk7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRNYW5pZmVzdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9tYW5pZmVzdHMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYW5pZmVzdHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0aGlzLl9tYW5pZmVzdHMgPSAodGhpcy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0uaXNNYW5pZmVzdCgpOyB9KSkpO1xuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbkJ5SW5kZXggPSBmdW5jdGlvbiAoY29sbGVjdGlvbkluZGV4KSB7XG4gICAgICAgIHZhciBjb2xsZWN0aW9ucyA9IHRoaXMuZ2V0Q29sbGVjdGlvbnMoKTtcbiAgICAgICAgdmFyIGNvbGxlY3Rpb247XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjID0gY29sbGVjdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoYy5pbmRleCA9PT0gY29sbGVjdGlvbkluZGV4KSB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IGM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ub3B0aW9ucy5pbmRleCA9IGNvbGxlY3Rpb25JbmRleDtcbiAgICAgICAgICAgIC8vIGlkIGZvciBjb2xsZWN0aW9uIE1VU1QgYmUgZGVyZWZlcmVuY2VhYmxlXG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbi5sb2FkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2xsZWN0aW9uIGluZGV4IG5vdCBmb3VuZFwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0TWFuaWZlc3RCeUluZGV4ID0gZnVuY3Rpb24gKG1hbmlmZXN0SW5kZXgpIHtcbiAgICAgICAgdmFyIG1hbmlmZXN0cyA9IHRoaXMuZ2V0TWFuaWZlc3RzKCk7XG4gICAgICAgIHZhciBtYW5pZmVzdDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYW5pZmVzdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBtID0gbWFuaWZlc3RzW2ldO1xuICAgICAgICAgICAgaWYgKG0uaW5kZXggPT09IG1hbmlmZXN0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICBtYW5pZmVzdCA9IG07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hbmlmZXN0KSB7XG4gICAgICAgICAgICBtYW5pZmVzdC5vcHRpb25zLmluZGV4ID0gbWFuaWZlc3RJbmRleDtcbiAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdC5sb2FkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNYW5pZmVzdCBpbmRleCBub3QgZm91bmRcIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmdldFRvdGFsQ29sbGVjdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldENvbGxlY3Rpb25zKCkubGVuZ3RoO1xuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0VG90YWxNYW5pZmVzdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1hbmlmZXN0cygpLmxlbmd0aDtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmdldFRvdGFsSXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zLmxlbmd0aDtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmdldFZpZXdpbmdEaXJlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmdldFByb3BlcnR5KFwidmlld2luZ0RpcmVjdGlvblwiKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJ2aWV3aW5nRGlyZWN0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBWaWV3aW5nRGlyZWN0aW9uLkxFRlRfVE9fUklHSFQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBOb3RlOiB0aGlzIG9ubHkgd2lsbCByZXR1cm4gdGhlIGZpcnN0IGJlaGF2aW9yIGFzIHBlciB0aGUgbWFuaWZlc3RvIGNvbnZlbnRpb25cbiAgICAgKiBJSUlGIHYzIHN1cHBvcnRzIG11bHRpcGxlIGJlaGF2aW9yc1xuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmdldEJlaGF2aW9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYmVoYXZpb3IgPSB0aGlzLmdldFByb3BlcnR5KFwiYmVoYXZpb3JcIik7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGJlaGF2aW9yKSkge1xuICAgICAgICAgICAgYmVoYXZpb3IgPSBiZWhhdmlvclswXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmVoYXZpb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBiZWhhdmlvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmdldFZpZXdpbmdIaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eShcInZpZXdpbmdIaW50XCIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGEgdHJlZSBvZiBzdWIgY29sbGVjdGlvbnMgYW5kIG1hbmlmZXN0cywgdXNpbmcgZWFjaCBjaGlsZCBtYW5pZmVzdCdzIGZpcnN0ICd0b3AnIHJhbmdlLlxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmdldERlZmF1bHRUcmVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmdldERlZmF1bHRUcmVlLmNhbGwodGhpcyk7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJnZXQgZGVmYXVsdCB0cmVlIGZvciBcIiwgdGhpcy5pZCk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFRyZWUuZGF0YS50eXBlID0gVXRpbHMubm9ybWFsaXNlVHlwZShUcmVlTm9kZVR5cGUuQ09MTEVDVElPTik7XG4gICAgICAgIHRoaXMuX3BhcnNlTWFuaWZlc3RzKHRoaXMpO1xuICAgICAgICB0aGlzLl9wYXJzZUNvbGxlY3Rpb25zKHRoaXMpO1xuICAgICAgICBVdGlscy5nZW5lcmF0ZVRyZWVOb2RlSWRzKHRoaXMuZGVmYXVsdFRyZWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0VHJlZTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLl9wYXJzZU1hbmlmZXN0cyA9IGZ1bmN0aW9uIChwYXJlbnRDb2xsZWN0aW9uKSB7XG4gICAgICAgIGlmIChwYXJlbnRDb2xsZWN0aW9uLmdldE1hbmlmZXN0cygpICYmXG4gICAgICAgICAgICBwYXJlbnRDb2xsZWN0aW9uLmdldE1hbmlmZXN0cygpLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJlbnRDb2xsZWN0aW9uLmdldE1hbmlmZXN0cygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0ID0gcGFyZW50Q29sbGVjdGlvbi5nZXRNYW5pZmVzdHMoKVtpXTtcbiAgICAgICAgICAgICAgICB2YXIgdHJlZSA9IG1hbmlmZXN0LmdldERlZmF1bHRUcmVlKCk7XG4gICAgICAgICAgICAgICAgdHJlZS5sYWJlbCA9XG4gICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0LnBhcmVudExhYmVsIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdC5nZXRMYWJlbCgpLmdldFZhbHVlKHRoaXMub3B0aW9ucy5sb2NhbGUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1hbmlmZXN0IFwiICsgKGkgKyAxKTtcbiAgICAgICAgICAgICAgICB0cmVlLm5hdkRhdGUgPSBtYW5pZmVzdC5nZXROYXZEYXRlKCk7XG4gICAgICAgICAgICAgICAgdHJlZS5kYXRhLmlkID0gbWFuaWZlc3QuaWQ7XG4gICAgICAgICAgICAgICAgdHJlZS5kYXRhLnR5cGUgPSBVdGlscy5ub3JtYWxpc2VUeXBlKFRyZWVOb2RlVHlwZS5NQU5JRkVTVCk7XG4gICAgICAgICAgICAgICAgcGFyZW50Q29sbGVjdGlvbi5kZWZhdWx0VHJlZS5hZGROb2RlKHRyZWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fcGFyc2VDb2xsZWN0aW9ucyA9IGZ1bmN0aW9uIChwYXJlbnRDb2xsZWN0aW9uKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJwYXJzZSBjb2xsZWN0aW9ucyBmb3IgXCIsIHBhcmVudENvbGxlY3Rpb24uaWQpO1xuICAgICAgICBpZiAocGFyZW50Q29sbGVjdGlvbi5nZXRDb2xsZWN0aW9ucygpICYmXG4gICAgICAgICAgICBwYXJlbnRDb2xsZWN0aW9uLmdldENvbGxlY3Rpb25zKCkubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmVudENvbGxlY3Rpb24uZ2V0Q29sbGVjdGlvbnMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gcGFyZW50Q29sbGVjdGlvbi5nZXRDb2xsZWN0aW9ucygpW2ldO1xuICAgICAgICAgICAgICAgIHZhciB0cmVlID0gY29sbGVjdGlvbi5nZXREZWZhdWx0VHJlZSgpO1xuICAgICAgICAgICAgICAgIHRyZWUubGFiZWwgPVxuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnBhcmVudExhYmVsIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmdldExhYmVsKCkuZ2V0VmFsdWUodGhpcy5vcHRpb25zLmxvY2FsZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29sbGVjdGlvbiBcIiArIChpICsgMSk7XG4gICAgICAgICAgICAgICAgdHJlZS5uYXZEYXRlID0gY29sbGVjdGlvbi5nZXROYXZEYXRlKCk7XG4gICAgICAgICAgICAgICAgdHJlZS5kYXRhLmlkID0gY29sbGVjdGlvbi5pZDtcbiAgICAgICAgICAgICAgICB0cmVlLmRhdGEudHlwZSA9IFV0aWxzLm5vcm1hbGlzZVR5cGUoVHJlZU5vZGVUeXBlLkNPTExFQ1RJT04pO1xuICAgICAgICAgICAgICAgIHBhcmVudENvbGxlY3Rpb24uZGVmYXVsdFRyZWUuYWRkTm9kZSh0cmVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIENvbGxlY3Rpb247XG59KElJSUZSZXNvdXJjZSkpO1xuZXhwb3J0IHsgQ29sbGVjdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29sbGVjdGlvbi5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Collection.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Duration.js":
/*!*************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Duration.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Duration: () => (/* binding */ Duration)\n/* harmony export */ });\nvar Duration = /** @class */ (function () {\n    function Duration(start, end) {\n        this.start = start;\n        this.end = end;\n    }\n    Duration.prototype.getLength = function () {\n        return this.end - this.start;\n    };\n    return Duration;\n}());\n\n//# sourceMappingURL=Duration.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvRHVyYXRpb24uanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDbUI7QUFDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9EdXJhdGlvbi5qcz9hMTNhIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBEdXJhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEdXJhdGlvbihzdGFydCwgZW5kKSB7XG4gICAgICAgIHRoaXMuc3RhcnQgPSBzdGFydDtcbiAgICAgICAgdGhpcy5lbmQgPSBlbmQ7XG4gICAgfVxuICAgIER1cmF0aW9uLnByb3RvdHlwZS5nZXRMZW5ndGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuZCAtIHRoaXMuc3RhcnQ7XG4gICAgfTtcbiAgICByZXR1cm4gRHVyYXRpb247XG59KCkpO1xuZXhwb3J0IHsgRHVyYXRpb24gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUR1cmF0aW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Duration.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/IIIFResource.js":
/*!*****************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/IIIFResource.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   IIIFResource: () => (/* binding */ IIIFResource)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar IIIFResource = /** @class */ (function (_super) {\n    __extends(IIIFResource, _super);\n    function IIIFResource(jsonld, options) {\n        var _this = _super.call(this, jsonld, options) || this;\n        _this.index = -1;\n        _this.isLoaded = false;\n        var defaultOptions = {\n            defaultLabel: \"-\",\n            locale: \"en-GB\",\n            resource: _this,\n            pessimisticAccessControl: false\n        };\n        _this.options = Object.assign(defaultOptions, options);\n        return _this;\n    }\n    /**\n     * @deprecated\n     */\n    IIIFResource.prototype.getAttribution = function () {\n        //console.warn('getAttribution will be deprecated, use getRequiredStatement instead.');\n        var attribution = this.getProperty(\"attribution\");\n        if (attribution) {\n            return _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue.parse(attribution, this.options.locale);\n        }\n        return new _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue([], this.options.locale);\n    };\n    IIIFResource.prototype.getDescription = function () {\n        var description = this.getProperty(\"description\");\n        if (description) {\n            return _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue.parse(description, this.options.locale);\n        }\n        return new _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue([], this.options.locale);\n    };\n    IIIFResource.prototype.getHomepage = function () {\n        var homepage = this.getProperty(\"homepage\");\n        if (!homepage)\n            return null;\n        if (typeof homepage == \"string\")\n            return homepage;\n        if (Array.isArray(homepage) && homepage.length) {\n            homepage = homepage[0];\n        }\n        return homepage[\"@id\"] || homepage.id;\n    };\n    IIIFResource.prototype.getIIIFResourceType = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(this.getProperty(\"type\"));\n    };\n    IIIFResource.prototype.getLogo = function () {\n        var logo = this.getProperty(\"logo\");\n        // Presentation 3.\n        // The logo is exclusive to the \"provider\" property, which is of type \"Agent\".\n        // In order to fulfil `manifest.getLogo()` we should check\n        // When P3 is fully supported, the following should work.\n        // return this.getProvider()?.getLogo();\n        if (!logo) {\n            var provider = this.getProperty(\"provider\");\n            if (!provider) {\n                return null;\n            }\n            logo = provider.logo;\n        }\n        if (!logo)\n            return null;\n        if (typeof logo === \"string\")\n            return logo;\n        if (Array.isArray(logo) && logo.length) {\n            logo = logo[0];\n        }\n        return logo[\"@id\"] || logo.id;\n    };\n    IIIFResource.prototype.getLicense = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"license\"), this.options.locale);\n    };\n    IIIFResource.prototype.getNavDate = function () {\n        return new Date(this.getProperty(\"navDate\"));\n    };\n    IIIFResource.prototype.getRelated = function () {\n        return this.getProperty(\"related\");\n    };\n    IIIFResource.prototype.getSeeAlso = function () {\n        return this.getProperty(\"seeAlso\");\n    };\n    IIIFResource.prototype.getTrackingLabel = function () {\n        var service = (this.getService(_iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.TRACKING_EXTENSIONS));\n        if (service) {\n            return service.getProperty(\"trackingLabel\");\n        }\n        return \"\";\n    };\n    IIIFResource.prototype.getDefaultTree = function () {\n        this.defaultTree = new _internal__WEBPACK_IMPORTED_MODULE_0__.TreeNode(\"root\");\n        this.defaultTree.data = this;\n        return this.defaultTree;\n    };\n    IIIFResource.prototype.getRequiredStatement = function () {\n        var requiredStatement = null;\n        var _requiredStatement = this.getProperty(\"requiredStatement\");\n        if (_requiredStatement) {\n            requiredStatement = new _internal__WEBPACK_IMPORTED_MODULE_0__.LabelValuePair(this.options.locale);\n            requiredStatement.parse(_requiredStatement);\n        }\n        else {\n            // fall back to attribution (if it exists)\n            var attribution = this.getAttribution();\n            if (attribution) {\n                requiredStatement = new _internal__WEBPACK_IMPORTED_MODULE_0__.LabelValuePair(this.options.locale);\n                requiredStatement.value = attribution;\n            }\n        }\n        return requiredStatement;\n    };\n    IIIFResource.prototype.isCollection = function () {\n        if (this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.COLLECTION) {\n            return true;\n        }\n        return false;\n    };\n    IIIFResource.prototype.isManifest = function () {\n        if (this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.MANIFEST) {\n            return true;\n        }\n        return false;\n    };\n    IIIFResource.prototype.load = function () {\n        var that = this;\n        return new Promise(function (resolve) {\n            if (that.isLoaded) {\n                resolve(that);\n            }\n            else {\n                var options_1 = that.options;\n                options_1.navDate = that.getNavDate();\n                var id = that.__jsonld.id;\n                if (!id) {\n                    id = that.__jsonld[\"@id\"];\n                }\n                _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.loadManifest(id).then(function (data) {\n                    that.parentLabel = that.getLabel().getValue(options_1.locale);\n                    var parsed = _internal__WEBPACK_IMPORTED_MODULE_0__.Deserialiser.parse(data, options_1);\n                    that = Object.assign(that, parsed);\n                    //that.parentCollection = options.resource.parentCollection;\n                    that.index = options_1.index;\n                    resolve(that);\n                });\n            }\n        });\n    };\n    return IIIFResource;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=IIIFResource.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvSUlJRlJlc291cmNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDMkc7QUFDMUI7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsb0RBQWE7QUFDaEM7QUFDQSxtQkFBbUIsb0RBQWE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsb0RBQWE7QUFDaEM7QUFDQSxtQkFBbUIsb0RBQWE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSw0Q0FBSztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDBFQUFjO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwrQ0FBUTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxxREFBYztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MscURBQWM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLDRFQUFnQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLDRFQUFnQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDRDQUFLO0FBQ3JCO0FBQ0EsaUNBQWlDLG1EQUFZO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDLENBQUMsdURBQWdCO0FBQ007QUFDeEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9JSUlGUmVzb3VyY2UuanM/ZTA1ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IE1hbmlmZXN0UmVzb3VyY2UsIFV0aWxzLCBQcm9wZXJ0eVZhbHVlLCBEZXNlcmlhbGlzZXIsIExhYmVsVmFsdWVQYWlyLCBUcmVlTm9kZSB9IGZyb20gXCIuL2ludGVybmFsXCI7XG5pbXBvcnQgeyBJSUlGUmVzb3VyY2VUeXBlLCBTZXJ2aWNlUHJvZmlsZSB9IGZyb20gXCJAaWlpZi92b2NhYnVsYXJ5L2Rpc3QtY29tbW9uanNcIjtcbnZhciBJSUlGUmVzb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKElJSUZSZXNvdXJjZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJSUlGUmVzb3VyY2UoanNvbmxkLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCwgb3B0aW9ucykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaW5kZXggPSAtMTtcbiAgICAgICAgX3RoaXMuaXNMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgICAgZGVmYXVsdExhYmVsOiBcIi1cIixcbiAgICAgICAgICAgIGxvY2FsZTogXCJlbi1HQlwiLFxuICAgICAgICAgICAgcmVzb3VyY2U6IF90aGlzLFxuICAgICAgICAgICAgcGVzc2ltaXN0aWNBY2Nlc3NDb250cm9sOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbihkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWRcbiAgICAgKi9cbiAgICBJSUlGUmVzb3VyY2UucHJvdG90eXBlLmdldEF0dHJpYnV0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2NvbnNvbGUud2FybignZ2V0QXR0cmlidXRpb24gd2lsbCBiZSBkZXByZWNhdGVkLCB1c2UgZ2V0UmVxdWlyZWRTdGF0ZW1lbnQgaW5zdGVhZC4nKTtcbiAgICAgICAgdmFyIGF0dHJpYnV0aW9uID0gdGhpcy5nZXRQcm9wZXJ0eShcImF0dHJpYnV0aW9uXCIpO1xuICAgICAgICBpZiAoYXR0cmlidXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9wZXJ0eVZhbHVlLnBhcnNlKGF0dHJpYnV0aW9uLCB0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUoW10sIHRoaXMub3B0aW9ucy5sb2NhbGUpO1xuICAgIH07XG4gICAgSUlJRlJlc291cmNlLnByb3RvdHlwZS5nZXREZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gdGhpcy5nZXRQcm9wZXJ0eShcImRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9wZXJ0eVZhbHVlLnBhcnNlKGRlc2NyaXB0aW9uLCB0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUoW10sIHRoaXMub3B0aW9ucy5sb2NhbGUpO1xuICAgIH07XG4gICAgSUlJRlJlc291cmNlLnByb3RvdHlwZS5nZXRIb21lcGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhvbWVwYWdlID0gdGhpcy5nZXRQcm9wZXJ0eShcImhvbWVwYWdlXCIpO1xuICAgICAgICBpZiAoIWhvbWVwYWdlKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIGlmICh0eXBlb2YgaG9tZXBhZ2UgPT0gXCJzdHJpbmdcIilcbiAgICAgICAgICAgIHJldHVybiBob21lcGFnZTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaG9tZXBhZ2UpICYmIGhvbWVwYWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgaG9tZXBhZ2UgPSBob21lcGFnZVswXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaG9tZXBhZ2VbXCJAaWRcIl0gfHwgaG9tZXBhZ2UuaWQ7XG4gICAgfTtcbiAgICBJSUlGUmVzb3VyY2UucHJvdG90eXBlLmdldElJSUZSZXNvdXJjZVR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5ub3JtYWxpc2VUeXBlKHRoaXMuZ2V0UHJvcGVydHkoXCJ0eXBlXCIpKTtcbiAgICB9O1xuICAgIElJSUZSZXNvdXJjZS5wcm90b3R5cGUuZ2V0TG9nbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxvZ28gPSB0aGlzLmdldFByb3BlcnR5KFwibG9nb1wiKTtcbiAgICAgICAgLy8gUHJlc2VudGF0aW9uIDMuXG4gICAgICAgIC8vIFRoZSBsb2dvIGlzIGV4Y2x1c2l2ZSB0byB0aGUgXCJwcm92aWRlclwiIHByb3BlcnR5LCB3aGljaCBpcyBvZiB0eXBlIFwiQWdlbnRcIi5cbiAgICAgICAgLy8gSW4gb3JkZXIgdG8gZnVsZmlsIGBtYW5pZmVzdC5nZXRMb2dvKClgIHdlIHNob3VsZCBjaGVja1xuICAgICAgICAvLyBXaGVuIFAzIGlzIGZ1bGx5IHN1cHBvcnRlZCwgdGhlIGZvbGxvd2luZyBzaG91bGQgd29yay5cbiAgICAgICAgLy8gcmV0dXJuIHRoaXMuZ2V0UHJvdmlkZXIoKT8uZ2V0TG9nbygpO1xuICAgICAgICBpZiAoIWxvZ28pIHtcbiAgICAgICAgICAgIHZhciBwcm92aWRlciA9IHRoaXMuZ2V0UHJvcGVydHkoXCJwcm92aWRlclwiKTtcbiAgICAgICAgICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvZ28gPSBwcm92aWRlci5sb2dvO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbG9nbylcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICBpZiAodHlwZW9mIGxvZ28gPT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICByZXR1cm4gbG9nbztcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobG9nbykgJiYgbG9nby5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxvZ28gPSBsb2dvWzBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2dvW1wiQGlkXCJdIHx8IGxvZ28uaWQ7XG4gICAgfTtcbiAgICBJSUlGUmVzb3VyY2UucHJvdG90eXBlLmdldExpY2Vuc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5nZXRMb2NhbGlzZWRWYWx1ZSh0aGlzLmdldFByb3BlcnR5KFwibGljZW5zZVwiKSwgdGhpcy5vcHRpb25zLmxvY2FsZSk7XG4gICAgfTtcbiAgICBJSUlGUmVzb3VyY2UucHJvdG90eXBlLmdldE5hdkRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh0aGlzLmdldFByb3BlcnR5KFwibmF2RGF0ZVwiKSk7XG4gICAgfTtcbiAgICBJSUlGUmVzb3VyY2UucHJvdG90eXBlLmdldFJlbGF0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwicmVsYXRlZFwiKTtcbiAgICB9O1xuICAgIElJSUZSZXNvdXJjZS5wcm90b3R5cGUuZ2V0U2VlQWxzbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJzZWVBbHNvXCIpO1xuICAgIH07XG4gICAgSUlJRlJlc291cmNlLnByb3RvdHlwZS5nZXRUcmFja2luZ0xhYmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VydmljZSA9ICh0aGlzLmdldFNlcnZpY2UoU2VydmljZVByb2ZpbGUuVFJBQ0tJTkdfRVhURU5TSU9OUykpO1xuICAgICAgICBpZiAoc2VydmljZSkge1xuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZ2V0UHJvcGVydHkoXCJ0cmFja2luZ0xhYmVsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgSUlJRlJlc291cmNlLnByb3RvdHlwZS5nZXREZWZhdWx0VHJlZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5kZWZhdWx0VHJlZSA9IG5ldyBUcmVlTm9kZShcInJvb3RcIik7XG4gICAgICAgIHRoaXMuZGVmYXVsdFRyZWUuZGF0YSA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRUcmVlO1xuICAgIH07XG4gICAgSUlJRlJlc291cmNlLnByb3RvdHlwZS5nZXRSZXF1aXJlZFN0YXRlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlcXVpcmVkU3RhdGVtZW50ID0gbnVsbDtcbiAgICAgICAgdmFyIF9yZXF1aXJlZFN0YXRlbWVudCA9IHRoaXMuZ2V0UHJvcGVydHkoXCJyZXF1aXJlZFN0YXRlbWVudFwiKTtcbiAgICAgICAgaWYgKF9yZXF1aXJlZFN0YXRlbWVudCkge1xuICAgICAgICAgICAgcmVxdWlyZWRTdGF0ZW1lbnQgPSBuZXcgTGFiZWxWYWx1ZVBhaXIodGhpcy5vcHRpb25zLmxvY2FsZSk7XG4gICAgICAgICAgICByZXF1aXJlZFN0YXRlbWVudC5wYXJzZShfcmVxdWlyZWRTdGF0ZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZmFsbCBiYWNrIHRvIGF0dHJpYnV0aW9uIChpZiBpdCBleGlzdHMpXG4gICAgICAgICAgICB2YXIgYXR0cmlidXRpb24gPSB0aGlzLmdldEF0dHJpYnV0aW9uKCk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXF1aXJlZFN0YXRlbWVudCA9IG5ldyBMYWJlbFZhbHVlUGFpcih0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICAgICAgICAgICAgICByZXF1aXJlZFN0YXRlbWVudC52YWx1ZSA9IGF0dHJpYnV0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXF1aXJlZFN0YXRlbWVudDtcbiAgICB9O1xuICAgIElJSUZSZXNvdXJjZS5wcm90b3R5cGUuaXNDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5nZXRJSUlGUmVzb3VyY2VUeXBlKCkgPT09IElJSUZSZXNvdXJjZVR5cGUuQ09MTEVDVElPTikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgSUlJRlJlc291cmNlLnByb3RvdHlwZS5pc01hbmlmZXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5nZXRJSUlGUmVzb3VyY2VUeXBlKCkgPT09IElJSUZSZXNvdXJjZVR5cGUuTUFOSUZFU1QpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIElJSUZSZXNvdXJjZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgIGlmICh0aGF0LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGF0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zXzEgPSB0aGF0Lm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgb3B0aW9uc18xLm5hdkRhdGUgPSB0aGF0LmdldE5hdkRhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSB0aGF0Ll9fanNvbmxkLmlkO1xuICAgICAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWQgPSB0aGF0Ll9fanNvbmxkW1wiQGlkXCJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBVdGlscy5sb2FkTWFuaWZlc3QoaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5wYXJlbnRMYWJlbCA9IHRoYXQuZ2V0TGFiZWwoKS5nZXRWYWx1ZShvcHRpb25zXzEubG9jYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnNlZCA9IERlc2VyaWFsaXNlci5wYXJzZShkYXRhLCBvcHRpb25zXzEpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0ID0gT2JqZWN0LmFzc2lnbih0aGF0LCBwYXJzZWQpO1xuICAgICAgICAgICAgICAgICAgICAvL3RoYXQucGFyZW50Q29sbGVjdGlvbiA9IG9wdGlvbnMucmVzb3VyY2UucGFyZW50Q29sbGVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5pbmRleCA9IG9wdGlvbnNfMS5pbmRleDtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGF0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gSUlJRlJlc291cmNlO1xufShNYW5pZmVzdFJlc291cmNlKSk7XG5leHBvcnQgeyBJSUlGUmVzb3VyY2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUlJSUZSZXNvdXJjZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/IIIFResource.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/JSONLDResource.js":
/*!*******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/JSONLDResource.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JSONLDResource: () => (/* binding */ JSONLDResource)\n/* harmony export */ });\nvar JSONLDResource = /** @class */ (function () {\n    function JSONLDResource(jsonld) {\n        this.__jsonld = jsonld;\n        this.context = this.getProperty(\"context\");\n        this.id = this.getProperty(\"id\");\n    }\n    JSONLDResource.prototype.getProperty = function (name) {\n        var prop = null;\n        if (this.__jsonld) {\n            prop = this.__jsonld[name];\n            if (!prop) {\n                // property may have a prepended '@'\n                prop = this.__jsonld[\"@\" + name];\n            }\n        }\n        return prop;\n    };\n    return JSONLDResource;\n}());\n\n//# sourceMappingURL=JSONLDResource.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvSlNPTkxEUmVzb3VyY2UuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDeUI7QUFDMUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9KU09OTERSZXNvdXJjZS5qcz9iNDZkIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBKU09OTERSZXNvdXJjZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBKU09OTERSZXNvdXJjZShqc29ubGQpIHtcbiAgICAgICAgdGhpcy5fX2pzb25sZCA9IGpzb25sZDtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gdGhpcy5nZXRQcm9wZXJ0eShcImNvbnRleHRcIik7XG4gICAgICAgIHRoaXMuaWQgPSB0aGlzLmdldFByb3BlcnR5KFwiaWRcIik7XG4gICAgfVxuICAgIEpTT05MRFJlc291cmNlLnByb3RvdHlwZS5nZXRQcm9wZXJ0eSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBwcm9wID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuX19qc29ubGQpIHtcbiAgICAgICAgICAgIHByb3AgPSB0aGlzLl9fanNvbmxkW25hbWVdO1xuICAgICAgICAgICAgaWYgKCFwcm9wKSB7XG4gICAgICAgICAgICAgICAgLy8gcHJvcGVydHkgbWF5IGhhdmUgYSBwcmVwZW5kZWQgJ0AnXG4gICAgICAgICAgICAgICAgcHJvcCA9IHRoaXMuX19qc29ubGRbXCJAXCIgKyBuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcDtcbiAgICB9O1xuICAgIHJldHVybiBKU09OTERSZXNvdXJjZTtcbn0oKSk7XG5leHBvcnQgeyBKU09OTERSZXNvdXJjZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SlNPTkxEUmVzb3VyY2UuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/JSONLDResource.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/LabelValuePair.js":
/*!*******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/LabelValuePair.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LabelValuePair: () => (/* binding */ LabelValuePair)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n\nvar LabelValuePair = /** @class */ (function () {\n    function LabelValuePair(defaultLocale) {\n        this.defaultLocale = defaultLocale;\n    }\n    LabelValuePair.prototype.parse = function (resource) {\n        this.resource = resource;\n        this.label = _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue.parse(this.resource.label, this.defaultLocale);\n        this.value = _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue.parse(this.resource.value, this.defaultLocale);\n    };\n    // shortcuts to get/set values based on user or default locale\n    LabelValuePair.prototype.getLabel = function (locale) {\n        if (this.label === null) {\n            return null;\n        }\n        if (Array.isArray(locale) && !locale.length) {\n            locale = undefined;\n        }\n        return this.label.getValue(locale || this.defaultLocale);\n    };\n    LabelValuePair.prototype.setLabel = function (value) {\n        if (this.label === null) {\n            this.label = new _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue([]);\n        }\n        this.label.setValue(value, this.defaultLocale);\n    };\n    LabelValuePair.prototype.getValue = function (locale, joinWith) {\n        if (joinWith === void 0) { joinWith = \"<br/>\"; }\n        if (this.value === null) {\n            return null;\n        }\n        if (Array.isArray(locale) && !locale.length) {\n            locale = undefined;\n        }\n        return this.value.getValue(locale || this.defaultLocale, joinWith);\n    };\n    LabelValuePair.prototype.getValues = function (locale) {\n        if (this.value === null) {\n            return [];\n        }\n        if (Array.isArray(locale) && !locale.length) {\n            locale = undefined;\n        }\n        return this.value.getValues(locale || this.defaultLocale);\n    };\n    LabelValuePair.prototype.setValue = function (value) {\n        if (this.value === null) {\n            this.value = new _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue([]);\n        }\n        this.value.setValue(value, this.defaultLocale);\n    };\n    return LabelValuePair;\n}());\n\n//# sourceMappingURL=LabelValuePair.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvTGFiZWxWYWx1ZVBhaXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLG9EQUFhO0FBQ2xDLHFCQUFxQixvREFBYTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvREFBYTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvREFBYTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDeUI7QUFDMUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9MYWJlbFZhbHVlUGFpci5qcz9mMTllIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByb3BlcnR5VmFsdWUgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIExhYmVsVmFsdWVQYWlyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExhYmVsVmFsdWVQYWlyKGRlZmF1bHRMb2NhbGUpIHtcbiAgICAgICAgdGhpcy5kZWZhdWx0TG9jYWxlID0gZGVmYXVsdExvY2FsZTtcbiAgICB9XG4gICAgTGFiZWxWYWx1ZVBhaXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHJlc291cmNlKSB7XG4gICAgICAgIHRoaXMucmVzb3VyY2UgPSByZXNvdXJjZTtcbiAgICAgICAgdGhpcy5sYWJlbCA9IFByb3BlcnR5VmFsdWUucGFyc2UodGhpcy5yZXNvdXJjZS5sYWJlbCwgdGhpcy5kZWZhdWx0TG9jYWxlKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IFByb3BlcnR5VmFsdWUucGFyc2UodGhpcy5yZXNvdXJjZS52YWx1ZSwgdGhpcy5kZWZhdWx0TG9jYWxlKTtcbiAgICB9O1xuICAgIC8vIHNob3J0Y3V0cyB0byBnZXQvc2V0IHZhbHVlcyBiYXNlZCBvbiB1c2VyIG9yIGRlZmF1bHQgbG9jYWxlXG4gICAgTGFiZWxWYWx1ZVBhaXIucHJvdG90eXBlLmdldExhYmVsID0gZnVuY3Rpb24gKGxvY2FsZSkge1xuICAgICAgICBpZiAodGhpcy5sYWJlbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobG9jYWxlKSAmJiAhbG9jYWxlLmxlbmd0aCkge1xuICAgICAgICAgICAgbG9jYWxlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmxhYmVsLmdldFZhbHVlKGxvY2FsZSB8fCB0aGlzLmRlZmF1bHRMb2NhbGUpO1xuICAgIH07XG4gICAgTGFiZWxWYWx1ZVBhaXIucHJvdG90eXBlLnNldExhYmVsID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLmxhYmVsID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsID0gbmV3IFByb3BlcnR5VmFsdWUoW10pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubGFiZWwuc2V0VmFsdWUodmFsdWUsIHRoaXMuZGVmYXVsdExvY2FsZSk7XG4gICAgfTtcbiAgICBMYWJlbFZhbHVlUGFpci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAobG9jYWxlLCBqb2luV2l0aCkge1xuICAgICAgICBpZiAoam9pbldpdGggPT09IHZvaWQgMCkgeyBqb2luV2l0aCA9IFwiPGJyLz5cIjsgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobG9jYWxlKSAmJiAhbG9jYWxlLmxlbmd0aCkge1xuICAgICAgICAgICAgbG9jYWxlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmdldFZhbHVlKGxvY2FsZSB8fCB0aGlzLmRlZmF1bHRMb2NhbGUsIGpvaW5XaXRoKTtcbiAgICB9O1xuICAgIExhYmVsVmFsdWVQYWlyLnByb3RvdHlwZS5nZXRWYWx1ZXMgPSBmdW5jdGlvbiAobG9jYWxlKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobG9jYWxlKSAmJiAhbG9jYWxlLmxlbmd0aCkge1xuICAgICAgICAgICAgbG9jYWxlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmdldFZhbHVlcyhsb2NhbGUgfHwgdGhpcy5kZWZhdWx0TG9jYWxlKTtcbiAgICB9O1xuICAgIExhYmVsVmFsdWVQYWlyLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBQcm9wZXJ0eVZhbHVlKFtdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbHVlLnNldFZhbHVlKHZhbHVlLCB0aGlzLmRlZmF1bHRMb2NhbGUpO1xuICAgIH07XG4gICAgcmV0dXJuIExhYmVsVmFsdWVQYWlyO1xufSgpKTtcbmV4cG9ydCB7IExhYmVsVmFsdWVQYWlyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1MYWJlbFZhbHVlUGFpci5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/LabelValuePair.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/LanguageMap.js":
/*!****************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/LanguageMap.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LanguageMap: () => (/* binding */ LanguageMap)\n/* harmony export */ });\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/** @deprecated Use PropertyValue instead */\nvar LanguageMap = /** @class */ (function (_super) {\n    __extends(LanguageMap, _super);\n    function LanguageMap() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /** @deprecated Use the `PropertyValue#getValue` instance method instead */\n    LanguageMap.getValue = function (languageCollection, locale) {\n        return languageCollection.getValue(locale, \"<br/>\");\n    };\n    /** @deprecated Use the `PropertyValue#getValues` instance method instead */\n    LanguageMap.getValues = function (languageCollection, locale) {\n        return languageCollection.getValues(locale);\n    };\n    return LanguageMap;\n}(Array));\n\n//# sourceMappingURL=LanguageMap.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvTGFuZ3VhZ2VNYXAuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3NCO0FBQ3ZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvTGFuZ3VhZ2VNYXAuanM/MTg5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbi8qKiBAZGVwcmVjYXRlZCBVc2UgUHJvcGVydHlWYWx1ZSBpbnN0ZWFkICovXG52YXIgTGFuZ3VhZ2VNYXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExhbmd1YWdlTWFwLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExhbmd1YWdlTWFwKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIC8qKiBAZGVwcmVjYXRlZCBVc2UgdGhlIGBQcm9wZXJ0eVZhbHVlI2dldFZhbHVlYCBpbnN0YW5jZSBtZXRob2QgaW5zdGVhZCAqL1xuICAgIExhbmd1YWdlTWFwLmdldFZhbHVlID0gZnVuY3Rpb24gKGxhbmd1YWdlQ29sbGVjdGlvbiwgbG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBsYW5ndWFnZUNvbGxlY3Rpb24uZ2V0VmFsdWUobG9jYWxlLCBcIjxici8+XCIpO1xuICAgIH07XG4gICAgLyoqIEBkZXByZWNhdGVkIFVzZSB0aGUgYFByb3BlcnR5VmFsdWUjZ2V0VmFsdWVzYCBpbnN0YW5jZSBtZXRob2QgaW5zdGVhZCAqL1xuICAgIExhbmd1YWdlTWFwLmdldFZhbHVlcyA9IGZ1bmN0aW9uIChsYW5ndWFnZUNvbGxlY3Rpb24sIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gbGFuZ3VhZ2VDb2xsZWN0aW9uLmdldFZhbHVlcyhsb2NhbGUpO1xuICAgIH07XG4gICAgcmV0dXJuIExhbmd1YWdlTWFwO1xufShBcnJheSkpO1xuZXhwb3J0IHsgTGFuZ3VhZ2VNYXAgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUxhbmd1YWdlTWFwLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/LanguageMap.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Manifest.js":
/*!*************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Manifest.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Manifest: () => (/* binding */ Manifest)\n/* harmony export */ });\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar Manifest = /** @class */ (function (_super) {\n    __extends(Manifest, _super);\n    function Manifest(jsonld, options) {\n        var _this = _super.call(this, jsonld, options) || this;\n        _this.index = 0;\n        _this._allRanges = null;\n        _this.items = [];\n        _this._topRanges = [];\n        if (_this.__jsonld.structures && _this.__jsonld.structures.length) {\n            var topRanges = _this._getTopRanges();\n            for (var i = 0; i < topRanges.length; i++) {\n                var range = topRanges[i];\n                _this._parseRanges(range, String(i));\n            }\n        }\n        return _this;\n    }\n    /** @deprecated Use getAccompanyingCanvas instead */\n    Manifest.prototype.getPosterCanvas = function () {\n        var posterCanvas = this.getProperty(\"posterCanvas\");\n        if (posterCanvas) {\n            posterCanvas = new _internal__WEBPACK_IMPORTED_MODULE_1__.Canvas(posterCanvas, this.options);\n        }\n        return posterCanvas;\n    };\n    Manifest.prototype.getAccompanyingCanvas = function () {\n        var accompanyingCanvas = this.getProperty(\"accompanyingCanvas\");\n        if (accompanyingCanvas) {\n            accompanyingCanvas = new _internal__WEBPACK_IMPORTED_MODULE_1__.Canvas(accompanyingCanvas, this.options);\n        }\n        return accompanyingCanvas;\n    };\n    Manifest.prototype.getBehavior = function () {\n        var behavior = this.getProperty(\"behavior\");\n        if (Array.isArray(behavior)) {\n            behavior = behavior[0];\n        }\n        if (behavior) {\n            return behavior;\n        }\n        return null;\n    };\n    Manifest.prototype.getDefaultTree = function () {\n        _super.prototype.getDefaultTree.call(this);\n        this.defaultTree.data.type = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_1__.TreeNodeType.MANIFEST);\n        if (!this.isLoaded) {\n            return this.defaultTree;\n        }\n        var topRanges = this.getTopRanges();\n        // if there are any ranges in the manifest, default to the first 'top' range or generated placeholder\n        if (topRanges.length) {\n            topRanges[0].getTree(this.defaultTree);\n        }\n        _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.generateTreeNodeIds(this.defaultTree);\n        return this.defaultTree;\n    };\n    Manifest.prototype._getTopRanges = function () {\n        var topRanges = [];\n        if (this.__jsonld.structures && this.__jsonld.structures.length) {\n            for (var i = 0; i < this.__jsonld.structures.length; i++) {\n                var json = this.__jsonld.structures[i];\n                if (json.viewingHint === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingHint.TOP) {\n                    topRanges.push(json);\n                }\n            }\n            // if no viewingHint=\"top\" range was found, create a default one\n            if (!topRanges.length) {\n                var range = {};\n                range.ranges = this.__jsonld.structures;\n                topRanges.push(range);\n            }\n        }\n        return topRanges;\n    };\n    Manifest.prototype.getTopRanges = function () {\n        return this._topRanges;\n    };\n    Manifest.prototype._getRangeById = function (id) {\n        if (this.__jsonld.structures && this.__jsonld.structures.length) {\n            for (var i = 0; i < this.__jsonld.structures.length; i++) {\n                var r = this.__jsonld.structures[i];\n                if (r[\"@id\"] === id || r.id === id) {\n                    return r;\n                }\n            }\n        }\n        return null;\n    };\n    //private _parseRangeCanvas(json: any, range: Range): void {\n    // todo: currently this isn't needed\n    //var canvas: IJSONLDResource = new JSONLDResource(json);\n    //range.items.push(<IManifestResource>canvas);\n    //}\n    Manifest.prototype._parseRanges = function (r, path, parentRange) {\n        var range;\n        var id = null;\n        if (typeof r === \"string\") {\n            id = r;\n            r = this._getRangeById(id);\n        }\n        if (!r) {\n            console.warn(\"Range:\", id, \"does not exist\");\n            return;\n        }\n        range = new _internal__WEBPACK_IMPORTED_MODULE_1__.Range(r, this.options);\n        range.parentRange = parentRange;\n        range.path = path;\n        if (!parentRange) {\n            this._topRanges.push(range);\n        }\n        else {\n            parentRange.items.push(range);\n        }\n        var items = r.items || r.members;\n        if (items) {\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i];\n                // todo: use an ItemType constant?\n                if ((item[\"@type\"] && item[\"@type\"].toLowerCase() === \"sc:range\") ||\n                    (item[\"type\"] && item[\"type\"].toLowerCase() === \"range\")) {\n                    this._parseRanges(item, path + \"/\" + i, range);\n                }\n                else if ((item[\"@type\"] && item[\"@type\"].toLowerCase() === \"sc:canvas\") ||\n                    (item[\"type\"] && item[\"type\"].toLowerCase() === \"canvas\")) {\n                    // store the ids on the __jsonld object to be used by Range.getCanvasIds()\n                    if (!range.canvases) {\n                        range.canvases = [];\n                    }\n                    var id_1 = item.id || item[\"@id\"];\n                    range.canvases.push(id_1);\n                }\n            }\n        }\n        else if (r.ranges) {\n            for (var i = 0; i < r.ranges.length; i++) {\n                this._parseRanges(r.ranges[i], path + \"/\" + i, range);\n            }\n        }\n    };\n    Manifest.prototype.getAllRanges = function () {\n        if (this._allRanges != null)\n            return this._allRanges;\n        this._allRanges = [];\n        var topRanges = this.getTopRanges();\n        var _loop_1 = function (i) {\n            var topRange = topRanges[i];\n            if (topRange.id) {\n                this_1._allRanges.push(topRange); // it might be a placeholder root range\n            }\n            var reducer = function (acc, next) {\n                acc.add(next);\n                var nextRanges = next.getRanges();\n                if (nextRanges.length) {\n                    return nextRanges.reduce(reducer, acc);\n                }\n                return acc;\n            };\n            var subRanges = Array.from(topRange.getRanges().reduce(reducer, new Set()));\n            this_1._allRanges = this_1._allRanges.concat(subRanges);\n        };\n        var this_1 = this;\n        for (var i = 0; i < topRanges.length; i++) {\n            _loop_1(i);\n        }\n        return this._allRanges;\n    };\n    Manifest.prototype.getRangeById = function (id) {\n        var ranges = this.getAllRanges();\n        for (var i = 0; i < ranges.length; i++) {\n            var range = ranges[i];\n            if (range.id === id) {\n                return range;\n            }\n        }\n        return null;\n    };\n    Manifest.prototype.getRangeByPath = function (path) {\n        var ranges = this.getAllRanges();\n        for (var i = 0; i < ranges.length; i++) {\n            var range = ranges[i];\n            if (range.path === path) {\n                return range;\n            }\n        }\n        return null;\n    };\n    Manifest.prototype.getSequences = function () {\n        if (this.items.length) {\n            return this.items;\n        }\n        // IxIF mediaSequences overrode sequences, so need to be checked first.\n        // deprecate this when presentation 3 ships\n        var items = this.__jsonld.mediaSequences || this.__jsonld.sequences;\n        if (items) {\n            for (var i = 0; i < items.length; i++) {\n                var s = items[i];\n                var sequence = new _internal__WEBPACK_IMPORTED_MODULE_1__.Sequence(s, this.options);\n                this.items.push(sequence);\n            }\n        }\n        else if (this.__jsonld.items) {\n            var sequence = new _internal__WEBPACK_IMPORTED_MODULE_1__.Sequence(this.__jsonld.items, this.options);\n            this.items.push(sequence);\n        }\n        return this.items;\n    };\n    Manifest.prototype.getSequenceByIndex = function (sequenceIndex) {\n        return this.getSequences()[sequenceIndex];\n    };\n    Manifest.prototype.getTotalSequences = function () {\n        return this.getSequences().length;\n    };\n    Manifest.prototype.getManifestType = function () {\n        var service = (this.getService(_iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ServiceProfile.UI_EXTENSIONS));\n        if (service) {\n            return service.getProperty(\"manifestType\");\n        }\n        return _internal__WEBPACK_IMPORTED_MODULE_1__.ManifestType.EMPTY;\n    };\n    Manifest.prototype.isMultiSequence = function () {\n        return this.getTotalSequences() > 1;\n    };\n    Manifest.prototype.isPagingEnabled = function () {\n        var viewingHint = this.getViewingHint();\n        if (viewingHint) {\n            return viewingHint === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingHint.PAGED;\n        }\n        var behavior = this.getBehavior();\n        if (behavior) {\n            return behavior === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.Behavior.PAGED;\n        }\n        return false;\n    };\n    Manifest.prototype.getViewingDirection = function () {\n        return this.getProperty(\"viewingDirection\");\n    };\n    Manifest.prototype.getViewingHint = function () {\n        return this.getProperty(\"viewingHint\");\n    };\n    return Manifest;\n}(_internal__WEBPACK_IMPORTED_MODULE_1__.IIIFResource));\n\n//# sourceMappingURL=Manifest.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvTWFuaWZlc3QuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNzRjtBQUNlO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHNCQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2Q0FBTTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsNkNBQU07QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDRDQUFLLGVBQWUsbURBQVk7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNENBQUs7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHFDQUFxQztBQUNqRTtBQUNBLHlDQUF5Qyx1RUFBVztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHFDQUFxQztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNENBQUs7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0JBQWtCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtEO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNCQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixtQkFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGtCQUFrQjtBQUM5QztBQUNBLG1DQUFtQywrQ0FBUTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwrQ0FBUTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDBFQUFjO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbURBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsdUVBQVc7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLG9FQUFRO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLG1EQUFZO0FBQ007QUFDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9NYW5pZmVzdC5qcz9lNzI0Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgVmlld2luZ0hpbnQsIEJlaGF2aW9yLCBTZXJ2aWNlUHJvZmlsZSB9IGZyb20gXCJAaWlpZi92b2NhYnVsYXJ5L2Rpc3QtY29tbW9uanNcIjtcbmltcG9ydCB7IENhbnZhcywgSUlJRlJlc291cmNlLCBNYW5pZmVzdFR5cGUsIFJhbmdlLCBTZXF1ZW5jZSwgVHJlZU5vZGVUeXBlLCBVdGlscyB9IGZyb20gXCIuL2ludGVybmFsXCI7XG52YXIgTWFuaWZlc3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE1hbmlmZXN0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE1hbmlmZXN0KGpzb25sZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBqc29ubGQsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmluZGV4ID0gMDtcbiAgICAgICAgX3RoaXMuX2FsbFJhbmdlcyA9IG51bGw7XG4gICAgICAgIF90aGlzLml0ZW1zID0gW107XG4gICAgICAgIF90aGlzLl90b3BSYW5nZXMgPSBbXTtcbiAgICAgICAgaWYgKF90aGlzLl9fanNvbmxkLnN0cnVjdHVyZXMgJiYgX3RoaXMuX19qc29ubGQuc3RydWN0dXJlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciB0b3BSYW5nZXMgPSBfdGhpcy5fZ2V0VG9wUmFuZ2VzKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvcFJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRvcFJhbmdlc1tpXTtcbiAgICAgICAgICAgICAgICBfdGhpcy5fcGFyc2VSYW5nZXMocmFuZ2UsIFN0cmluZyhpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKiogQGRlcHJlY2F0ZWQgVXNlIGdldEFjY29tcGFueWluZ0NhbnZhcyBpbnN0ZWFkICovXG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmdldFBvc3RlckNhbnZhcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBvc3RlckNhbnZhcyA9IHRoaXMuZ2V0UHJvcGVydHkoXCJwb3N0ZXJDYW52YXNcIik7XG4gICAgICAgIGlmIChwb3N0ZXJDYW52YXMpIHtcbiAgICAgICAgICAgIHBvc3RlckNhbnZhcyA9IG5ldyBDYW52YXMocG9zdGVyQ2FudmFzLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwb3N0ZXJDYW52YXM7XG4gICAgfTtcbiAgICBNYW5pZmVzdC5wcm90b3R5cGUuZ2V0QWNjb21wYW55aW5nQ2FudmFzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYWNjb21wYW55aW5nQ2FudmFzID0gdGhpcy5nZXRQcm9wZXJ0eShcImFjY29tcGFueWluZ0NhbnZhc1wiKTtcbiAgICAgICAgaWYgKGFjY29tcGFueWluZ0NhbnZhcykge1xuICAgICAgICAgICAgYWNjb21wYW55aW5nQ2FudmFzID0gbmV3IENhbnZhcyhhY2NvbXBhbnlpbmdDYW52YXMsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjY29tcGFueWluZ0NhbnZhcztcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5nZXRCZWhhdmlvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJlaGF2aW9yID0gdGhpcy5nZXRQcm9wZXJ0eShcImJlaGF2aW9yXCIpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShiZWhhdmlvcikpIHtcbiAgICAgICAgICAgIGJlaGF2aW9yID0gYmVoYXZpb3JbMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJlaGF2aW9yKSB7XG4gICAgICAgICAgICByZXR1cm4gYmVoYXZpb3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBNYW5pZmVzdC5wcm90b3R5cGUuZ2V0RGVmYXVsdFRyZWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZ2V0RGVmYXVsdFRyZWUuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VHJlZS5kYXRhLnR5cGUgPSBVdGlscy5ub3JtYWxpc2VUeXBlKFRyZWVOb2RlVHlwZS5NQU5JRkVTVCk7XG4gICAgICAgIGlmICghdGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdFRyZWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRvcFJhbmdlcyA9IHRoaXMuZ2V0VG9wUmFuZ2VzKCk7XG4gICAgICAgIC8vIGlmIHRoZXJlIGFyZSBhbnkgcmFuZ2VzIGluIHRoZSBtYW5pZmVzdCwgZGVmYXVsdCB0byB0aGUgZmlyc3QgJ3RvcCcgcmFuZ2Ugb3IgZ2VuZXJhdGVkIHBsYWNlaG9sZGVyXG4gICAgICAgIGlmICh0b3BSYW5nZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0b3BSYW5nZXNbMF0uZ2V0VHJlZSh0aGlzLmRlZmF1bHRUcmVlKTtcbiAgICAgICAgfVxuICAgICAgICBVdGlscy5nZW5lcmF0ZVRyZWVOb2RlSWRzKHRoaXMuZGVmYXVsdFRyZWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0VHJlZTtcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5fZ2V0VG9wUmFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9wUmFuZ2VzID0gW107XG4gICAgICAgIGlmICh0aGlzLl9fanNvbmxkLnN0cnVjdHVyZXMgJiYgdGhpcy5fX2pzb25sZC5zdHJ1Y3R1cmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9fanNvbmxkLnN0cnVjdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIganNvbiA9IHRoaXMuX19qc29ubGQuc3RydWN0dXJlc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoanNvbi52aWV3aW5nSGludCA9PT0gVmlld2luZ0hpbnQuVE9QKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcFJhbmdlcy5wdXNoKGpzb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vIHZpZXdpbmdIaW50PVwidG9wXCIgcmFuZ2Ugd2FzIGZvdW5kLCBjcmVhdGUgYSBkZWZhdWx0IG9uZVxuICAgICAgICAgICAgaWYgKCF0b3BSYW5nZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0ge307XG4gICAgICAgICAgICAgICAgcmFuZ2UucmFuZ2VzID0gdGhpcy5fX2pzb25sZC5zdHJ1Y3R1cmVzO1xuICAgICAgICAgICAgICAgIHRvcFJhbmdlcy5wdXNoKHJhbmdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG9wUmFuZ2VzO1xuICAgIH07XG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmdldFRvcFJhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RvcFJhbmdlcztcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5fZ2V0UmFuZ2VCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIGlmICh0aGlzLl9fanNvbmxkLnN0cnVjdHVyZXMgJiYgdGhpcy5fX2pzb25sZC5zdHJ1Y3R1cmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9fanNvbmxkLnN0cnVjdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgciA9IHRoaXMuX19qc29ubGQuc3RydWN0dXJlc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAocltcIkBpZFwiXSA9PT0gaWQgfHwgci5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgLy9wcml2YXRlIF9wYXJzZVJhbmdlQ2FudmFzKGpzb246IGFueSwgcmFuZ2U6IFJhbmdlKTogdm9pZCB7XG4gICAgLy8gdG9kbzogY3VycmVudGx5IHRoaXMgaXNuJ3QgbmVlZGVkXG4gICAgLy92YXIgY2FudmFzOiBJSlNPTkxEUmVzb3VyY2UgPSBuZXcgSlNPTkxEUmVzb3VyY2UoanNvbik7XG4gICAgLy9yYW5nZS5pdGVtcy5wdXNoKDxJTWFuaWZlc3RSZXNvdXJjZT5jYW52YXMpO1xuICAgIC8vfVxuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5fcGFyc2VSYW5nZXMgPSBmdW5jdGlvbiAociwgcGF0aCwgcGFyZW50UmFuZ2UpIHtcbiAgICAgICAgdmFyIHJhbmdlO1xuICAgICAgICB2YXIgaWQgPSBudWxsO1xuICAgICAgICBpZiAodHlwZW9mIHIgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGlkID0gcjtcbiAgICAgICAgICAgIHIgPSB0aGlzLl9nZXRSYW5nZUJ5SWQoaWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiUmFuZ2U6XCIsIGlkLCBcImRvZXMgbm90IGV4aXN0XCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJhbmdlID0gbmV3IFJhbmdlKHIsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIHJhbmdlLnBhcmVudFJhbmdlID0gcGFyZW50UmFuZ2U7XG4gICAgICAgIHJhbmdlLnBhdGggPSBwYXRoO1xuICAgICAgICBpZiAoIXBhcmVudFJhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl90b3BSYW5nZXMucHVzaChyYW5nZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXJlbnRSYW5nZS5pdGVtcy5wdXNoKHJhbmdlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXRlbXMgPSByLml0ZW1zIHx8IHIubWVtYmVycztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgICAgICAgICAgICAvLyB0b2RvOiB1c2UgYW4gSXRlbVR5cGUgY29uc3RhbnQ/XG4gICAgICAgICAgICAgICAgaWYgKChpdGVtW1wiQHR5cGVcIl0gJiYgaXRlbVtcIkB0eXBlXCJdLnRvTG93ZXJDYXNlKCkgPT09IFwic2M6cmFuZ2VcIikgfHxcbiAgICAgICAgICAgICAgICAgICAgKGl0ZW1bXCJ0eXBlXCJdICYmIGl0ZW1bXCJ0eXBlXCJdLnRvTG93ZXJDYXNlKCkgPT09IFwicmFuZ2VcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VSYW5nZXMoaXRlbSwgcGF0aCArIFwiL1wiICsgaSwgcmFuZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICgoaXRlbVtcIkB0eXBlXCJdICYmIGl0ZW1bXCJAdHlwZVwiXS50b0xvd2VyQ2FzZSgpID09PSBcInNjOmNhbnZhc1wiKSB8fFxuICAgICAgICAgICAgICAgICAgICAoaXRlbVtcInR5cGVcIl0gJiYgaXRlbVtcInR5cGVcIl0udG9Mb3dlckNhc2UoKSA9PT0gXCJjYW52YXNcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc3RvcmUgdGhlIGlkcyBvbiB0aGUgX19qc29ubGQgb2JqZWN0IHRvIGJlIHVzZWQgYnkgUmFuZ2UuZ2V0Q2FudmFzSWRzKClcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyYW5nZS5jYW52YXNlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuY2FudmFzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRfMSA9IGl0ZW0uaWQgfHwgaXRlbVtcIkBpZFwiXTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuY2FudmFzZXMucHVzaChpZF8xKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoci5yYW5nZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgci5yYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZVJhbmdlcyhyLnJhbmdlc1tpXSwgcGF0aCArIFwiL1wiICsgaSwgcmFuZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBNYW5pZmVzdC5wcm90b3R5cGUuZ2V0QWxsUmFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYWxsUmFuZ2VzICE9IG51bGwpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWxsUmFuZ2VzO1xuICAgICAgICB0aGlzLl9hbGxSYW5nZXMgPSBbXTtcbiAgICAgICAgdmFyIHRvcFJhbmdlcyA9IHRoaXMuZ2V0VG9wUmFuZ2VzKCk7XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHZhciB0b3BSYW5nZSA9IHRvcFJhbmdlc1tpXTtcbiAgICAgICAgICAgIGlmICh0b3BSYW5nZS5pZCkge1xuICAgICAgICAgICAgICAgIHRoaXNfMS5fYWxsUmFuZ2VzLnB1c2godG9wUmFuZ2UpOyAvLyBpdCBtaWdodCBiZSBhIHBsYWNlaG9sZGVyIHJvb3QgcmFuZ2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWR1Y2VyID0gZnVuY3Rpb24gKGFjYywgbmV4dCkge1xuICAgICAgICAgICAgICAgIGFjYy5hZGQobmV4dCk7XG4gICAgICAgICAgICAgICAgdmFyIG5leHRSYW5nZXMgPSBuZXh0LmdldFJhbmdlcygpO1xuICAgICAgICAgICAgICAgIGlmIChuZXh0UmFuZ2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dFJhbmdlcy5yZWR1Y2UocmVkdWNlciwgYWNjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc3ViUmFuZ2VzID0gQXJyYXkuZnJvbSh0b3BSYW5nZS5nZXRSYW5nZXMoKS5yZWR1Y2UocmVkdWNlciwgbmV3IFNldCgpKSk7XG4gICAgICAgICAgICB0aGlzXzEuX2FsbFJhbmdlcyA9IHRoaXNfMS5fYWxsUmFuZ2VzLmNvbmNhdChzdWJSYW5nZXMpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgdGhpc18xID0gdGhpcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3BSYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIF9sb29wXzEoaSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2FsbFJhbmdlcztcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5nZXRSYW5nZUJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgdmFyIHJhbmdlcyA9IHRoaXMuZ2V0QWxsUmFuZ2VzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07XG4gICAgICAgICAgICBpZiAocmFuZ2UuaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmdldFJhbmdlQnlQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIHJhbmdlcyA9IHRoaXMuZ2V0QWxsUmFuZ2VzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07XG4gICAgICAgICAgICBpZiAocmFuZ2UucGF0aCA9PT0gcGF0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByYW5nZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5nZXRTZXF1ZW5jZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXM7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSXhJRiBtZWRpYVNlcXVlbmNlcyBvdmVycm9kZSBzZXF1ZW5jZXMsIHNvIG5lZWQgdG8gYmUgY2hlY2tlZCBmaXJzdC5cbiAgICAgICAgLy8gZGVwcmVjYXRlIHRoaXMgd2hlbiBwcmVzZW50YXRpb24gMyBzaGlwc1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLl9fanNvbmxkLm1lZGlhU2VxdWVuY2VzIHx8IHRoaXMuX19qc29ubGQuc2VxdWVuY2VzO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IGl0ZW1zW2ldO1xuICAgICAgICAgICAgICAgIHZhciBzZXF1ZW5jZSA9IG5ldyBTZXF1ZW5jZShzLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaChzZXF1ZW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fX2pzb25sZC5pdGVtcykge1xuICAgICAgICAgICAgdmFyIHNlcXVlbmNlID0gbmV3IFNlcXVlbmNlKHRoaXMuX19qc29ubGQuaXRlbXMsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goc2VxdWVuY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zO1xuICAgIH07XG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmdldFNlcXVlbmNlQnlJbmRleCA9IGZ1bmN0aW9uIChzZXF1ZW5jZUluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNlcXVlbmNlcygpW3NlcXVlbmNlSW5kZXhdO1xuICAgIH07XG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmdldFRvdGFsU2VxdWVuY2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTZXF1ZW5jZXMoKS5sZW5ndGg7XG4gICAgfTtcbiAgICBNYW5pZmVzdC5wcm90b3R5cGUuZ2V0TWFuaWZlc3RUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VydmljZSA9ICh0aGlzLmdldFNlcnZpY2UoU2VydmljZVByb2ZpbGUuVUlfRVhURU5TSU9OUykpO1xuICAgICAgICBpZiAoc2VydmljZSkge1xuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZ2V0UHJvcGVydHkoXCJtYW5pZmVzdFR5cGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE1hbmlmZXN0VHlwZS5FTVBUWTtcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5pc011bHRpU2VxdWVuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFRvdGFsU2VxdWVuY2VzKCkgPiAxO1xuICAgIH07XG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmlzUGFnaW5nRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXdpbmdIaW50ID0gdGhpcy5nZXRWaWV3aW5nSGludCgpO1xuICAgICAgICBpZiAodmlld2luZ0hpbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3aW5nSGludCA9PT0gVmlld2luZ0hpbnQuUEFHRUQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJlaGF2aW9yID0gdGhpcy5nZXRCZWhhdmlvcigpO1xuICAgICAgICBpZiAoYmVoYXZpb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBiZWhhdmlvciA9PT0gQmVoYXZpb3IuUEFHRUQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgTWFuaWZlc3QucHJvdG90eXBlLmdldFZpZXdpbmdEaXJlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwidmlld2luZ0RpcmVjdGlvblwiKTtcbiAgICB9O1xuICAgIE1hbmlmZXN0LnByb3RvdHlwZS5nZXRWaWV3aW5nSGludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJ2aWV3aW5nSGludFwiKTtcbiAgICB9O1xuICAgIHJldHVybiBNYW5pZmVzdDtcbn0oSUlJRlJlc291cmNlKSk7XG5leHBvcnQgeyBNYW5pZmVzdCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TWFuaWZlc3QuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Manifest.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/ManifestResource.js":
/*!*********************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/ManifestResource.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ManifestResource: () => (/* binding */ ManifestResource)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar ManifestResource = /** @class */ (function (_super) {\n    __extends(ManifestResource, _super);\n    function ManifestResource(jsonld, options) {\n        var _this = _super.call(this, jsonld) || this;\n        _this.options = options;\n        return _this;\n    }\n    ManifestResource.prototype.getIIIFResourceType = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(this.getProperty(\"type\"));\n    };\n    ManifestResource.prototype.getLabel = function () {\n        var label = this.getProperty(\"label\");\n        if (label) {\n            return _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue.parse(label, this.options.locale);\n        }\n        return new _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue([], this.options.locale);\n    };\n    ManifestResource.prototype.getDefaultLabel = function () {\n        return this.getLabel().getValue(this.options.locale);\n    };\n    ManifestResource.prototype.getMetadata = function () {\n        var _metadata = this.getProperty(\"metadata\");\n        var metadata = [];\n        if (!_metadata)\n            return metadata;\n        for (var i = 0; i < _metadata.length; i++) {\n            var item = _metadata[i];\n            var metadataItem = new _internal__WEBPACK_IMPORTED_MODULE_0__.LabelValuePair(this.options.locale);\n            metadataItem.parse(item);\n            metadata.push(metadataItem);\n        }\n        return metadata;\n    };\n    ManifestResource.prototype.getRendering = function (format) {\n        var renderings = this.getRenderings();\n        for (var i = 0; i < renderings.length; i++) {\n            var rendering = renderings[i];\n            if (rendering.getFormat() === format) {\n                return rendering;\n            }\n        }\n        return null;\n    };\n    ManifestResource.prototype.getRenderings = function () {\n        var rendering;\n        // if passing a manifesto-parsed object, use the __jsonld.rendering property,\n        // otherwise look for a rendering property\n        if (this.__jsonld) {\n            rendering = this.__jsonld.rendering;\n        }\n        else {\n            rendering = this.rendering;\n        }\n        var renderings = [];\n        if (!rendering)\n            return renderings;\n        // coerce to array\n        if (!Array.isArray(rendering)) {\n            rendering = [rendering];\n        }\n        for (var i = 0; i < rendering.length; i++) {\n            var r = rendering[i];\n            renderings.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.Rendering(r, this.options));\n        }\n        return renderings;\n    };\n    ManifestResource.prototype.getRequiredStatement = function () {\n        var requiredStatement = null;\n        var _requiredStatement = this.getProperty(\"requiredStatement\");\n        if (_requiredStatement) {\n            requiredStatement = new _internal__WEBPACK_IMPORTED_MODULE_0__.LabelValuePair(this.options.locale);\n            requiredStatement.parse(_requiredStatement);\n        }\n        return requiredStatement;\n    };\n    ManifestResource.prototype.getService = function (profile) {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getService(this, profile);\n    };\n    ManifestResource.prototype.getServices = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getServices(this);\n    };\n    ManifestResource.prototype.getThumbnail = function () {\n        var thumbnail = this.getProperty(\"thumbnail\");\n        if (Array.isArray(thumbnail)) {\n            thumbnail = thumbnail[0];\n        }\n        if (thumbnail) {\n            return new _internal__WEBPACK_IMPORTED_MODULE_0__.Thumbnail(thumbnail, this.options);\n        }\n        return null;\n    };\n    ManifestResource.prototype.isAnnotation = function () {\n        return this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.ANNOTATION;\n    };\n    ManifestResource.prototype.isCanvas = function () {\n        return this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.CANVAS;\n    };\n    ManifestResource.prototype.isCollection = function () {\n        return this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.COLLECTION;\n    };\n    ManifestResource.prototype.isManifest = function () {\n        return this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.MANIFEST;\n    };\n    ManifestResource.prototype.isRange = function () {\n        return this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.RANGE;\n    };\n    ManifestResource.prototype.isSequence = function () {\n        return this.getIIIFResourceType() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.IIIFResourceType.SEQUENCE;\n    };\n    return ManifestResource;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.JSONLDResource));\n\n//# sourceMappingURL=ManifestResource.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvTWFuaWZlc3RSZXNvdXJjZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ3VHO0FBQ3RDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG9EQUFhO0FBQ2hDO0FBQ0EsbUJBQW1CLG9EQUFhO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzQkFBc0I7QUFDOUM7QUFDQSxtQ0FBbUMscURBQWM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzQkFBc0I7QUFDOUM7QUFDQSxnQ0FBZ0MsZ0RBQVM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MscURBQWM7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsNENBQUs7QUFDcEI7QUFDQTtBQUNBLGVBQWUsNENBQUs7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0RBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsNEVBQWdCO0FBQzlEO0FBQ0E7QUFDQSw4Q0FBOEMsNEVBQWdCO0FBQzlEO0FBQ0E7QUFDQSw4Q0FBOEMsNEVBQWdCO0FBQzlEO0FBQ0E7QUFDQSw4Q0FBOEMsNEVBQWdCO0FBQzlEO0FBQ0E7QUFDQSw4Q0FBOEMsNEVBQWdCO0FBQzlEO0FBQ0E7QUFDQSw4Q0FBOEMsNEVBQWdCO0FBQzlEO0FBQ0E7QUFDQSxDQUFDLENBQUMscURBQWM7QUFDWTtBQUM1QiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0Ly4vbm9kZV9tb2R1bGVzL21hbmlmZXN0by5qcy9kaXN0LWVzbW9kdWxlL01hbmlmZXN0UmVzb3VyY2UuanM/NWE5MSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IEpTT05MRFJlc291cmNlLCBUaHVtYm5haWwsIFV0aWxzLCBSZW5kZXJpbmcsIExhYmVsVmFsdWVQYWlyLCBQcm9wZXJ0eVZhbHVlIH0gZnJvbSBcIi4vaW50ZXJuYWxcIjtcbmltcG9ydCB7IElJSUZSZXNvdXJjZVR5cGUgfSBmcm9tIFwiQGlpaWYvdm9jYWJ1bGFyeS9kaXN0LWNvbW1vbmpzXCI7XG52YXIgTWFuaWZlc3RSZXNvdXJjZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTWFuaWZlc3RSZXNvdXJjZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBNYW5pZmVzdFJlc291cmNlKGpzb25sZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBqc29ubGQpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE1hbmlmZXN0UmVzb3VyY2UucHJvdG90eXBlLmdldElJSUZSZXNvdXJjZVR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5ub3JtYWxpc2VUeXBlKHRoaXMuZ2V0UHJvcGVydHkoXCJ0eXBlXCIpKTtcbiAgICB9O1xuICAgIE1hbmlmZXN0UmVzb3VyY2UucHJvdG90eXBlLmdldExhYmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGFiZWwgPSB0aGlzLmdldFByb3BlcnR5KFwibGFiZWxcIik7XG4gICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb3BlcnR5VmFsdWUucGFyc2UobGFiZWwsIHRoaXMub3B0aW9ucy5sb2NhbGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUHJvcGVydHlWYWx1ZShbXSwgdGhpcy5vcHRpb25zLmxvY2FsZSk7XG4gICAgfTtcbiAgICBNYW5pZmVzdFJlc291cmNlLnByb3RvdHlwZS5nZXREZWZhdWx0TGFiZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldExhYmVsKCkuZ2V0VmFsdWUodGhpcy5vcHRpb25zLmxvY2FsZSk7XG4gICAgfTtcbiAgICBNYW5pZmVzdFJlc291cmNlLnByb3RvdHlwZS5nZXRNZXRhZGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9tZXRhZGF0YSA9IHRoaXMuZ2V0UHJvcGVydHkoXCJtZXRhZGF0YVwiKTtcbiAgICAgICAgdmFyIG1ldGFkYXRhID0gW107XG4gICAgICAgIGlmICghX21ldGFkYXRhKVxuICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9tZXRhZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBfbWV0YWRhdGFbaV07XG4gICAgICAgICAgICB2YXIgbWV0YWRhdGFJdGVtID0gbmV3IExhYmVsVmFsdWVQYWlyKHRoaXMub3B0aW9ucy5sb2NhbGUpO1xuICAgICAgICAgICAgbWV0YWRhdGFJdGVtLnBhcnNlKGl0ZW0pO1xuICAgICAgICAgICAgbWV0YWRhdGEucHVzaChtZXRhZGF0YUl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtZXRhZGF0YTtcbiAgICB9O1xuICAgIE1hbmlmZXN0UmVzb3VyY2UucHJvdG90eXBlLmdldFJlbmRlcmluZyA9IGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgICAgICAgdmFyIHJlbmRlcmluZ3MgPSB0aGlzLmdldFJlbmRlcmluZ3MoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW5kZXJpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcmVuZGVyaW5nID0gcmVuZGVyaW5nc1tpXTtcbiAgICAgICAgICAgIGlmIChyZW5kZXJpbmcuZ2V0Rm9ybWF0KCkgPT09IGZvcm1hdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBNYW5pZmVzdFJlc291cmNlLnByb3RvdHlwZS5nZXRSZW5kZXJpbmdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVuZGVyaW5nO1xuICAgICAgICAvLyBpZiBwYXNzaW5nIGEgbWFuaWZlc3RvLXBhcnNlZCBvYmplY3QsIHVzZSB0aGUgX19qc29ubGQucmVuZGVyaW5nIHByb3BlcnR5LFxuICAgICAgICAvLyBvdGhlcndpc2UgbG9vayBmb3IgYSByZW5kZXJpbmcgcHJvcGVydHlcbiAgICAgICAgaWYgKHRoaXMuX19qc29ubGQpIHtcbiAgICAgICAgICAgIHJlbmRlcmluZyA9IHRoaXMuX19qc29ubGQucmVuZGVyaW5nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVuZGVyaW5nID0gdGhpcy5yZW5kZXJpbmc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlbmRlcmluZ3MgPSBbXTtcbiAgICAgICAgaWYgKCFyZW5kZXJpbmcpXG4gICAgICAgICAgICByZXR1cm4gcmVuZGVyaW5ncztcbiAgICAgICAgLy8gY29lcmNlIHRvIGFycmF5XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZW5kZXJpbmcpKSB7XG4gICAgICAgICAgICByZW5kZXJpbmcgPSBbcmVuZGVyaW5nXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbmRlcmluZy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHIgPSByZW5kZXJpbmdbaV07XG4gICAgICAgICAgICByZW5kZXJpbmdzLnB1c2gobmV3IFJlbmRlcmluZyhyLCB0aGlzLm9wdGlvbnMpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVuZGVyaW5ncztcbiAgICB9O1xuICAgIE1hbmlmZXN0UmVzb3VyY2UucHJvdG90eXBlLmdldFJlcXVpcmVkU3RhdGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVxdWlyZWRTdGF0ZW1lbnQgPSBudWxsO1xuICAgICAgICB2YXIgX3JlcXVpcmVkU3RhdGVtZW50ID0gdGhpcy5nZXRQcm9wZXJ0eShcInJlcXVpcmVkU3RhdGVtZW50XCIpO1xuICAgICAgICBpZiAoX3JlcXVpcmVkU3RhdGVtZW50KSB7XG4gICAgICAgICAgICByZXF1aXJlZFN0YXRlbWVudCA9IG5ldyBMYWJlbFZhbHVlUGFpcih0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICAgICAgICAgIHJlcXVpcmVkU3RhdGVtZW50LnBhcnNlKF9yZXF1aXJlZFN0YXRlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcXVpcmVkU3RhdGVtZW50O1xuICAgIH07XG4gICAgTWFuaWZlc3RSZXNvdXJjZS5wcm90b3R5cGUuZ2V0U2VydmljZSA9IGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5nZXRTZXJ2aWNlKHRoaXMsIHByb2ZpbGUpO1xuICAgIH07XG4gICAgTWFuaWZlc3RSZXNvdXJjZS5wcm90b3R5cGUuZ2V0U2VydmljZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5nZXRTZXJ2aWNlcyh0aGlzKTtcbiAgICB9O1xuICAgIE1hbmlmZXN0UmVzb3VyY2UucHJvdG90eXBlLmdldFRodW1ibmFpbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRodW1ibmFpbCA9IHRoaXMuZ2V0UHJvcGVydHkoXCJ0aHVtYm5haWxcIik7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRodW1ibmFpbCkpIHtcbiAgICAgICAgICAgIHRodW1ibmFpbCA9IHRodW1ibmFpbFswXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGh1bWJuYWlsKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRodW1ibmFpbCh0aHVtYm5haWwsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBNYW5pZmVzdFJlc291cmNlLnByb3RvdHlwZS5pc0Fubm90YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldElJSUZSZXNvdXJjZVR5cGUoKSA9PT0gSUlJRlJlc291cmNlVHlwZS5BTk5PVEFUSU9OO1xuICAgIH07XG4gICAgTWFuaWZlc3RSZXNvdXJjZS5wcm90b3R5cGUuaXNDYW52YXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldElJSUZSZXNvdXJjZVR5cGUoKSA9PT0gSUlJRlJlc291cmNlVHlwZS5DQU5WQVM7XG4gICAgfTtcbiAgICBNYW5pZmVzdFJlc291cmNlLnByb3RvdHlwZS5pc0NvbGxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldElJSUZSZXNvdXJjZVR5cGUoKSA9PT0gSUlJRlJlc291cmNlVHlwZS5DT0xMRUNUSU9OO1xuICAgIH07XG4gICAgTWFuaWZlc3RSZXNvdXJjZS5wcm90b3R5cGUuaXNNYW5pZmVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SUlJRlJlc291cmNlVHlwZSgpID09PSBJSUlGUmVzb3VyY2VUeXBlLk1BTklGRVNUO1xuICAgIH07XG4gICAgTWFuaWZlc3RSZXNvdXJjZS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SUlJRlJlc291cmNlVHlwZSgpID09PSBJSUlGUmVzb3VyY2VUeXBlLlJBTkdFO1xuICAgIH07XG4gICAgTWFuaWZlc3RSZXNvdXJjZS5wcm90b3R5cGUuaXNTZXF1ZW5jZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SUlJRlJlc291cmNlVHlwZSgpID09PSBJSUlGUmVzb3VyY2VUeXBlLlNFUVVFTkNFO1xuICAgIH07XG4gICAgcmV0dXJuIE1hbmlmZXN0UmVzb3VyY2U7XG59KEpTT05MRFJlc291cmNlKSk7XG5leHBvcnQgeyBNYW5pZmVzdFJlc291cmNlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1NYW5pZmVzdFJlc291cmNlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/ManifestResource.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/ManifestType.js":
/*!*****************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/ManifestType.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ManifestType: () => (/* binding */ ManifestType)\n/* harmony export */ });\nvar ManifestType;\n(function (ManifestType) {\n    ManifestType[\"EMPTY\"] = \"\";\n    ManifestType[\"MANUSCRIPT\"] = \"manuscript\";\n    ManifestType[\"MONOGRAPH\"] = \"monograph\";\n})(ManifestType || (ManifestType = {}));\n//# sourceMappingURL=ManifestType.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvTWFuaWZlc3RUeXBlLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxvQ0FBb0M7QUFDckMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9NYW5pZmVzdFR5cGUuanM/YTI5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIE1hbmlmZXN0VHlwZTtcbihmdW5jdGlvbiAoTWFuaWZlc3RUeXBlKSB7XG4gICAgTWFuaWZlc3RUeXBlW1wiRU1QVFlcIl0gPSBcIlwiO1xuICAgIE1hbmlmZXN0VHlwZVtcIk1BTlVTQ1JJUFRcIl0gPSBcIm1hbnVzY3JpcHRcIjtcbiAgICBNYW5pZmVzdFR5cGVbXCJNT05PR1JBUEhcIl0gPSBcIm1vbm9ncmFwaFwiO1xufSkoTWFuaWZlc3RUeXBlIHx8IChNYW5pZmVzdFR5cGUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TWFuaWZlc3RUeXBlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/ManifestType.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/PropertyValue.js":
/*!******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/PropertyValue.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LocalizedValue: () => (/* binding */ LocalizedValue),\n/* harmony export */   PropertyValue: () => (/* binding */ PropertyValue)\n/* harmony export */ });\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Utils */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Utils.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (undefined && undefined.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\n\n/** Utility class to hold one or more values with their associated (optional) locale */\nvar LocalizedValue = /** @class */ (function () {\n    function LocalizedValue(value, locale, defaultLocale) {\n        if (defaultLocale === void 0) { defaultLocale = \"none\"; }\n        if (Array.isArray(value) && value.length === 1) {\n            this._value = value[0];\n        }\n        else {\n            this._value = value;\n        }\n        if (locale === \"none\" || locale === \"@none\") {\n            locale = undefined;\n        }\n        this._locale = locale;\n        this._defaultLocale = defaultLocale;\n    }\n    /** Parse a localized value from a IIIF v2 property value\n     *\n     * @param {string | string[] | object | object[]} rawVal value from IIIF resource\n     * @param {string | undefined} defaultLocale deprecated: defaultLocale the default locale to use for this value\n     */\n    LocalizedValue.parseV2Value = function (rawVal, defaultLocale) {\n        if (typeof rawVal === \"string\") {\n            return new LocalizedValue(rawVal, undefined, defaultLocale);\n        }\n        else if (rawVal[\"@value\"]) {\n            return new LocalizedValue(rawVal[\"@value\"], rawVal[\"@language\"], defaultLocale);\n        }\n        return null;\n    };\n    Object.defineProperty(LocalizedValue.prototype, \"value\", {\n        /*** @deprecated Use PropertyValue#getValue instead */\n        get: function () {\n            if (Array.isArray(this._value)) {\n                return this._value.join(\"<br/>\");\n            }\n            return this._value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LocalizedValue.prototype, \"locale\", {\n        /*** @deprecated Don't use, only used for backwards compatibility reasons */\n        get: function () {\n            if (this._locale === undefined) {\n                return this._defaultLocale;\n            }\n            return this._locale;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LocalizedValue.prototype.addValue = function (value) {\n        if (!Array.isArray(this._value)) {\n            this._value = [this._value];\n        }\n        if (Array.isArray(value)) {\n            this._value = this._value.concat(value);\n        }\n        else {\n            this._value.push(value);\n        }\n    };\n    return LocalizedValue;\n}());\n\n/***\n * Holds a collection of values and their (optional) languages and allows\n * language-based value retrieval as per the algorithm described in\n * https://iiif.io/api/presentation/2.1/#language-of-property-values\n */\nvar PropertyValue = /** @class */ (function (_super) {\n    __extends(PropertyValue, _super);\n    function PropertyValue(values, defaultLocale) {\n        if (values === void 0) { values = []; }\n        var _this = _super.apply(this, values) || this;\n        // Needed for ES5 compatibility, see https://stackoverflow.com/a/40967939\n        _this.__proto__ = PropertyValue.prototype;\n        _this._defaultLocale = defaultLocale;\n        return _this;\n    }\n    PropertyValue.parse = function (rawVal, defaultLocale) {\n        if (!rawVal) {\n            return new PropertyValue([], defaultLocale);\n        }\n        if (Array.isArray(rawVal)) {\n            // Collection of IIIF v2 property values\n            var parsed = rawVal\n                .map(function (v) { return LocalizedValue.parseV2Value(v, defaultLocale); })\n                .filter(function (v) { return v !== null; });\n            var byLocale = parsed.reduce(function (acc, lv) {\n                var loc = lv._locale;\n                if (!loc) {\n                    // Cannot use undefined as an object key\n                    loc = \"none\";\n                }\n                if (acc[loc]) {\n                    acc[loc].addValue(lv._value);\n                }\n                else {\n                    acc[loc] = lv;\n                }\n                return acc;\n            }, {});\n            return new PropertyValue(Object.values(byLocale), defaultLocale);\n        }\n        else if (typeof rawVal === \"string\") {\n            return new PropertyValue([new LocalizedValue(rawVal, undefined, defaultLocale)], defaultLocale);\n        }\n        else if (rawVal[\"@language\"]) {\n            // Single IIIF v2 property value\n            var parsed = LocalizedValue.parseV2Value(rawVal);\n            return new PropertyValue(parsed !== null ? [parsed] : [], defaultLocale);\n        }\n        else if (rawVal[\"@value\"]) {\n            // Single IIIF v2 property value without language\n            var parsed = LocalizedValue.parseV2Value(rawVal);\n            return new PropertyValue(parsed !== null ? [parsed] : [], defaultLocale);\n        }\n        else {\n            // IIIF v3 property value\n            return new PropertyValue(Object.keys(rawVal).map(function (locale) {\n                var val = rawVal[locale];\n                if (!Array.isArray(val)) {\n                    throw new Error(\"A IIIF v3 localized property value must have an array as the value for a given language.\");\n                }\n                return new LocalizedValue(val, locale, defaultLocale);\n            }), defaultLocale);\n        }\n    };\n    /*** Try to find the available locale that best fit's the user's preferences. */\n    PropertyValue.prototype.getSuitableLocale = function (locales) {\n        // If any of the values have a language associated with them, the client\n        // must display all of the values associated with the language that best\n        // matches the language preference.\n        // FIXME: This is nasty, we have to spread ourselves in order to be able\n        //        to call `.map`. This will no longer be needed once we target >ES5.\n        var allLocales = __spreadArrays(this).map(function (lv) { return lv._locale; })\n            .filter(function (l) { return l !== undefined; });\n        var _loop_1 = function (userLocale) {\n            var matchingLocale = allLocales.find(function (l) { return l === userLocale; });\n            if (matchingLocale) {\n                return { value: matchingLocale };\n            }\n        };\n        // First, look for a precise match\n        for (var _i = 0, locales_1 = locales; _i < locales_1.length; _i++) {\n            var userLocale = locales_1[_i];\n            var state_1 = _loop_1(userLocale);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n        var _loop_2 = function (userLocale) {\n            var matchingLocale = allLocales.find(function (l) { return _Utils__WEBPACK_IMPORTED_MODULE_0__.Utils.getInexactLocale(l) === _Utils__WEBPACK_IMPORTED_MODULE_0__.Utils.getInexactLocale(userLocale); });\n            if (matchingLocale) {\n                return { value: matchingLocale };\n            }\n        };\n        // Look for an inexact match\n        for (var _a = 0, locales_2 = locales; _a < locales_2.length; _a++) {\n            var userLocale = locales_2[_a];\n            var state_2 = _loop_2(userLocale);\n            if (typeof state_2 === \"object\")\n                return state_2.value;\n        }\n        return undefined;\n    };\n    /**\n     * Set the value(s) for a given locale.\n     *\n     * If there's an existing locale that matches the given locale, it will be updated.\n     *\n     * @param locale Locale to set the value for\n     * @param value value to set\n     */\n    PropertyValue.prototype.setValue = function (value, locale) {\n        var existing = undefined;\n        if (!locale) {\n            existing = this.find(function (lv) { return lv._locale === undefined; });\n        }\n        else {\n            var bestLocale_1 = this.getSuitableLocale([locale]);\n            if (bestLocale_1) {\n                existing = this.find(function (lv) { return lv._locale === bestLocale_1; });\n            }\n        }\n        if (existing) {\n            // Mutate existing localized value\n            existing._value = value;\n        }\n        else {\n            // Create a new localized value\n            this.push(new LocalizedValue(value, locale, this._defaultLocale));\n        }\n    };\n    /**\n     * Get a value in the most suitable locale.\n     *\n     * @param {string | string[] | undefined} locales Desired locale, can be a list of\n     * locales sorted by descending priority.\n     * @param {string | undefined} joinWith String to join multiple available values by,\n     * if undefined only the first available value will be returned\n     * @returns the first value in the most suitable locale or null if none could be found\n     */\n    PropertyValue.prototype.getValue = function (locales, joinWith) {\n        var vals = this.getValues(locales);\n        if (vals.length === 0) {\n            return null;\n        }\n        if (joinWith) {\n            return vals.join(joinWith);\n        }\n        return vals[0];\n    };\n    /**\n     * Get all values available in the most suitable locale.\n     *\n     * @param {string | string[]} userLocales Desired locale, can be a list of\n     * locales sorted by descending priority.\n     * @returns the values for the most suitable locale, empty if none could be found\n     */\n    PropertyValue.prototype.getValues = function (userLocales) {\n        if (!this.length) {\n            return [];\n        }\n        var locales;\n        if (!userLocales) {\n            locales = [];\n        }\n        else if (!Array.isArray(userLocales)) {\n            locales = [userLocales];\n        }\n        else {\n            locales = userLocales;\n        }\n        // If none of the values have a language associated with them, the client\n        // must display all of the values.\n        if (this.length === 1 && this[0]._locale === undefined) {\n            var val = this[0]._value;\n            return Array.isArray(val) ? val : [val];\n        }\n        // Try to determine the available locale that best fits the user's preferences\n        var matchingLocale = this.getSuitableLocale(locales);\n        if (matchingLocale) {\n            var val = this.find(function (lv) { return lv._locale === matchingLocale; })._value;\n            return Array.isArray(val) ? val : [val];\n        }\n        // If all of the values have a language associated with them, and none match\n        // the language preference, the client must select a language and display\n        // all of the values associated with that language.\n        var allHaveLang = !this.find(function (lv) { return lv._locale === undefined; });\n        if (allHaveLang) {\n            var val = this[0]._value;\n            return Array.isArray(val) ? val : [val];\n        }\n        // If some of the values have a language associated with them, but none\n        // match the language preference, the client must display all of the values\n        // that do not have a language associated with them.\n        var lv = this.find(function (lv) { return lv._locale === undefined; });\n        if (lv) {\n            return Array.isArray(lv._value) ? lv._value : [lv._value];\n        }\n        return [];\n    };\n    return PropertyValue;\n}(Array));\n\n//# sourceMappingURL=PropertyValue.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvUHJvcGVydHlWYWx1ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsc0JBQXNCLFNBQUksSUFBSSxTQUFJO0FBQ2xDLGtEQUFrRCxRQUFRO0FBQzFELHlDQUF5QyxRQUFRO0FBQ2pELHlEQUF5RCxRQUFRO0FBQ2pFO0FBQ0E7QUFDQTtBQUNnQztBQUNoQztBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsdUNBQXVDO0FBQ3RELGVBQWUsb0JBQW9CO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDeUI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyx1REFBdUQ7QUFDM0YsdUNBQXVDLG9CQUFvQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsSUFBSTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxvQkFBb0I7QUFDdEYsbUNBQW1DLHlCQUF5QjtBQUM1RDtBQUNBLGdFQUFnRSwwQkFBMEI7QUFDMUY7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHVCQUF1QjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsT0FBTyx5Q0FBSyx5QkFBeUIseUNBQUssZ0NBQWdDO0FBQzFJO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLDhDQUE4Qyx1QkFBdUI7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGtDQUFrQztBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxxQ0FBcUM7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsK0JBQStCO0FBQzlDO0FBQ0EsZUFBZSxvQkFBb0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG1CQUFtQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELHVDQUF1QztBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELGtDQUFrQztBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxrQ0FBa0M7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUN3QjtBQUN6QiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0Ly4vbm9kZV9tb2R1bGVzL21hbmlmZXN0by5qcy9kaXN0LWVzbW9kdWxlL1Byb3BlcnR5VmFsdWUuanM/Yzg3MCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX3NwcmVhZEFycmF5cyA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheXMpIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxuICAgICAgICAgICAgcltrXSA9IGFbal07XG4gICAgcmV0dXJuIHI7XG59O1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tIFwiLi9VdGlsc1wiO1xuLyoqIFV0aWxpdHkgY2xhc3MgdG8gaG9sZCBvbmUgb3IgbW9yZSB2YWx1ZXMgd2l0aCB0aGVpciBhc3NvY2lhdGVkIChvcHRpb25hbCkgbG9jYWxlICovXG52YXIgTG9jYWxpemVkVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTG9jYWxpemVkVmFsdWUodmFsdWUsIGxvY2FsZSwgZGVmYXVsdExvY2FsZSkge1xuICAgICAgICBpZiAoZGVmYXVsdExvY2FsZSA9PT0gdm9pZCAwKSB7IGRlZmF1bHRMb2NhbGUgPSBcIm5vbmVcIjsgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbHVlWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobG9jYWxlID09PSBcIm5vbmVcIiB8fCBsb2NhbGUgPT09IFwiQG5vbmVcIikge1xuICAgICAgICAgICAgbG9jYWxlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xvY2FsZSA9IGxvY2FsZTtcbiAgICAgICAgdGhpcy5fZGVmYXVsdExvY2FsZSA9IGRlZmF1bHRMb2NhbGU7XG4gICAgfVxuICAgIC8qKiBQYXJzZSBhIGxvY2FsaXplZCB2YWx1ZSBmcm9tIGEgSUlJRiB2MiBwcm9wZXJ0eSB2YWx1ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCBzdHJpbmdbXSB8IG9iamVjdCB8IG9iamVjdFtdfSByYXdWYWwgdmFsdWUgZnJvbSBJSUlGIHJlc291cmNlXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCB1bmRlZmluZWR9IGRlZmF1bHRMb2NhbGUgZGVwcmVjYXRlZDogZGVmYXVsdExvY2FsZSB0aGUgZGVmYXVsdCBsb2NhbGUgdG8gdXNlIGZvciB0aGlzIHZhbHVlXG4gICAgICovXG4gICAgTG9jYWxpemVkVmFsdWUucGFyc2VWMlZhbHVlID0gZnVuY3Rpb24gKHJhd1ZhbCwgZGVmYXVsdExvY2FsZSkge1xuICAgICAgICBpZiAodHlwZW9mIHJhd1ZhbCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBMb2NhbGl6ZWRWYWx1ZShyYXdWYWwsIHVuZGVmaW5lZCwgZGVmYXVsdExvY2FsZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmF3VmFsW1wiQHZhbHVlXCJdKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IExvY2FsaXplZFZhbHVlKHJhd1ZhbFtcIkB2YWx1ZVwiXSwgcmF3VmFsW1wiQGxhbmd1YWdlXCJdLCBkZWZhdWx0TG9jYWxlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMb2NhbGl6ZWRWYWx1ZS5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgICAvKioqIEBkZXByZWNhdGVkIFVzZSBQcm9wZXJ0eVZhbHVlI2dldFZhbHVlIGluc3RlYWQgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLl92YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWUuam9pbihcIjxici8+XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTG9jYWxpemVkVmFsdWUucHJvdG90eXBlLCBcImxvY2FsZVwiLCB7XG4gICAgICAgIC8qKiogQGRlcHJlY2F0ZWQgRG9uJ3QgdXNlLCBvbmx5IHVzZWQgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHJlYXNvbnMgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbG9jYWxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdExvY2FsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2NhbGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIExvY2FsaXplZFZhbHVlLnByb3RvdHlwZS5hZGRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5fdmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IFt0aGlzLl92YWx1ZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHRoaXMuX3ZhbHVlLmNvbmNhdCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZS5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIExvY2FsaXplZFZhbHVlO1xufSgpKTtcbmV4cG9ydCB7IExvY2FsaXplZFZhbHVlIH07XG4vKioqXG4gKiBIb2xkcyBhIGNvbGxlY3Rpb24gb2YgdmFsdWVzIGFuZCB0aGVpciAob3B0aW9uYWwpIGxhbmd1YWdlcyBhbmQgYWxsb3dzXG4gKiBsYW5ndWFnZS1iYXNlZCB2YWx1ZSByZXRyaWV2YWwgYXMgcGVyIHRoZSBhbGdvcml0aG0gZGVzY3JpYmVkIGluXG4gKiBodHRwczovL2lpaWYuaW8vYXBpL3ByZXNlbnRhdGlvbi8yLjEvI2xhbmd1YWdlLW9mLXByb3BlcnR5LXZhbHVlc1xuICovXG52YXIgUHJvcGVydHlWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHJvcGVydHlWYWx1ZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQcm9wZXJ0eVZhbHVlKHZhbHVlcywgZGVmYXVsdExvY2FsZSkge1xuICAgICAgICBpZiAodmFsdWVzID09PSB2b2lkIDApIHsgdmFsdWVzID0gW107IH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmFwcGx5KHRoaXMsIHZhbHVlcykgfHwgdGhpcztcbiAgICAgICAgLy8gTmVlZGVkIGZvciBFUzUgY29tcGF0aWJpbGl0eSwgc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80MDk2NzkzOVxuICAgICAgICBfdGhpcy5fX3Byb3RvX18gPSBQcm9wZXJ0eVZhbHVlLnByb3RvdHlwZTtcbiAgICAgICAgX3RoaXMuX2RlZmF1bHRMb2NhbGUgPSBkZWZhdWx0TG9jYWxlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFByb3BlcnR5VmFsdWUucGFyc2UgPSBmdW5jdGlvbiAocmF3VmFsLCBkZWZhdWx0TG9jYWxlKSB7XG4gICAgICAgIGlmICghcmF3VmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUoW10sIGRlZmF1bHRMb2NhbGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJhd1ZhbCkpIHtcbiAgICAgICAgICAgIC8vIENvbGxlY3Rpb24gb2YgSUlJRiB2MiBwcm9wZXJ0eSB2YWx1ZXNcbiAgICAgICAgICAgIHZhciBwYXJzZWQgPSByYXdWYWxcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBMb2NhbGl6ZWRWYWx1ZS5wYXJzZVYyVmFsdWUodiwgZGVmYXVsdExvY2FsZSk7IH0pXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodikgeyByZXR1cm4gdiAhPT0gbnVsbDsgfSk7XG4gICAgICAgICAgICB2YXIgYnlMb2NhbGUgPSBwYXJzZWQucmVkdWNlKGZ1bmN0aW9uIChhY2MsIGx2KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvYyA9IGx2Ll9sb2NhbGU7XG4gICAgICAgICAgICAgICAgaWYgKCFsb2MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2Fubm90IHVzZSB1bmRlZmluZWQgYXMgYW4gb2JqZWN0IGtleVxuICAgICAgICAgICAgICAgICAgICBsb2MgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFjY1tsb2NdKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY1tsb2NdLmFkZFZhbHVlKGx2Ll92YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY2NbbG9jXSA9IGx2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgICAgfSwge30pO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9wZXJ0eVZhbHVlKE9iamVjdC52YWx1ZXMoYnlMb2NhbGUpLCBkZWZhdWx0TG9jYWxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgcmF3VmFsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUoW25ldyBMb2NhbGl6ZWRWYWx1ZShyYXdWYWwsIHVuZGVmaW5lZCwgZGVmYXVsdExvY2FsZSldLCBkZWZhdWx0TG9jYWxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyYXdWYWxbXCJAbGFuZ3VhZ2VcIl0pIHtcbiAgICAgICAgICAgIC8vIFNpbmdsZSBJSUlGIHYyIHByb3BlcnR5IHZhbHVlXG4gICAgICAgICAgICB2YXIgcGFyc2VkID0gTG9jYWxpemVkVmFsdWUucGFyc2VWMlZhbHVlKHJhd1ZhbCk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUocGFyc2VkICE9PSBudWxsID8gW3BhcnNlZF0gOiBbXSwgZGVmYXVsdExvY2FsZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmF3VmFsW1wiQHZhbHVlXCJdKSB7XG4gICAgICAgICAgICAvLyBTaW5nbGUgSUlJRiB2MiBwcm9wZXJ0eSB2YWx1ZSB3aXRob3V0IGxhbmd1YWdlXG4gICAgICAgICAgICB2YXIgcGFyc2VkID0gTG9jYWxpemVkVmFsdWUucGFyc2VWMlZhbHVlKHJhd1ZhbCk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUocGFyc2VkICE9PSBudWxsID8gW3BhcnNlZF0gOiBbXSwgZGVmYXVsdExvY2FsZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBJSUlGIHYzIHByb3BlcnR5IHZhbHVlXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb3BlcnR5VmFsdWUoT2JqZWN0LmtleXMocmF3VmFsKS5tYXAoZnVuY3Rpb24gKGxvY2FsZSkge1xuICAgICAgICAgICAgICAgIHZhciB2YWwgPSByYXdWYWxbbG9jYWxlXTtcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBIElJSUYgdjMgbG9jYWxpemVkIHByb3BlcnR5IHZhbHVlIG11c3QgaGF2ZSBhbiBhcnJheSBhcyB0aGUgdmFsdWUgZm9yIGEgZ2l2ZW4gbGFuZ3VhZ2UuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExvY2FsaXplZFZhbHVlKHZhbCwgbG9jYWxlLCBkZWZhdWx0TG9jYWxlKTtcbiAgICAgICAgICAgIH0pLCBkZWZhdWx0TG9jYWxlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqKiBUcnkgdG8gZmluZCB0aGUgYXZhaWxhYmxlIGxvY2FsZSB0aGF0IGJlc3QgZml0J3MgdGhlIHVzZXIncyBwcmVmZXJlbmNlcy4gKi9cbiAgICBQcm9wZXJ0eVZhbHVlLnByb3RvdHlwZS5nZXRTdWl0YWJsZUxvY2FsZSA9IGZ1bmN0aW9uIChsb2NhbGVzKSB7XG4gICAgICAgIC8vIElmIGFueSBvZiB0aGUgdmFsdWVzIGhhdmUgYSBsYW5ndWFnZSBhc3NvY2lhdGVkIHdpdGggdGhlbSwgdGhlIGNsaWVudFxuICAgICAgICAvLyBtdXN0IGRpc3BsYXkgYWxsIG9mIHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBsYW5ndWFnZSB0aGF0IGJlc3RcbiAgICAgICAgLy8gbWF0Y2hlcyB0aGUgbGFuZ3VhZ2UgcHJlZmVyZW5jZS5cbiAgICAgICAgLy8gRklYTUU6IFRoaXMgaXMgbmFzdHksIHdlIGhhdmUgdG8gc3ByZWFkIG91cnNlbHZlcyBpbiBvcmRlciB0byBiZSBhYmxlXG4gICAgICAgIC8vICAgICAgICB0byBjYWxsIGAubWFwYC4gVGhpcyB3aWxsIG5vIGxvbmdlciBiZSBuZWVkZWQgb25jZSB3ZSB0YXJnZXQgPkVTNS5cbiAgICAgICAgdmFyIGFsbExvY2FsZXMgPSBfX3NwcmVhZEFycmF5cyh0aGlzKS5tYXAoZnVuY3Rpb24gKGx2KSB7IHJldHVybiBsdi5fbG9jYWxlOyB9KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAobCkgeyByZXR1cm4gbCAhPT0gdW5kZWZpbmVkOyB9KTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAodXNlckxvY2FsZSkge1xuICAgICAgICAgICAgdmFyIG1hdGNoaW5nTG9jYWxlID0gYWxsTG9jYWxlcy5maW5kKGZ1bmN0aW9uIChsKSB7IHJldHVybiBsID09PSB1c2VyTG9jYWxlOyB9KTtcbiAgICAgICAgICAgIGlmIChtYXRjaGluZ0xvY2FsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBtYXRjaGluZ0xvY2FsZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBGaXJzdCwgbG9vayBmb3IgYSBwcmVjaXNlIG1hdGNoXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgbG9jYWxlc18xID0gbG9jYWxlczsgX2kgPCBsb2NhbGVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgdXNlckxvY2FsZSA9IGxvY2FsZXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEodXNlckxvY2FsZSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9sb29wXzIgPSBmdW5jdGlvbiAodXNlckxvY2FsZSkge1xuICAgICAgICAgICAgdmFyIG1hdGNoaW5nTG9jYWxlID0gYWxsTG9jYWxlcy5maW5kKGZ1bmN0aW9uIChsKSB7IHJldHVybiBVdGlscy5nZXRJbmV4YWN0TG9jYWxlKGwpID09PSBVdGlscy5nZXRJbmV4YWN0TG9jYWxlKHVzZXJMb2NhbGUpOyB9KTtcbiAgICAgICAgICAgIGlmIChtYXRjaGluZ0xvY2FsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBtYXRjaGluZ0xvY2FsZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBMb29rIGZvciBhbiBpbmV4YWN0IG1hdGNoXG4gICAgICAgIGZvciAodmFyIF9hID0gMCwgbG9jYWxlc18yID0gbG9jYWxlczsgX2EgPCBsb2NhbGVzXzIubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICB2YXIgdXNlckxvY2FsZSA9IGxvY2FsZXNfMltfYV07XG4gICAgICAgICAgICB2YXIgc3RhdGVfMiA9IF9sb29wXzIodXNlckxvY2FsZSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzIgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzIudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNldCB0aGUgdmFsdWUocykgZm9yIGEgZ2l2ZW4gbG9jYWxlLlxuICAgICAqXG4gICAgICogSWYgdGhlcmUncyBhbiBleGlzdGluZyBsb2NhbGUgdGhhdCBtYXRjaGVzIHRoZSBnaXZlbiBsb2NhbGUsIGl0IHdpbGwgYmUgdXBkYXRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsb2NhbGUgTG9jYWxlIHRvIHNldCB0aGUgdmFsdWUgZm9yXG4gICAgICogQHBhcmFtIHZhbHVlIHZhbHVlIHRvIHNldFxuICAgICAqL1xuICAgIFByb3BlcnR5VmFsdWUucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24gKHZhbHVlLCBsb2NhbGUpIHtcbiAgICAgICAgdmFyIGV4aXN0aW5nID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIWxvY2FsZSkge1xuICAgICAgICAgICAgZXhpc3RpbmcgPSB0aGlzLmZpbmQoZnVuY3Rpb24gKGx2KSB7IHJldHVybiBsdi5fbG9jYWxlID09PSB1bmRlZmluZWQ7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGJlc3RMb2NhbGVfMSA9IHRoaXMuZ2V0U3VpdGFibGVMb2NhbGUoW2xvY2FsZV0pO1xuICAgICAgICAgICAgaWYgKGJlc3RMb2NhbGVfMSkge1xuICAgICAgICAgICAgICAgIGV4aXN0aW5nID0gdGhpcy5maW5kKGZ1bmN0aW9uIChsdikgeyByZXR1cm4gbHYuX2xvY2FsZSA9PT0gYmVzdExvY2FsZV8xOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgIC8vIE11dGF0ZSBleGlzdGluZyBsb2NhbGl6ZWQgdmFsdWVcbiAgICAgICAgICAgIGV4aXN0aW5nLl92YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGxvY2FsaXplZCB2YWx1ZVxuICAgICAgICAgICAgdGhpcy5wdXNoKG5ldyBMb2NhbGl6ZWRWYWx1ZSh2YWx1ZSwgbG9jYWxlLCB0aGlzLl9kZWZhdWx0TG9jYWxlKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCBhIHZhbHVlIGluIHRoZSBtb3N0IHN1aXRhYmxlIGxvY2FsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgc3RyaW5nW10gfCB1bmRlZmluZWR9IGxvY2FsZXMgRGVzaXJlZCBsb2NhbGUsIGNhbiBiZSBhIGxpc3Qgb2ZcbiAgICAgKiBsb2NhbGVzIHNvcnRlZCBieSBkZXNjZW5kaW5nIHByaW9yaXR5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgdW5kZWZpbmVkfSBqb2luV2l0aCBTdHJpbmcgdG8gam9pbiBtdWx0aXBsZSBhdmFpbGFibGUgdmFsdWVzIGJ5LFxuICAgICAqIGlmIHVuZGVmaW5lZCBvbmx5IHRoZSBmaXJzdCBhdmFpbGFibGUgdmFsdWUgd2lsbCBiZSByZXR1cm5lZFxuICAgICAqIEByZXR1cm5zIHRoZSBmaXJzdCB2YWx1ZSBpbiB0aGUgbW9zdCBzdWl0YWJsZSBsb2NhbGUgb3IgbnVsbCBpZiBub25lIGNvdWxkIGJlIGZvdW5kXG4gICAgICovXG4gICAgUHJvcGVydHlWYWx1ZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAobG9jYWxlcywgam9pbldpdGgpIHtcbiAgICAgICAgdmFyIHZhbHMgPSB0aGlzLmdldFZhbHVlcyhsb2NhbGVzKTtcbiAgICAgICAgaWYgKHZhbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoam9pbldpdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWxzLmpvaW4oam9pbldpdGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxzWzBdO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGFsbCB2YWx1ZXMgYXZhaWxhYmxlIGluIHRoZSBtb3N0IHN1aXRhYmxlIGxvY2FsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgc3RyaW5nW119IHVzZXJMb2NhbGVzIERlc2lyZWQgbG9jYWxlLCBjYW4gYmUgYSBsaXN0IG9mXG4gICAgICogbG9jYWxlcyBzb3J0ZWQgYnkgZGVzY2VuZGluZyBwcmlvcml0eS5cbiAgICAgKiBAcmV0dXJucyB0aGUgdmFsdWVzIGZvciB0aGUgbW9zdCBzdWl0YWJsZSBsb2NhbGUsIGVtcHR5IGlmIG5vbmUgY291bGQgYmUgZm91bmRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eVZhbHVlLnByb3RvdHlwZS5nZXRWYWx1ZXMgPSBmdW5jdGlvbiAodXNlckxvY2FsZXMpIHtcbiAgICAgICAgaWYgKCF0aGlzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsb2NhbGVzO1xuICAgICAgICBpZiAoIXVzZXJMb2NhbGVzKSB7XG4gICAgICAgICAgICBsb2NhbGVzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkodXNlckxvY2FsZXMpKSB7XG4gICAgICAgICAgICBsb2NhbGVzID0gW3VzZXJMb2NhbGVzXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxvY2FsZXMgPSB1c2VyTG9jYWxlcztcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBub25lIG9mIHRoZSB2YWx1ZXMgaGF2ZSBhIGxhbmd1YWdlIGFzc29jaWF0ZWQgd2l0aCB0aGVtLCB0aGUgY2xpZW50XG4gICAgICAgIC8vIG11c3QgZGlzcGxheSBhbGwgb2YgdGhlIHZhbHVlcy5cbiAgICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAxICYmIHRoaXNbMF0uX2xvY2FsZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gdGhpc1swXS5fdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWwpID8gdmFsIDogW3ZhbF07XG4gICAgICAgIH1cbiAgICAgICAgLy8gVHJ5IHRvIGRldGVybWluZSB0aGUgYXZhaWxhYmxlIGxvY2FsZSB0aGF0IGJlc3QgZml0cyB0aGUgdXNlcidzIHByZWZlcmVuY2VzXG4gICAgICAgIHZhciBtYXRjaGluZ0xvY2FsZSA9IHRoaXMuZ2V0U3VpdGFibGVMb2NhbGUobG9jYWxlcyk7XG4gICAgICAgIGlmIChtYXRjaGluZ0xvY2FsZSkge1xuICAgICAgICAgICAgdmFyIHZhbCA9IHRoaXMuZmluZChmdW5jdGlvbiAobHYpIHsgcmV0dXJuIGx2Ll9sb2NhbGUgPT09IG1hdGNoaW5nTG9jYWxlOyB9KS5fdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWwpID8gdmFsIDogW3ZhbF07XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgYWxsIG9mIHRoZSB2YWx1ZXMgaGF2ZSBhIGxhbmd1YWdlIGFzc29jaWF0ZWQgd2l0aCB0aGVtLCBhbmQgbm9uZSBtYXRjaFxuICAgICAgICAvLyB0aGUgbGFuZ3VhZ2UgcHJlZmVyZW5jZSwgdGhlIGNsaWVudCBtdXN0IHNlbGVjdCBhIGxhbmd1YWdlIGFuZCBkaXNwbGF5XG4gICAgICAgIC8vIGFsbCBvZiB0aGUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGF0IGxhbmd1YWdlLlxuICAgICAgICB2YXIgYWxsSGF2ZUxhbmcgPSAhdGhpcy5maW5kKGZ1bmN0aW9uIChsdikgeyByZXR1cm4gbHYuX2xvY2FsZSA9PT0gdW5kZWZpbmVkOyB9KTtcbiAgICAgICAgaWYgKGFsbEhhdmVMYW5nKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gdGhpc1swXS5fdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWwpID8gdmFsIDogW3ZhbF07XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgc29tZSBvZiB0aGUgdmFsdWVzIGhhdmUgYSBsYW5ndWFnZSBhc3NvY2lhdGVkIHdpdGggdGhlbSwgYnV0IG5vbmVcbiAgICAgICAgLy8gbWF0Y2ggdGhlIGxhbmd1YWdlIHByZWZlcmVuY2UsIHRoZSBjbGllbnQgbXVzdCBkaXNwbGF5IGFsbCBvZiB0aGUgdmFsdWVzXG4gICAgICAgIC8vIHRoYXQgZG8gbm90IGhhdmUgYSBsYW5ndWFnZSBhc3NvY2lhdGVkIHdpdGggdGhlbS5cbiAgICAgICAgdmFyIGx2ID0gdGhpcy5maW5kKGZ1bmN0aW9uIChsdikgeyByZXR1cm4gbHYuX2xvY2FsZSA9PT0gdW5kZWZpbmVkOyB9KTtcbiAgICAgICAgaWYgKGx2KSB7XG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShsdi5fdmFsdWUpID8gbHYuX3ZhbHVlIDogW2x2Ll92YWx1ZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgcmV0dXJuIFByb3BlcnR5VmFsdWU7XG59KEFycmF5KSk7XG5leHBvcnQgeyBQcm9wZXJ0eVZhbHVlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm9wZXJ0eVZhbHVlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/PropertyValue.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Range.js":
/*!**********************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Range.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Range: () => (/* binding */ Range)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar Range = /** @class */ (function (_super) {\n    __extends(Range, _super);\n    function Range(jsonld, options) {\n        var _this = _super.call(this, jsonld, options) || this;\n        _this._ranges = null;\n        _this.canvases = null;\n        _this.items = [];\n        return _this;\n    }\n    Range.prototype.getCanvasIds = function () {\n        if (this.__jsonld.canvases) {\n            return this.__jsonld.canvases;\n        }\n        else if (this.canvases) {\n            return this.canvases;\n        }\n        return [];\n    };\n    Range.prototype.getDuration = function () {\n        // For this implementation, we want to catch SOME of the temporal cases - i.e. when there is a t=1,100\n        if (this.canvases && this.canvases.length) {\n            var startTimes = [];\n            var endTimes = [];\n            // When we loop through all of the canvases we store the recorded start and end times.\n            // Then we choose the maximum and minimum values from this. This will give us a more accurate duration for the\n            // Chosen range. However this is still not perfect and does not cover more complex ranges. These cases are out of\n            // scope for this change.\n            for (var _i = 0, _a = this.canvases; _i < _a.length; _i++) {\n                var canvas = _a[_i];\n                if (!canvas)\n                    continue;\n                var _b = (canvas.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/) || [undefined, canvas]), canvasId = _b[1], start_1 = _b[2], end_1 = _b[3];\n                if (canvasId) {\n                    startTimes.push(parseFloat(start_1));\n                    endTimes.push(parseFloat(end_1));\n                }\n            }\n            if (startTimes.length && endTimes.length) {\n                return new _internal__WEBPACK_IMPORTED_MODULE_0__.Duration(Math.min.apply(Math, startTimes), Math.max.apply(Math, endTimes));\n            }\n        }\n        else {\n            // get child ranges and calculate the start and end based on them\n            var childRanges = this.getRanges();\n            var startTimes = [];\n            var endTimes = [];\n            // Once again, we use a max/min to get the ranges.\n            for (var _c = 0, childRanges_1 = childRanges; _c < childRanges_1.length; _c++) {\n                var childRange = childRanges_1[_c];\n                var duration = childRange.getDuration();\n                if (duration) {\n                    startTimes.push(duration.start);\n                    endTimes.push(duration.end);\n                }\n            }\n            // And return the minimum as the start, and the maximum as the end.\n            if (startTimes.length && endTimes.length) {\n                return new _internal__WEBPACK_IMPORTED_MODULE_0__.Duration(Math.min.apply(Math, startTimes), Math.max.apply(Math, endTimes));\n            }\n        }\n        var start;\n        var end;\n        // There are 2 paths for this implementation. Either we have a list of canvases, or a list of ranges\n        // which may have a list of ranges.\n        // This is one of the limitations of this implementation.\n        if (this.canvases && this.canvases.length) {\n            // When we loop through each of the canvases we are expecting to see a fragment or a link to the whole canvas.\n            // For example - if we have http://example.org/canvas#t=1,100 it will extract 1 and 100 as the start and end.\n            for (var i = 0; i < this.canvases.length; i++) {\n                var canvas = this.canvases[i];\n                var temporal = _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getTemporalComponent(canvas);\n                if (temporal && temporal.length > 1) {\n                    if (i === 0) {\n                        // Note: Cannot guarantee ranges are sequential (fixed above)\n                        start = Number(temporal[0]);\n                    }\n                    if (i === this.canvases.length - 1) {\n                        end = Number(temporal[1]); // Note: The end of this duration may be targeting a different canvas.\n                    }\n                }\n            }\n        }\n        else {\n            // In this second case, where there are nested ranges, we recursively get the duration\n            // from each of the child ranges (a start and end) and then choose the first and last for the bounds of this range.\n            var childRanges = this.getRanges();\n            for (var i = 0; i < childRanges.length; i++) {\n                var childRange = childRanges[i];\n                var duration = childRange.getDuration();\n                if (duration) {\n                    if (i === 0) {\n                        start = duration.start;\n                    }\n                    if (i === childRanges.length - 1) {\n                        end = duration.end;\n                    }\n                }\n            }\n        }\n        if (start !== undefined && end !== undefined) {\n            return new _internal__WEBPACK_IMPORTED_MODULE_0__.Duration(start, end);\n        }\n        return undefined;\n    };\n    // getCanvases(): ICanvas[] {\n    //     if (this._canvases) {\n    //         return this._canvases;\n    //     }\n    //     return this._canvases = <ICanvas[]>this.items.en().where(m => m.isCanvas()).toArray();\n    // }\n    Range.prototype.getRanges = function () {\n        if (this._ranges) {\n            return this._ranges;\n        }\n        return (this._ranges = this.items.filter(function (m) { return m.isRange(); }));\n    };\n    Range.prototype.getBehavior = function () {\n        var behavior = this.getProperty(\"behavior\");\n        if (Array.isArray(behavior)) {\n            behavior = behavior[0];\n        }\n        if (behavior) {\n            return behavior;\n        }\n        return null;\n    };\n    Range.prototype.getViewingDirection = function () {\n        return this.getProperty(\"viewingDirection\");\n    };\n    Range.prototype.getViewingHint = function () {\n        return this.getProperty(\"viewingHint\");\n    };\n    Range.prototype.getTree = function (treeRoot) {\n        treeRoot.data = this;\n        this.treeNode = treeRoot;\n        var ranges = this.getRanges();\n        if (ranges && ranges.length) {\n            for (var i = 0; i < ranges.length; i++) {\n                var range = ranges[i];\n                var node = new _internal__WEBPACK_IMPORTED_MODULE_0__.TreeNode();\n                treeRoot.addNode(node);\n                this._parseTreeNode(node, range);\n            }\n        }\n        _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.generateTreeNodeIds(treeRoot);\n        return treeRoot;\n    };\n    Range.prototype.spansTime = function (time) {\n        var duration = this.getDuration();\n        if (duration) {\n            if (time >= duration.start && time <= duration.end) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Range.prototype._parseTreeNode = function (node, range) {\n        node.label = range.getLabel().getValue(this.options.locale);\n        node.data = range;\n        node.data.type = _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_0__.TreeNodeType.RANGE);\n        range.treeNode = node;\n        var ranges = range.getRanges();\n        if (ranges && ranges.length) {\n            for (var i = 0; i < ranges.length; i++) {\n                var childRange = ranges[i];\n                var behavior = childRange.getBehavior();\n                if (behavior === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.Behavior.NO_NAV) {\n                    continue;\n                }\n                else {\n                    var childNode = new _internal__WEBPACK_IMPORTED_MODULE_0__.TreeNode();\n                    node.addNode(childNode);\n                    this._parseTreeNode(childNode, childRange);\n                }\n            }\n        }\n    };\n    return Range;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=Range.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvUmFuZ2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNzRjtBQUM3QjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsZ0JBQWdCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLCtDQUFRO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsMkJBQTJCO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwrQ0FBUTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwwQkFBMEI7QUFDdEQ7QUFDQSwrQkFBK0IsNENBQUs7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1EO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsd0JBQXdCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLCtDQUFRO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLHFCQUFxQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixtQkFBbUI7QUFDL0M7QUFDQSwrQkFBK0IsK0NBQVE7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDRDQUFLO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qiw0Q0FBSyxlQUFlLG1EQUFZO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixtQkFBbUI7QUFDL0M7QUFDQTtBQUNBLGlDQUFpQyxvRUFBUTtBQUN6QztBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsK0NBQVE7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsdURBQWdCO0FBQ0Q7QUFDakIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9SYW5nZS5qcz8zNjBmIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgRHVyYXRpb24sIE1hbmlmZXN0UmVzb3VyY2UsIFRyZWVOb2RlLCBUcmVlTm9kZVR5cGUsIFV0aWxzIH0gZnJvbSBcIi4vaW50ZXJuYWxcIjtcbmltcG9ydCB7IEJlaGF2aW9yIH0gZnJvbSBcIkBpaWlmL3ZvY2FidWxhcnkvZGlzdC1jb21tb25qc1wiO1xudmFyIFJhbmdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhSYW5nZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSYW5nZShqc29ubGQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywganNvbmxkLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fcmFuZ2VzID0gbnVsbDtcbiAgICAgICAgX3RoaXMuY2FudmFzZXMgPSBudWxsO1xuICAgICAgICBfdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJhbmdlLnByb3RvdHlwZS5nZXRDYW52YXNJZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9fanNvbmxkLmNhbnZhc2VzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX2pzb25sZC5jYW52YXNlcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmNhbnZhc2VzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXNlcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcbiAgICBSYW5nZS5wcm90b3R5cGUuZ2V0RHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIEZvciB0aGlzIGltcGxlbWVudGF0aW9uLCB3ZSB3YW50IHRvIGNhdGNoIFNPTUUgb2YgdGhlIHRlbXBvcmFsIGNhc2VzIC0gaS5lLiB3aGVuIHRoZXJlIGlzIGEgdD0xLDEwMFxuICAgICAgICBpZiAodGhpcy5jYW52YXNlcyAmJiB0aGlzLmNhbnZhc2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHN0YXJ0VGltZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciBlbmRUaW1lcyA9IFtdO1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBsb29wIHRocm91Z2ggYWxsIG9mIHRoZSBjYW52YXNlcyB3ZSBzdG9yZSB0aGUgcmVjb3JkZWQgc3RhcnQgYW5kIGVuZCB0aW1lcy5cbiAgICAgICAgICAgIC8vIFRoZW4gd2UgY2hvb3NlIHRoZSBtYXhpbXVtIGFuZCBtaW5pbXVtIHZhbHVlcyBmcm9tIHRoaXMuIFRoaXMgd2lsbCBnaXZlIHVzIGEgbW9yZSBhY2N1cmF0ZSBkdXJhdGlvbiBmb3IgdGhlXG4gICAgICAgICAgICAvLyBDaG9zZW4gcmFuZ2UuIEhvd2V2ZXIgdGhpcyBpcyBzdGlsbCBub3QgcGVyZmVjdCBhbmQgZG9lcyBub3QgY292ZXIgbW9yZSBjb21wbGV4IHJhbmdlcy4gVGhlc2UgY2FzZXMgYXJlIG91dCBvZlxuICAgICAgICAgICAgLy8gc2NvcGUgZm9yIHRoaXMgY2hhbmdlLlxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuY2FudmFzZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICBpZiAoIWNhbnZhcylcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgdmFyIF9iID0gKGNhbnZhcy5tYXRjaCgvKC4qKSN0PShbMC05Ll0rKSw/KFswLTkuXSspPy8pIHx8IFt1bmRlZmluZWQsIGNhbnZhc10pLCBjYW52YXNJZCA9IF9iWzFdLCBzdGFydF8xID0gX2JbMl0sIGVuZF8xID0gX2JbM107XG4gICAgICAgICAgICAgICAgaWYgKGNhbnZhc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZXMucHVzaChwYXJzZUZsb2F0KHN0YXJ0XzEpKTtcbiAgICAgICAgICAgICAgICAgICAgZW5kVGltZXMucHVzaChwYXJzZUZsb2F0KGVuZF8xKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0YXJ0VGltZXMubGVuZ3RoICYmIGVuZFRpbWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRHVyYXRpb24oTWF0aC5taW4uYXBwbHkoTWF0aCwgc3RhcnRUaW1lcyksIE1hdGgubWF4LmFwcGx5KE1hdGgsIGVuZFRpbWVzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBnZXQgY2hpbGQgcmFuZ2VzIGFuZCBjYWxjdWxhdGUgdGhlIHN0YXJ0IGFuZCBlbmQgYmFzZWQgb24gdGhlbVxuICAgICAgICAgICAgdmFyIGNoaWxkUmFuZ2VzID0gdGhpcy5nZXRSYW5nZXMoKTtcbiAgICAgICAgICAgIHZhciBzdGFydFRpbWVzID0gW107XG4gICAgICAgICAgICB2YXIgZW5kVGltZXMgPSBbXTtcbiAgICAgICAgICAgIC8vIE9uY2UgYWdhaW4sIHdlIHVzZSBhIG1heC9taW4gdG8gZ2V0IHRoZSByYW5nZXMuXG4gICAgICAgICAgICBmb3IgKHZhciBfYyA9IDAsIGNoaWxkUmFuZ2VzXzEgPSBjaGlsZFJhbmdlczsgX2MgPCBjaGlsZFJhbmdlc18xLmxlbmd0aDsgX2MrKykge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZFJhbmdlID0gY2hpbGRSYW5nZXNfMVtfY107XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gY2hpbGRSYW5nZS5nZXREdXJhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWVzLnB1c2goZHVyYXRpb24uc3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICBlbmRUaW1lcy5wdXNoKGR1cmF0aW9uLmVuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQW5kIHJldHVybiB0aGUgbWluaW11bSBhcyB0aGUgc3RhcnQsIGFuZCB0aGUgbWF4aW11bSBhcyB0aGUgZW5kLlxuICAgICAgICAgICAgaWYgKHN0YXJ0VGltZXMubGVuZ3RoICYmIGVuZFRpbWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRHVyYXRpb24oTWF0aC5taW4uYXBwbHkoTWF0aCwgc3RhcnRUaW1lcyksIE1hdGgubWF4LmFwcGx5KE1hdGgsIGVuZFRpbWVzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YXJ0O1xuICAgICAgICB2YXIgZW5kO1xuICAgICAgICAvLyBUaGVyZSBhcmUgMiBwYXRocyBmb3IgdGhpcyBpbXBsZW1lbnRhdGlvbi4gRWl0aGVyIHdlIGhhdmUgYSBsaXN0IG9mIGNhbnZhc2VzLCBvciBhIGxpc3Qgb2YgcmFuZ2VzXG4gICAgICAgIC8vIHdoaWNoIG1heSBoYXZlIGEgbGlzdCBvZiByYW5nZXMuXG4gICAgICAgIC8vIFRoaXMgaXMgb25lIG9mIHRoZSBsaW1pdGF0aW9ucyBvZiB0aGlzIGltcGxlbWVudGF0aW9uLlxuICAgICAgICBpZiAodGhpcy5jYW52YXNlcyAmJiB0aGlzLmNhbnZhc2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBsb29wIHRocm91Z2ggZWFjaCBvZiB0aGUgY2FudmFzZXMgd2UgYXJlIGV4cGVjdGluZyB0byBzZWUgYSBmcmFnbWVudCBvciBhIGxpbmsgdG8gdGhlIHdob2xlIGNhbnZhcy5cbiAgICAgICAgICAgIC8vIEZvciBleGFtcGxlIC0gaWYgd2UgaGF2ZSBodHRwOi8vZXhhbXBsZS5vcmcvY2FudmFzI3Q9MSwxMDAgaXQgd2lsbCBleHRyYWN0IDEgYW5kIDEwMCBhcyB0aGUgc3RhcnQgYW5kIGVuZC5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jYW52YXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjYW52YXMgPSB0aGlzLmNhbnZhc2VzW2ldO1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wb3JhbCA9IFV0aWxzLmdldFRlbXBvcmFsQ29tcG9uZW50KGNhbnZhcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRlbXBvcmFsICYmIHRlbXBvcmFsLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGU6IENhbm5vdCBndWFyYW50ZWUgcmFuZ2VzIGFyZSBzZXF1ZW50aWFsIChmaXhlZCBhYm92ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gTnVtYmVyKHRlbXBvcmFsWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gdGhpcy5jYW52YXNlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBOdW1iZXIodGVtcG9yYWxbMV0pOyAvLyBOb3RlOiBUaGUgZW5kIG9mIHRoaXMgZHVyYXRpb24gbWF5IGJlIHRhcmdldGluZyBhIGRpZmZlcmVudCBjYW52YXMuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBJbiB0aGlzIHNlY29uZCBjYXNlLCB3aGVyZSB0aGVyZSBhcmUgbmVzdGVkIHJhbmdlcywgd2UgcmVjdXJzaXZlbHkgZ2V0IHRoZSBkdXJhdGlvblxuICAgICAgICAgICAgLy8gZnJvbSBlYWNoIG9mIHRoZSBjaGlsZCByYW5nZXMgKGEgc3RhcnQgYW5kIGVuZCkgYW5kIHRoZW4gY2hvb3NlIHRoZSBmaXJzdCBhbmQgbGFzdCBmb3IgdGhlIGJvdW5kcyBvZiB0aGlzIHJhbmdlLlxuICAgICAgICAgICAgdmFyIGNoaWxkUmFuZ2VzID0gdGhpcy5nZXRSYW5nZXMoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRSYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRSYW5nZSA9IGNoaWxkUmFuZ2VzW2ldO1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IGNoaWxkUmFuZ2UuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gZHVyYXRpb24uc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IGNoaWxkUmFuZ2VzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IGR1cmF0aW9uLmVuZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnQgIT09IHVuZGVmaW5lZCAmJiBlbmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEdXJhdGlvbihzdGFydCwgZW5kKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgLy8gZ2V0Q2FudmFzZXMoKTogSUNhbnZhc1tdIHtcbiAgICAvLyAgICAgaWYgKHRoaXMuX2NhbnZhc2VzKSB7XG4gICAgLy8gICAgICAgICByZXR1cm4gdGhpcy5fY2FudmFzZXM7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgcmV0dXJuIHRoaXMuX2NhbnZhc2VzID0gPElDYW52YXNbXT50aGlzLml0ZW1zLmVuKCkud2hlcmUobSA9PiBtLmlzQ2FudmFzKCkpLnRvQXJyYXkoKTtcbiAgICAvLyB9XG4gICAgUmFuZ2UucHJvdG90eXBlLmdldFJhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Jhbmdlcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JhbmdlcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRoaXMuX3JhbmdlcyA9IHRoaXMuaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLmlzUmFuZ2UoKTsgfSkpO1xuICAgIH07XG4gICAgUmFuZ2UucHJvdG90eXBlLmdldEJlaGF2aW9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYmVoYXZpb3IgPSB0aGlzLmdldFByb3BlcnR5KFwiYmVoYXZpb3JcIik7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGJlaGF2aW9yKSkge1xuICAgICAgICAgICAgYmVoYXZpb3IgPSBiZWhhdmlvclswXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmVoYXZpb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBiZWhhdmlvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFJhbmdlLnByb3RvdHlwZS5nZXRWaWV3aW5nRGlyZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eShcInZpZXdpbmdEaXJlY3Rpb25cIik7XG4gICAgfTtcbiAgICBSYW5nZS5wcm90b3R5cGUuZ2V0Vmlld2luZ0hpbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwidmlld2luZ0hpbnRcIik7XG4gICAgfTtcbiAgICBSYW5nZS5wcm90b3R5cGUuZ2V0VHJlZSA9IGZ1bmN0aW9uICh0cmVlUm9vdCkge1xuICAgICAgICB0cmVlUm9vdC5kYXRhID0gdGhpcztcbiAgICAgICAgdGhpcy50cmVlTm9kZSA9IHRyZWVSb290O1xuICAgICAgICB2YXIgcmFuZ2VzID0gdGhpcy5nZXRSYW5nZXMoKTtcbiAgICAgICAgaWYgKHJhbmdlcyAmJiByYW5nZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHJhbmdlc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IG5ldyBUcmVlTm9kZSgpO1xuICAgICAgICAgICAgICAgIHRyZWVSb290LmFkZE5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VUcmVlTm9kZShub2RlLCByYW5nZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgVXRpbHMuZ2VuZXJhdGVUcmVlTm9kZUlkcyh0cmVlUm9vdCk7XG4gICAgICAgIHJldHVybiB0cmVlUm9vdDtcbiAgICB9O1xuICAgIFJhbmdlLnByb3RvdHlwZS5zcGFuc1RpbWUgPSBmdW5jdGlvbiAodGltZSkge1xuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmdldER1cmF0aW9uKCk7XG4gICAgICAgIGlmIChkdXJhdGlvbikge1xuICAgICAgICAgICAgaWYgKHRpbWUgPj0gZHVyYXRpb24uc3RhcnQgJiYgdGltZSA8PSBkdXJhdGlvbi5lbmQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBSYW5nZS5wcm90b3R5cGUuX3BhcnNlVHJlZU5vZGUgPSBmdW5jdGlvbiAobm9kZSwgcmFuZ2UpIHtcbiAgICAgICAgbm9kZS5sYWJlbCA9IHJhbmdlLmdldExhYmVsKCkuZ2V0VmFsdWUodGhpcy5vcHRpb25zLmxvY2FsZSk7XG4gICAgICAgIG5vZGUuZGF0YSA9IHJhbmdlO1xuICAgICAgICBub2RlLmRhdGEudHlwZSA9IFV0aWxzLm5vcm1hbGlzZVR5cGUoVHJlZU5vZGVUeXBlLlJBTkdFKTtcbiAgICAgICAgcmFuZ2UudHJlZU5vZGUgPSBub2RlO1xuICAgICAgICB2YXIgcmFuZ2VzID0gcmFuZ2UuZ2V0UmFuZ2VzKCk7XG4gICAgICAgIGlmIChyYW5nZXMgJiYgcmFuZ2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRSYW5nZSA9IHJhbmdlc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgYmVoYXZpb3IgPSBjaGlsZFJhbmdlLmdldEJlaGF2aW9yKCk7XG4gICAgICAgICAgICAgICAgaWYgKGJlaGF2aW9yID09PSBCZWhhdmlvci5OT19OQVYpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGROb2RlID0gbmV3IFRyZWVOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkTm9kZShjaGlsZE5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZVRyZWVOb2RlKGNoaWxkTm9kZSwgY2hpbGRSYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUmFuZ2U7XG59KE1hbmlmZXN0UmVzb3VyY2UpKTtcbmV4cG9ydCB7IFJhbmdlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1SYW5nZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Range.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Rendering.js":
/*!**************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Rendering.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Rendering: () => (/* binding */ Rendering)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar Rendering = /** @class */ (function (_super) {\n    __extends(Rendering, _super);\n    function Rendering(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    Rendering.prototype.getFormat = function () {\n        return this.getProperty(\"format\");\n    };\n    return Rendering;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=Rendering.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvUmVuZGVyaW5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUM2QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsdURBQWdCO0FBQ0c7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9SZW5kZXJpbmcuanM/YjEyMCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IE1hbmlmZXN0UmVzb3VyY2UgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIFJlbmRlcmluZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUmVuZGVyaW5nLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJlbmRlcmluZyhqc29ubGQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCwgb3B0aW9ucykgfHwgdGhpcztcbiAgICB9XG4gICAgUmVuZGVyaW5nLnByb3RvdHlwZS5nZXRGb3JtYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwiZm9ybWF0XCIpO1xuICAgIH07XG4gICAgcmV0dXJuIFJlbmRlcmluZztcbn0oTWFuaWZlc3RSZXNvdXJjZSkpO1xuZXhwb3J0IHsgUmVuZGVyaW5nIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZW5kZXJpbmcuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Rendering.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Resource.js":
/*!*************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Resource.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Resource: () => (/* binding */ Resource)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar Resource = /** @class */ (function (_super) {\n    __extends(Resource, _super);\n    function Resource(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    Resource.prototype.getFormat = function () {\n        var format = this.getProperty(\"format\");\n        if (format) {\n            return format.toLowerCase();\n        }\n        return null;\n    };\n    Resource.prototype.getResources = function () {\n        var resources = [];\n        if (!this.__jsonld.resources)\n            return resources;\n        for (var i = 0; i < this.__jsonld.resources.length; i++) {\n            var a = this.__jsonld.resources[i];\n            var annotation = new _internal__WEBPACK_IMPORTED_MODULE_0__.Annotation(a, this.options);\n            resources.push(annotation);\n        }\n        return resources;\n    };\n    Resource.prototype.getType = function () {\n        var type = this.getProperty(\"type\");\n        if (type) {\n            return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(type);\n        }\n        return null;\n    };\n    Resource.prototype.getWidth = function () {\n        return this.getProperty(\"width\");\n    };\n    Resource.prototype.getHeight = function () {\n        return this.getProperty(\"height\");\n    };\n    Resource.prototype.getMaxWidth = function () {\n        return this.getProperty(\"maxWidth\");\n    };\n    Resource.prototype.getMaxHeight = function () {\n        var maxHeight = this.getProperty(\"maxHeight\");\n        // if a maxHeight hasn't been specified, default to maxWidth.\n        // maxWidth in essence becomes maxEdge\n        if (!maxHeight) {\n            return this.getMaxWidth();\n        }\n        return null;\n    };\n    return Resource;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=Resource.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvUmVzb3VyY2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ2dFO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9DQUFvQztBQUM1RDtBQUNBLGlDQUFpQyxpREFBVTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw0Q0FBSztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx1REFBZ0I7QUFDRTtBQUNwQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0Ly4vbm9kZV9tb2R1bGVzL21hbmlmZXN0by5qcy9kaXN0LWVzbW9kdWxlL1Jlc291cmNlLmpzPzQxODAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBBbm5vdGF0aW9uLCBNYW5pZmVzdFJlc291cmNlLCBVdGlscyB9IGZyb20gXCIuL2ludGVybmFsXCI7XG52YXIgUmVzb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFJlc291cmNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJlc291cmNlKGpzb25sZCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywganNvbmxkLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgIH1cbiAgICBSZXNvdXJjZS5wcm90b3R5cGUuZ2V0Rm9ybWF0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZm9ybWF0ID0gdGhpcy5nZXRQcm9wZXJ0eShcImZvcm1hdFwiKTtcbiAgICAgICAgaWYgKGZvcm1hdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUmVzb3VyY2UucHJvdG90eXBlLmdldFJlc291cmNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc291cmNlcyA9IFtdO1xuICAgICAgICBpZiAoIXRoaXMuX19qc29ubGQucmVzb3VyY2VzKVxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9fanNvbmxkLnJlc291cmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSB0aGlzLl9fanNvbmxkLnJlc291cmNlc1tpXTtcbiAgICAgICAgICAgIHZhciBhbm5vdGF0aW9uID0gbmV3IEFubm90YXRpb24oYSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIHJlc291cmNlcy5wdXNoKGFubm90YXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNvdXJjZXM7XG4gICAgfTtcbiAgICBSZXNvdXJjZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHR5cGUgPSB0aGlzLmdldFByb3BlcnR5KFwidHlwZVwiKTtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiBVdGlscy5ub3JtYWxpc2VUeXBlKHR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUmVzb3VyY2UucHJvdG90eXBlLmdldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eShcIndpZHRoXCIpO1xuICAgIH07XG4gICAgUmVzb3VyY2UucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJoZWlnaHRcIik7XG4gICAgfTtcbiAgICBSZXNvdXJjZS5wcm90b3R5cGUuZ2V0TWF4V2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwibWF4V2lkdGhcIik7XG4gICAgfTtcbiAgICBSZXNvdXJjZS5wcm90b3R5cGUuZ2V0TWF4SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWF4SGVpZ2h0ID0gdGhpcy5nZXRQcm9wZXJ0eShcIm1heEhlaWdodFwiKTtcbiAgICAgICAgLy8gaWYgYSBtYXhIZWlnaHQgaGFzbid0IGJlZW4gc3BlY2lmaWVkLCBkZWZhdWx0IHRvIG1heFdpZHRoLlxuICAgICAgICAvLyBtYXhXaWR0aCBpbiBlc3NlbmNlIGJlY29tZXMgbWF4RWRnZVxuICAgICAgICBpZiAoIW1heEhlaWdodCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWF4V2lkdGgoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBSZXNvdXJjZTtcbn0oTWFuaWZlc3RSZXNvdXJjZSkpO1xuZXhwb3J0IHsgUmVzb3VyY2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlc291cmNlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Resource.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Sequence.js":
/*!*************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Sequence.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Sequence: () => (/* binding */ Sequence)\n/* harmony export */ });\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar Sequence = /** @class */ (function (_super) {\n    __extends(Sequence, _super);\n    function Sequence(jsonld, options) {\n        var _this = _super.call(this, jsonld, options) || this;\n        _this.items = [];\n        _this._thumbnails = null;\n        return _this;\n    }\n    Sequence.prototype.getCanvases = function () {\n        if (this.items.length) {\n            return this.items;\n        }\n        var items = this.__jsonld.canvases || this.__jsonld.elements;\n        if (items) {\n            for (var i = 0; i < items.length; i++) {\n                var c = items[i];\n                var canvas = new _internal__WEBPACK_IMPORTED_MODULE_1__.Canvas(c, this.options);\n                canvas.index = i;\n                this.items.push(canvas);\n            }\n        }\n        else if (this.__jsonld) {\n            for (var i = 0; i < this.__jsonld.length; i++) {\n                var c = this.__jsonld[i];\n                var canvas = new _internal__WEBPACK_IMPORTED_MODULE_1__.Canvas(c, this.options);\n                canvas.index = i;\n                this.items.push(canvas);\n            }\n        }\n        return this.items;\n    };\n    Sequence.prototype.getCanvasById = function (id) {\n        for (var i = 0; i < this.getTotalCanvases(); i++) {\n            var canvas = this.getCanvasByIndex(i);\n            // normalise canvas id\n            var canvasId = _internal__WEBPACK_IMPORTED_MODULE_1__.Utils.normaliseUrl(canvas.id);\n            if (_internal__WEBPACK_IMPORTED_MODULE_1__.Utils.normaliseUrl(id) === canvasId) {\n                return canvas;\n            }\n        }\n        return null;\n    };\n    Sequence.prototype.getCanvasByIndex = function (canvasIndex) {\n        return this.getCanvases()[canvasIndex];\n    };\n    Sequence.prototype.getCanvasIndexById = function (id) {\n        for (var i = 0; i < this.getTotalCanvases(); i++) {\n            var canvas = this.getCanvasByIndex(i);\n            if (canvas.id === id) {\n                return i;\n            }\n        }\n        return null;\n    };\n    Sequence.prototype.getCanvasIndexByLabel = function (label, foliated) {\n        label = label.trim();\n        if (!isNaN(label)) {\n            // if the label is numeric\n            label = parseInt(label, 10).toString(); // trim any preceding zeros.\n            if (foliated)\n                label += \"r\"; // default to recto\n        }\n        var doublePageRegExp = /(\\d*)\\D+(\\d*)/;\n        var match, regExp, regStr, labelPart1, labelPart2;\n        for (var i = 0; i < this.getTotalCanvases(); i++) {\n            var canvas = this.getCanvasByIndex(i);\n            // check if there's a literal match\n            if (canvas.getLabel().getValue(this.options.locale) === label) {\n                return i;\n            }\n            // check if there's a match for double-page spreads e.g. 100-101, 100_101, 100 101\n            match = doublePageRegExp.exec(label);\n            if (!match)\n                continue;\n            labelPart1 = match[1];\n            labelPart2 = match[2];\n            if (!labelPart2)\n                continue;\n            regStr = \"^\" + labelPart1 + \"\\\\D+\" + labelPart2 + \"$\";\n            regExp = new RegExp(regStr);\n            if (regExp.test(canvas.getLabel().toString())) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    Sequence.prototype.getLastCanvasLabel = function (alphanumeric) {\n        for (var i = this.getTotalCanvases() - 1; i >= 0; i--) {\n            var canvas = this.getCanvasByIndex(i);\n            var label = (canvas.getLabel().getValue(this.options.locale));\n            if (alphanumeric) {\n                var regExp = /^[a-zA-Z0-9]*$/;\n                if (regExp.test(label)) {\n                    return label;\n                }\n            }\n            else if (label) {\n                return label;\n            }\n        }\n        return this.options.defaultLabel;\n    };\n    Sequence.prototype.getLastPageIndex = function () {\n        return this.getTotalCanvases() - 1;\n    };\n    Sequence.prototype.getNextPageIndex = function (canvasIndex, pagingEnabled) {\n        var index;\n        if (pagingEnabled) {\n            var indices = this.getPagedIndices(canvasIndex);\n            var viewingDirection = this.getViewingDirection();\n            if (viewingDirection &&\n                viewingDirection === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingDirection.RIGHT_TO_LEFT) {\n                index = indices[0] + 1;\n            }\n            else {\n                index = indices[indices.length - 1] + 1;\n            }\n        }\n        else {\n            index = canvasIndex + 1;\n        }\n        if (index > this.getLastPageIndex()) {\n            return -1;\n        }\n        return index;\n    };\n    Sequence.prototype.getPagedIndices = function (canvasIndex, pagingEnabled) {\n        var indices = [];\n        if (!pagingEnabled) {\n            indices.push(canvasIndex);\n        }\n        else {\n            if (this.isFirstCanvas(canvasIndex) || this.isLastCanvas(canvasIndex)) {\n                indices = [canvasIndex];\n            }\n            else if (canvasIndex % 2) {\n                indices = [canvasIndex, canvasIndex + 1];\n            }\n            else {\n                indices = [canvasIndex - 1, canvasIndex];\n            }\n            var viewingDirection = this.getViewingDirection();\n            if (viewingDirection &&\n                viewingDirection === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingDirection.RIGHT_TO_LEFT) {\n                indices = indices.reverse();\n            }\n        }\n        return indices;\n    };\n    Sequence.prototype.getPrevPageIndex = function (canvasIndex, pagingEnabled) {\n        var index;\n        if (pagingEnabled) {\n            var indices = this.getPagedIndices(canvasIndex);\n            var viewingDirection = this.getViewingDirection();\n            if (viewingDirection &&\n                viewingDirection === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingDirection.RIGHT_TO_LEFT) {\n                index = indices[indices.length - 1] - 1;\n            }\n            else {\n                index = indices[0] - 1;\n            }\n        }\n        else {\n            index = canvasIndex - 1;\n        }\n        return index;\n    };\n    Sequence.prototype.getStartCanvasIndex = function () {\n        var startCanvas = this.getStartCanvas();\n        if (startCanvas) {\n            // if there's a startCanvas attribute, loop through the canvases and return the matching index.\n            for (var i = 0; i < this.getTotalCanvases(); i++) {\n                var canvas = this.getCanvasByIndex(i);\n                if (canvas.id === startCanvas)\n                    return i;\n            }\n        }\n        // default to first canvas.\n        return 0;\n    };\n    // todo: deprecate\n    Sequence.prototype.getThumbs = function (width, height) {\n        //console.warn('getThumbs will be deprecated, use getThumbnails instead');\n        var thumbs = [];\n        var totalCanvases = this.getTotalCanvases();\n        for (var i = 0; i < totalCanvases; i++) {\n            var canvas = this.getCanvasByIndex(i);\n            var thumb = new _internal__WEBPACK_IMPORTED_MODULE_1__.Thumb(width, canvas);\n            thumbs.push(thumb);\n        }\n        return thumbs;\n    };\n    Sequence.prototype.getThumbnails = function () {\n        if (this._thumbnails != null)\n            return this._thumbnails;\n        this._thumbnails = [];\n        var canvases = this.getCanvases();\n        for (var i = 0; i < canvases.length; i++) {\n            var thumbnail = canvases[i].getThumbnail();\n            if (thumbnail) {\n                this._thumbnails.push(thumbnail);\n            }\n        }\n        return this._thumbnails;\n    };\n    Sequence.prototype.getStartCanvas = function () {\n        return this.getProperty(\"startCanvas\");\n    };\n    Sequence.prototype.getTotalCanvases = function () {\n        return this.getCanvases().length;\n    };\n    Sequence.prototype.getViewingDirection = function () {\n        if (this.getProperty(\"viewingDirection\")) {\n            return this.getProperty(\"viewingDirection\");\n        }\n        else if (this.options.resource.getViewingDirection) {\n            return this.options.resource.getViewingDirection();\n        }\n        return null;\n    };\n    Sequence.prototype.getViewingHint = function () {\n        return this.getProperty(\"viewingHint\");\n    };\n    Sequence.prototype.isCanvasIndexOutOfRange = function (canvasIndex) {\n        return canvasIndex > this.getTotalCanvases() - 1;\n    };\n    Sequence.prototype.isFirstCanvas = function (canvasIndex) {\n        return canvasIndex === 0;\n    };\n    Sequence.prototype.isLastCanvas = function (canvasIndex) {\n        return canvasIndex === this.getTotalCanvases() - 1;\n    };\n    Sequence.prototype.isMultiCanvas = function () {\n        return this.getTotalCanvases() > 1;\n    };\n    Sequence.prototype.isPagingEnabled = function () {\n        var viewingHint = this.getViewingHint();\n        if (viewingHint) {\n            return viewingHint === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_0__.ViewingHint.PAGED;\n        }\n        return false;\n    };\n    // checks if the number of canvases is even - therefore has a front and back cover\n    Sequence.prototype.isTotalCanvasesEven = function () {\n        return this.getTotalCanvases() % 2 === 0;\n    };\n    return Sequence;\n}(_internal__WEBPACK_IMPORTED_MODULE_1__.ManifestResource));\n\n//# sourceMappingURL=Sequence.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2VxdWVuY2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUM4RTtBQUNYO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0JBQWtCO0FBQzlDO0FBQ0EsaUNBQWlDLDZDQUFNO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMEJBQTBCO0FBQ3REO0FBQ0EsaUNBQWlDLDZDQUFNO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDZCQUE2QjtBQUNyRDtBQUNBO0FBQ0EsMkJBQTJCLDRDQUFLO0FBQ2hDLGdCQUFnQiw0Q0FBSztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkJBQTZCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDZCQUE2QjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxRQUFRO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsNEVBQWdCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDRFQUFnQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDRFQUFnQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNkJBQTZCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG1CQUFtQjtBQUMzQztBQUNBLDRCQUE0Qiw0Q0FBSztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHVFQUFXO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsdURBQWdCO0FBQ0U7QUFDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9TZXF1ZW5jZS5qcz9kZWM5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgVmlld2luZ0RpcmVjdGlvbiwgVmlld2luZ0hpbnQgfSBmcm9tIFwiQGlpaWYvdm9jYWJ1bGFyeS9kaXN0LWNvbW1vbmpzXCI7XG5pbXBvcnQgeyBDYW52YXMsIE1hbmlmZXN0UmVzb3VyY2UsIFRodW1iLCBVdGlscyB9IGZyb20gXCIuL2ludGVybmFsXCI7XG52YXIgU2VxdWVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlcXVlbmNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlcXVlbmNlKGpzb25sZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBqc29ubGQsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLml0ZW1zID0gW107XG4gICAgICAgIF90aGlzLl90aHVtYm5haWxzID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0Q2FudmFzZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5fX2pzb25sZC5jYW52YXNlcyB8fCB0aGlzLl9fanNvbmxkLmVsZW1lbnRzO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGl0ZW1zW2ldO1xuICAgICAgICAgICAgICAgIHZhciBjYW52YXMgPSBuZXcgQ2FudmFzKGMsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgY2FudmFzLmluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goY2FudmFzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9fanNvbmxkKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX19qc29ubGQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuX19qc29ubGRbaV07XG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IG5ldyBDYW52YXMoYywgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgICAgICBjYW52YXMuaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaChjYW52YXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmdldENhbnZhc0J5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmdldFRvdGFsQ2FudmFzZXMoKTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY2FudmFzID0gdGhpcy5nZXRDYW52YXNCeUluZGV4KGkpO1xuICAgICAgICAgICAgLy8gbm9ybWFsaXNlIGNhbnZhcyBpZFxuICAgICAgICAgICAgdmFyIGNhbnZhc0lkID0gVXRpbHMubm9ybWFsaXNlVXJsKGNhbnZhcy5pZCk7XG4gICAgICAgICAgICBpZiAoVXRpbHMubm9ybWFsaXNlVXJsKGlkKSA9PT0gY2FudmFzSWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmdldENhbnZhc0J5SW5kZXggPSBmdW5jdGlvbiAoY2FudmFzSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2FudmFzZXMoKVtjYW52YXNJbmRleF07XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0Q2FudmFzSW5kZXhCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5nZXRUb3RhbENhbnZhc2VzKCk7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IHRoaXMuZ2V0Q2FudmFzQnlJbmRleChpKTtcbiAgICAgICAgICAgIGlmIChjYW52YXMuaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0Q2FudmFzSW5kZXhCeUxhYmVsID0gZnVuY3Rpb24gKGxhYmVsLCBmb2xpYXRlZCkge1xuICAgICAgICBsYWJlbCA9IGxhYmVsLnRyaW0oKTtcbiAgICAgICAgaWYgKCFpc05hTihsYWJlbCkpIHtcbiAgICAgICAgICAgIC8vIGlmIHRoZSBsYWJlbCBpcyBudW1lcmljXG4gICAgICAgICAgICBsYWJlbCA9IHBhcnNlSW50KGxhYmVsLCAxMCkudG9TdHJpbmcoKTsgLy8gdHJpbSBhbnkgcHJlY2VkaW5nIHplcm9zLlxuICAgICAgICAgICAgaWYgKGZvbGlhdGVkKVxuICAgICAgICAgICAgICAgIGxhYmVsICs9IFwiclwiOyAvLyBkZWZhdWx0IHRvIHJlY3RvXG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRvdWJsZVBhZ2VSZWdFeHAgPSAvKFxcZCopXFxEKyhcXGQqKS87XG4gICAgICAgIHZhciBtYXRjaCwgcmVnRXhwLCByZWdTdHIsIGxhYmVsUGFydDEsIGxhYmVsUGFydDI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5nZXRUb3RhbENhbnZhc2VzKCk7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IHRoaXMuZ2V0Q2FudmFzQnlJbmRleChpKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlJ3MgYSBsaXRlcmFsIG1hdGNoXG4gICAgICAgICAgICBpZiAoY2FudmFzLmdldExhYmVsKCkuZ2V0VmFsdWUodGhpcy5vcHRpb25zLmxvY2FsZSkgPT09IGxhYmVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSdzIGEgbWF0Y2ggZm9yIGRvdWJsZS1wYWdlIHNwcmVhZHMgZS5nLiAxMDAtMTAxLCAxMDBfMTAxLCAxMDAgMTAxXG4gICAgICAgICAgICBtYXRjaCA9IGRvdWJsZVBhZ2VSZWdFeHAuZXhlYyhsYWJlbCk7XG4gICAgICAgICAgICBpZiAoIW1hdGNoKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgbGFiZWxQYXJ0MSA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgbGFiZWxQYXJ0MiA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgaWYgKCFsYWJlbFBhcnQyKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgcmVnU3RyID0gXCJeXCIgKyBsYWJlbFBhcnQxICsgXCJcXFxcRCtcIiArIGxhYmVsUGFydDIgKyBcIiRcIjtcbiAgICAgICAgICAgIHJlZ0V4cCA9IG5ldyBSZWdFeHAocmVnU3RyKTtcbiAgICAgICAgICAgIGlmIChyZWdFeHAudGVzdChjYW52YXMuZ2V0TGFiZWwoKS50b1N0cmluZygpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5nZXRMYXN0Q2FudmFzTGFiZWwgPSBmdW5jdGlvbiAoYWxwaGFudW1lcmljKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmdldFRvdGFsQ2FudmFzZXMoKSAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgY2FudmFzID0gdGhpcy5nZXRDYW52YXNCeUluZGV4KGkpO1xuICAgICAgICAgICAgdmFyIGxhYmVsID0gKGNhbnZhcy5nZXRMYWJlbCgpLmdldFZhbHVlKHRoaXMub3B0aW9ucy5sb2NhbGUpKTtcbiAgICAgICAgICAgIGlmIChhbHBoYW51bWVyaWMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnRXhwID0gL15bYS16QS1aMC05XSokLztcbiAgICAgICAgICAgICAgICBpZiAocmVnRXhwLnRlc3QobGFiZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmRlZmF1bHRMYWJlbDtcbiAgICB9O1xuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5nZXRMYXN0UGFnZUluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUb3RhbENhbnZhc2VzKCkgLSAxO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmdldE5leHRQYWdlSW5kZXggPSBmdW5jdGlvbiAoY2FudmFzSW5kZXgsIHBhZ2luZ0VuYWJsZWQpIHtcbiAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICBpZiAocGFnaW5nRW5hYmxlZCkge1xuICAgICAgICAgICAgdmFyIGluZGljZXMgPSB0aGlzLmdldFBhZ2VkSW5kaWNlcyhjYW52YXNJbmRleCk7XG4gICAgICAgICAgICB2YXIgdmlld2luZ0RpcmVjdGlvbiA9IHRoaXMuZ2V0Vmlld2luZ0RpcmVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKHZpZXdpbmdEaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICB2aWV3aW5nRGlyZWN0aW9uID09PSBWaWV3aW5nRGlyZWN0aW9uLlJJR0hUX1RPX0xFRlQpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGluZGljZXNbMF0gKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRpY2VzW2luZGljZXMubGVuZ3RoIC0gMV0gKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5kZXggPSBjYW52YXNJbmRleCArIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluZGV4ID4gdGhpcy5nZXRMYXN0UGFnZUluZGV4KCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0UGFnZWRJbmRpY2VzID0gZnVuY3Rpb24gKGNhbnZhc0luZGV4LCBwYWdpbmdFbmFibGVkKSB7XG4gICAgICAgIHZhciBpbmRpY2VzID0gW107XG4gICAgICAgIGlmICghcGFnaW5nRW5hYmxlZCkge1xuICAgICAgICAgICAgaW5kaWNlcy5wdXNoKGNhbnZhc0luZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRmlyc3RDYW52YXMoY2FudmFzSW5kZXgpIHx8IHRoaXMuaXNMYXN0Q2FudmFzKGNhbnZhc0luZGV4KSkge1xuICAgICAgICAgICAgICAgIGluZGljZXMgPSBbY2FudmFzSW5kZXhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY2FudmFzSW5kZXggJSAyKSB7XG4gICAgICAgICAgICAgICAgaW5kaWNlcyA9IFtjYW52YXNJbmRleCwgY2FudmFzSW5kZXggKyAxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZGljZXMgPSBbY2FudmFzSW5kZXggLSAxLCBjYW52YXNJbmRleF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmlld2luZ0RpcmVjdGlvbiA9IHRoaXMuZ2V0Vmlld2luZ0RpcmVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKHZpZXdpbmdEaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICB2aWV3aW5nRGlyZWN0aW9uID09PSBWaWV3aW5nRGlyZWN0aW9uLlJJR0hUX1RPX0xFRlQpIHtcbiAgICAgICAgICAgICAgICBpbmRpY2VzID0gaW5kaWNlcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZGljZXM7XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0UHJldlBhZ2VJbmRleCA9IGZ1bmN0aW9uIChjYW52YXNJbmRleCwgcGFnaW5nRW5hYmxlZCkge1xuICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgIGlmIChwYWdpbmdFbmFibGVkKSB7XG4gICAgICAgICAgICB2YXIgaW5kaWNlcyA9IHRoaXMuZ2V0UGFnZWRJbmRpY2VzKGNhbnZhc0luZGV4KTtcbiAgICAgICAgICAgIHZhciB2aWV3aW5nRGlyZWN0aW9uID0gdGhpcy5nZXRWaWV3aW5nRGlyZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAodmlld2luZ0RpcmVjdGlvbiAmJlxuICAgICAgICAgICAgICAgIHZpZXdpbmdEaXJlY3Rpb24gPT09IFZpZXdpbmdEaXJlY3Rpb24uUklHSFRfVE9fTEVGVCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kaWNlc1tpbmRpY2VzLmxlbmd0aCAtIDFdIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kaWNlc1swXSAtIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbmRleCA9IGNhbnZhc0luZGV4IC0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0U3RhcnRDYW52YXNJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0Q2FudmFzID0gdGhpcy5nZXRTdGFydENhbnZhcygpO1xuICAgICAgICBpZiAoc3RhcnRDYW52YXMpIHtcbiAgICAgICAgICAgIC8vIGlmIHRoZXJlJ3MgYSBzdGFydENhbnZhcyBhdHRyaWJ1dGUsIGxvb3AgdGhyb3VnaCB0aGUgY2FudmFzZXMgYW5kIHJldHVybiB0aGUgbWF0Y2hpbmcgaW5kZXguXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZ2V0VG90YWxDYW52YXNlcygpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gdGhpcy5nZXRDYW52YXNCeUluZGV4KGkpO1xuICAgICAgICAgICAgICAgIGlmIChjYW52YXMuaWQgPT09IHN0YXJ0Q2FudmFzKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBkZWZhdWx0IHRvIGZpcnN0IGNhbnZhcy5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICAvLyB0b2RvOiBkZXByZWNhdGVcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0VGh1bWJzID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgLy9jb25zb2xlLndhcm4oJ2dldFRodW1icyB3aWxsIGJlIGRlcHJlY2F0ZWQsIHVzZSBnZXRUaHVtYm5haWxzIGluc3RlYWQnKTtcbiAgICAgICAgdmFyIHRodW1icyA9IFtdO1xuICAgICAgICB2YXIgdG90YWxDYW52YXNlcyA9IHRoaXMuZ2V0VG90YWxDYW52YXNlcygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvdGFsQ2FudmFzZXM7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IHRoaXMuZ2V0Q2FudmFzQnlJbmRleChpKTtcbiAgICAgICAgICAgIHZhciB0aHVtYiA9IG5ldyBUaHVtYih3aWR0aCwgY2FudmFzKTtcbiAgICAgICAgICAgIHRodW1icy5wdXNoKHRodW1iKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGh1bWJzO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmdldFRodW1ibmFpbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl90aHVtYm5haWxzICE9IG51bGwpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGh1bWJuYWlscztcbiAgICAgICAgdGhpcy5fdGh1bWJuYWlscyA9IFtdO1xuICAgICAgICB2YXIgY2FudmFzZXMgPSB0aGlzLmdldENhbnZhc2VzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FudmFzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0aHVtYm5haWwgPSBjYW52YXNlc1tpXS5nZXRUaHVtYm5haWwoKTtcbiAgICAgICAgICAgIGlmICh0aHVtYm5haWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90aHVtYm5haWxzLnB1c2godGh1bWJuYWlsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdGh1bWJuYWlscztcbiAgICB9O1xuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5nZXRTdGFydENhbnZhcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoXCJzdGFydENhbnZhc1wiKTtcbiAgICB9O1xuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5nZXRUb3RhbENhbnZhc2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDYW52YXNlcygpLmxlbmd0aDtcbiAgICB9O1xuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5nZXRWaWV3aW5nRGlyZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5nZXRQcm9wZXJ0eShcInZpZXdpbmdEaXJlY3Rpb25cIikpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwidmlld2luZ0RpcmVjdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLm9wdGlvbnMucmVzb3VyY2UuZ2V0Vmlld2luZ0RpcmVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5yZXNvdXJjZS5nZXRWaWV3aW5nRGlyZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuZ2V0Vmlld2luZ0hpbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFwidmlld2luZ0hpbnRcIik7XG4gICAgfTtcbiAgICBTZXF1ZW5jZS5wcm90b3R5cGUuaXNDYW52YXNJbmRleE91dE9mUmFuZ2UgPSBmdW5jdGlvbiAoY2FudmFzSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGNhbnZhc0luZGV4ID4gdGhpcy5nZXRUb3RhbENhbnZhc2VzKCkgLSAxO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmlzRmlyc3RDYW52YXMgPSBmdW5jdGlvbiAoY2FudmFzSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGNhbnZhc0luZGV4ID09PSAwO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmlzTGFzdENhbnZhcyA9IGZ1bmN0aW9uIChjYW52YXNJbmRleCkge1xuICAgICAgICByZXR1cm4gY2FudmFzSW5kZXggPT09IHRoaXMuZ2V0VG90YWxDYW52YXNlcygpIC0gMTtcbiAgICB9O1xuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5pc011bHRpQ2FudmFzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUb3RhbENhbnZhc2VzKCkgPiAxO1xuICAgIH07XG4gICAgU2VxdWVuY2UucHJvdG90eXBlLmlzUGFnaW5nRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXdpbmdIaW50ID0gdGhpcy5nZXRWaWV3aW5nSGludCgpO1xuICAgICAgICBpZiAodmlld2luZ0hpbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3aW5nSGludCA9PT0gVmlld2luZ0hpbnQuUEFHRUQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLy8gY2hlY2tzIGlmIHRoZSBudW1iZXIgb2YgY2FudmFzZXMgaXMgZXZlbiAtIHRoZXJlZm9yZSBoYXMgYSBmcm9udCBhbmQgYmFjayBjb3ZlclxuICAgIFNlcXVlbmNlLnByb3RvdHlwZS5pc1RvdGFsQ2FudmFzZXNFdmVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUb3RhbENhbnZhc2VzKCkgJSAyID09PSAwO1xuICAgIH07XG4gICAgcmV0dXJuIFNlcXVlbmNlO1xufShNYW5pZmVzdFJlc291cmNlKSk7XG5leHBvcnQgeyBTZXF1ZW5jZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VxdWVuY2UuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Sequence.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Serialisation.js":
/*!******************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Serialisation.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Deserialiser: () => (/* binding */ Deserialiser)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n\nvar Deserialiser = /** @class */ (function () {\n    function Deserialiser() {\n    }\n    Deserialiser.parse = function (manifest, options) {\n        if (typeof manifest === \"string\") {\n            manifest = JSON.parse(manifest);\n        }\n        return this.parseJson(manifest, options);\n    };\n    Deserialiser.parseJson = function (json, options) {\n        var resource;\n        // have options been passed for the manifest to inherit?\n        if (options) {\n            if (options.navDate && !isNaN(options.navDate.getTime())) {\n                json.navDate = options.navDate.toString();\n            }\n        }\n        if (json[\"@type\"]) {\n            switch (json[\"@type\"]) {\n                case \"sc:Collection\":\n                    resource = this.parseCollection(json, options);\n                    break;\n                case \"sc:Manifest\":\n                    resource = this.parseManifest(json, options);\n                    break;\n                default:\n                    return null;\n            }\n        }\n        else {\n            // presentation 3\n            switch (json[\"type\"]) {\n                case \"Collection\":\n                    resource = this.parseCollection(json, options);\n                    break;\n                case \"Manifest\":\n                    resource = this.parseManifest(json, options);\n                    break;\n                default:\n                    return null;\n            }\n        }\n        // Top-level resource was loaded from a URI, so flag it to prevent\n        // unnecessary reload:\n        resource.isLoaded = true;\n        return resource;\n    };\n    Deserialiser.parseCollection = function (json, options) {\n        var collection = new _internal__WEBPACK_IMPORTED_MODULE_0__.Collection(json, options);\n        if (options) {\n            collection.index = options.index || 0;\n            if (options.resource) {\n                collection.parentCollection = options.resource.parentCollection;\n            }\n        }\n        else {\n            collection.index = 0;\n        }\n        this.parseCollections(collection, options);\n        this.parseManifests(collection, options);\n        this.parseItems(collection, options);\n        return collection;\n    };\n    Deserialiser.parseCollections = function (collection, options) {\n        var items;\n        if (collection.__jsonld.collections) {\n            items = collection.__jsonld.collections;\n        }\n        else if (collection.__jsonld.items) {\n            items = collection.__jsonld.items.filter(function (m) { return m.type.toLowerCase() === \"collection\"; });\n        }\n        if (items) {\n            for (var i = 0; i < items.length; i++) {\n                if (options) {\n                    options.index = i;\n                }\n                var item = this.parseCollection(items[i], options);\n                item.index = i;\n                item.parentCollection = collection;\n                collection.items.push(item);\n            }\n        }\n    };\n    Deserialiser.parseManifest = function (json, options) {\n        var manifest = new _internal__WEBPACK_IMPORTED_MODULE_0__.Manifest(json, options);\n        return manifest;\n    };\n    Deserialiser.parseManifests = function (collection, options) {\n        var items;\n        if (collection.__jsonld.manifests) {\n            items = collection.__jsonld.manifests;\n        }\n        else if (collection.__jsonld.items) {\n            items = collection.__jsonld.items.filter(function (m) { return m.type.toLowerCase() === \"manifest\"; });\n        }\n        if (items) {\n            for (var i = 0; i < items.length; i++) {\n                var item = this.parseManifest(items[i], options);\n                item.index = i;\n                item.parentCollection = collection;\n                collection.items.push(item);\n            }\n        }\n    };\n    Deserialiser.parseItem = function (json, options) {\n        if (json[\"@type\"]) {\n            if (json[\"@type\"].toLowerCase() === \"sc:manifest\") {\n                return this.parseManifest(json, options);\n            }\n            else if (json[\"@type\"].toLowerCase() === \"sc:collection\") {\n                return this.parseCollection(json, options);\n            }\n        }\n        else if (json.type) {\n            if (json.type.toLowerCase() === \"manifest\") {\n                return this.parseManifest(json, options);\n            }\n            else if (json.type.toLowerCase() === \"collection\") {\n                return this.parseCollection(json, options);\n            }\n        }\n        return null;\n    };\n    Deserialiser.parseItems = function (collection, options) {\n        var items = collection.__jsonld.members || collection.__jsonld.items;\n        if (items) {\n            var _loop_1 = function (i) {\n                if (options) {\n                    options.index = i;\n                }\n                var item = this_1.parseItem(items[i], options);\n                if (!item)\n                    return { value: void 0 };\n                // only add to items if not already parsed from backwards-compatible collections/manifests arrays\n                if (collection.items.filter(function (m) { return m.id === item.id; })[0]) {\n                    return \"continue\";\n                }\n                item.index = i;\n                item.parentCollection = collection;\n                collection.items.push(item);\n            };\n            var this_1 = this;\n            for (var i = 0; i < items.length; i++) {\n                var state_1 = _loop_1(i);\n                if (typeof state_1 === \"object\")\n                    return state_1.value;\n            }\n        }\n    };\n    return Deserialiser;\n}());\n\n//# sourceMappingURL=Serialisation.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2VyaWFsaXNhdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFrRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsaURBQVU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSwrQ0FBK0M7QUFDbkg7QUFDQTtBQUNBLDRCQUE0QixrQkFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwrQ0FBUTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLDZDQUE2QztBQUNqSDtBQUNBO0FBQ0EsNEJBQTRCLGtCQUFrQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0EsMkRBQTJELDBCQUEwQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixrQkFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3VCO0FBQ3hCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2VyaWFsaXNhdGlvbi5qcz9kYzc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbGxlY3Rpb24sIE1hbmlmZXN0IH0gZnJvbSBcIi4vaW50ZXJuYWxcIjtcbnZhciBEZXNlcmlhbGlzZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVzZXJpYWxpc2VyKCkge1xuICAgIH1cbiAgICBEZXNlcmlhbGlzZXIucGFyc2UgPSBmdW5jdGlvbiAobWFuaWZlc3QsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBtYW5pZmVzdCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgbWFuaWZlc3QgPSBKU09OLnBhcnNlKG1hbmlmZXN0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUpzb24obWFuaWZlc3QsIG9wdGlvbnMpO1xuICAgIH07XG4gICAgRGVzZXJpYWxpc2VyLnBhcnNlSnNvbiA9IGZ1bmN0aW9uIChqc29uLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciByZXNvdXJjZTtcbiAgICAgICAgLy8gaGF2ZSBvcHRpb25zIGJlZW4gcGFzc2VkIGZvciB0aGUgbWFuaWZlc3QgdG8gaW5oZXJpdD9cbiAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLm5hdkRhdGUgJiYgIWlzTmFOKG9wdGlvbnMubmF2RGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICAgICAgICAgICAganNvbi5uYXZEYXRlID0gb3B0aW9ucy5uYXZEYXRlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpzb25bXCJAdHlwZVwiXSkge1xuICAgICAgICAgICAgc3dpdGNoIChqc29uW1wiQHR5cGVcIl0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic2M6Q29sbGVjdGlvblwiOlxuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZSA9IHRoaXMucGFyc2VDb2xsZWN0aW9uKGpzb24sIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwic2M6TWFuaWZlc3RcIjpcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UgPSB0aGlzLnBhcnNlTWFuaWZlc3QoanNvbiwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gcHJlc2VudGF0aW9uIDNcbiAgICAgICAgICAgIHN3aXRjaCAoanNvbltcInR5cGVcIl0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiQ29sbGVjdGlvblwiOlxuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZSA9IHRoaXMucGFyc2VDb2xsZWN0aW9uKGpzb24sIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiTWFuaWZlc3RcIjpcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UgPSB0aGlzLnBhcnNlTWFuaWZlc3QoanNvbiwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFRvcC1sZXZlbCByZXNvdXJjZSB3YXMgbG9hZGVkIGZyb20gYSBVUkksIHNvIGZsYWcgaXQgdG8gcHJldmVudFxuICAgICAgICAvLyB1bm5lY2Vzc2FyeSByZWxvYWQ6XG4gICAgICAgIHJlc291cmNlLmlzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHJlc291cmNlO1xuICAgIH07XG4gICAgRGVzZXJpYWxpc2VyLnBhcnNlQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChqc29uLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IENvbGxlY3Rpb24oanNvbiwgb3B0aW9ucyk7XG4gICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLmluZGV4ID0gb3B0aW9ucy5pbmRleCB8fCAwO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMucmVzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnBhcmVudENvbGxlY3Rpb24gPSBvcHRpb25zLnJlc291cmNlLnBhcmVudENvbGxlY3Rpb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLmluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcnNlQ29sbGVjdGlvbnMoY29sbGVjdGlvbiwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMucGFyc2VNYW5pZmVzdHMoY29sbGVjdGlvbiwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMucGFyc2VJdGVtcyhjb2xsZWN0aW9uLCBvcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gICAgfTtcbiAgICBEZXNlcmlhbGlzZXIucGFyc2VDb2xsZWN0aW9ucyA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBpdGVtcztcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24uX19qc29ubGQuY29sbGVjdGlvbnMpIHtcbiAgICAgICAgICAgIGl0ZW1zID0gY29sbGVjdGlvbi5fX2pzb25sZC5jb2xsZWN0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2xsZWN0aW9uLl9fanNvbmxkLml0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcyA9IGNvbGxlY3Rpb24uX19qc29ubGQuaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJjb2xsZWN0aW9uXCI7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMucGFyc2VDb2xsZWN0aW9uKGl0ZW1zW2ldLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBpdGVtLnBhcmVudENvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRGVzZXJpYWxpc2VyLnBhcnNlTWFuaWZlc3QgPSBmdW5jdGlvbiAoanNvbiwgb3B0aW9ucykge1xuICAgICAgICB2YXIgbWFuaWZlc3QgPSBuZXcgTWFuaWZlc3QoanNvbiwgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiBtYW5pZmVzdDtcbiAgICB9O1xuICAgIERlc2VyaWFsaXNlci5wYXJzZU1hbmlmZXN0cyA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBpdGVtcztcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24uX19qc29ubGQubWFuaWZlc3RzKSB7XG4gICAgICAgICAgICBpdGVtcyA9IGNvbGxlY3Rpb24uX19qc29ubGQubWFuaWZlc3RzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbGxlY3Rpb24uX19qc29ubGQuaXRlbXMpIHtcbiAgICAgICAgICAgIGl0ZW1zID0gY29sbGVjdGlvbi5fX2pzb25sZC5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0udHlwZS50b0xvd2VyQ2FzZSgpID09PSBcIm1hbmlmZXN0XCI7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5wYXJzZU1hbmlmZXN0KGl0ZW1zW2ldLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBpdGVtLnBhcmVudENvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRGVzZXJpYWxpc2VyLnBhcnNlSXRlbSA9IGZ1bmN0aW9uIChqc29uLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChqc29uW1wiQHR5cGVcIl0pIHtcbiAgICAgICAgICAgIGlmIChqc29uW1wiQHR5cGVcIl0udG9Mb3dlckNhc2UoKSA9PT0gXCJzYzptYW5pZmVzdFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VNYW5pZmVzdChqc29uLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGpzb25bXCJAdHlwZVwiXS50b0xvd2VyQ2FzZSgpID09PSBcInNjOmNvbGxlY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlQ29sbGVjdGlvbihqc29uLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChqc29uLnR5cGUpIHtcbiAgICAgICAgICAgIGlmIChqc29uLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJtYW5pZmVzdFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VNYW5pZmVzdChqc29uLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGpzb24udHlwZS50b0xvd2VyQ2FzZSgpID09PSBcImNvbGxlY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlQ29sbGVjdGlvbihqc29uLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIERlc2VyaWFsaXNlci5wYXJzZUl0ZW1zID0gZnVuY3Rpb24gKGNvbGxlY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gY29sbGVjdGlvbi5fX2pzb25sZC5tZW1iZXJzIHx8IGNvbGxlY3Rpb24uX19qc29ubGQuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXNfMS5wYXJzZUl0ZW0oaXRlbXNbaV0sIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGlmICghaXRlbSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHZvaWQgMCB9O1xuICAgICAgICAgICAgICAgIC8vIG9ubHkgYWRkIHRvIGl0ZW1zIGlmIG5vdCBhbHJlYWR5IHBhcnNlZCBmcm9tIGJhY2t3YXJkcy1jb21wYXRpYmxlIGNvbGxlY3Rpb25zL21hbmlmZXN0cyBhcnJheXNcbiAgICAgICAgICAgICAgICBpZiAoY29sbGVjdGlvbi5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0uaWQgPT09IGl0ZW0uaWQ7IH0pWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIGl0ZW0ucGFyZW50Q29sbGVjdGlvbiA9IGNvbGxlY3Rpb247XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciB0aGlzXzEgPSB0aGlzO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZV8xID0gX2xvb3BfMShpKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZV8xLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gRGVzZXJpYWxpc2VyO1xufSgpKTtcbmV4cG9ydCB7IERlc2VyaWFsaXNlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VyaWFsaXNhdGlvbi5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Serialisation.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Service.js":
/*!************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Service.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Service: () => (/* binding */ Service)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar Service = /** @class */ (function (_super) {\n    __extends(Service, _super);\n    function Service(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    Service.prototype.getProfile = function () {\n        var profile = this.getProperty(\"profile\");\n        if (!profile) {\n            profile = this.getProperty(\"dcterms:conformsTo\");\n        }\n        if (Array.isArray(profile)) {\n            return profile[0];\n        }\n        return profile;\n    };\n    Service.prototype.getConfirmLabel = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"confirmLabel\"), this.options.locale);\n    };\n    Service.prototype.getDescription = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"description\"), this.options.locale);\n    };\n    Service.prototype.getFailureDescription = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"failureDescription\"), this.options.locale);\n    };\n    Service.prototype.getFailureHeader = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"failureHeader\"), this.options.locale);\n    };\n    Service.prototype.getHeader = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"header\"), this.options.locale);\n    };\n    Service.prototype.getServiceLabel = function () {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.getLocalisedValue(this.getProperty(\"label\"), this.options.locale);\n    };\n    Service.prototype.getInfoUri = function () {\n        var infoUri = this.id;\n        if (!infoUri.endsWith(\"/\")) {\n            infoUri += \"/\";\n        }\n        infoUri += \"info.json\";\n        return infoUri;\n    };\n    return Service;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource));\n\n//# sourceMappingURL=Service.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2VydmljZS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDb0Q7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQSxlQUFlLDRDQUFLO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLHVEQUFnQjtBQUNDO0FBQ25CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2VydmljZS5qcz80MDBjIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgTWFuaWZlc3RSZXNvdXJjZSwgVXRpbHMgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIFNlcnZpY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlcnZpY2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VydmljZShqc29ubGQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCwgb3B0aW9ucykgfHwgdGhpcztcbiAgICB9XG4gICAgU2VydmljZS5wcm90b3R5cGUuZ2V0UHJvZmlsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHByb2ZpbGUgPSB0aGlzLmdldFByb3BlcnR5KFwicHJvZmlsZVwiKTtcbiAgICAgICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICAgICAgICBwcm9maWxlID0gdGhpcy5nZXRQcm9wZXJ0eShcImRjdGVybXM6Y29uZm9ybXNUb1wiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9maWxlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVbMF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGU7XG4gICAgfTtcbiAgICBTZXJ2aWNlLnByb3RvdHlwZS5nZXRDb25maXJtTGFiZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5nZXRMb2NhbGlzZWRWYWx1ZSh0aGlzLmdldFByb3BlcnR5KFwiY29uZmlybUxhYmVsXCIpLCB0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICB9O1xuICAgIFNlcnZpY2UucHJvdG90eXBlLmdldERlc2NyaXB0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVXRpbHMuZ2V0TG9jYWxpc2VkVmFsdWUodGhpcy5nZXRQcm9wZXJ0eShcImRlc2NyaXB0aW9uXCIpLCB0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICB9O1xuICAgIFNlcnZpY2UucHJvdG90eXBlLmdldEZhaWx1cmVEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFV0aWxzLmdldExvY2FsaXNlZFZhbHVlKHRoaXMuZ2V0UHJvcGVydHkoXCJmYWlsdXJlRGVzY3JpcHRpb25cIiksIHRoaXMub3B0aW9ucy5sb2NhbGUpO1xuICAgIH07XG4gICAgU2VydmljZS5wcm90b3R5cGUuZ2V0RmFpbHVyZUhlYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFV0aWxzLmdldExvY2FsaXNlZFZhbHVlKHRoaXMuZ2V0UHJvcGVydHkoXCJmYWlsdXJlSGVhZGVyXCIpLCB0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICB9O1xuICAgIFNlcnZpY2UucHJvdG90eXBlLmdldEhlYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFV0aWxzLmdldExvY2FsaXNlZFZhbHVlKHRoaXMuZ2V0UHJvcGVydHkoXCJoZWFkZXJcIiksIHRoaXMub3B0aW9ucy5sb2NhbGUpO1xuICAgIH07XG4gICAgU2VydmljZS5wcm90b3R5cGUuZ2V0U2VydmljZUxhYmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVXRpbHMuZ2V0TG9jYWxpc2VkVmFsdWUodGhpcy5nZXRQcm9wZXJ0eShcImxhYmVsXCIpLCB0aGlzLm9wdGlvbnMubG9jYWxlKTtcbiAgICB9O1xuICAgIFNlcnZpY2UucHJvdG90eXBlLmdldEluZm9VcmkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbmZvVXJpID0gdGhpcy5pZDtcbiAgICAgICAgaWYgKCFpbmZvVXJpLmVuZHNXaXRoKFwiL1wiKSkge1xuICAgICAgICAgICAgaW5mb1VyaSArPSBcIi9cIjtcbiAgICAgICAgfVxuICAgICAgICBpbmZvVXJpICs9IFwiaW5mby5qc29uXCI7XG4gICAgICAgIHJldHVybiBpbmZvVXJpO1xuICAgIH07XG4gICAgcmV0dXJuIFNlcnZpY2U7XG59KE1hbmlmZXN0UmVzb3VyY2UpKTtcbmV4cG9ydCB7IFNlcnZpY2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNlcnZpY2UuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Service.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Size.js":
/*!*********************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Size.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Size: () => (/* binding */ Size)\n/* harmony export */ });\nvar Size = /** @class */ (function () {\n    function Size(width, height) {\n        this.width = width;\n        this.height = height;\n    }\n    return Size;\n}());\n\n//# sourceMappingURL=Size.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2l6ZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNlO0FBQ2hCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU2l6ZS5qcz8xMTI3Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBTaXplID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNpemUod2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICByZXR1cm4gU2l6ZTtcbn0oKSk7XG5leHBvcnQgeyBTaXplIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1TaXplLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Size.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/StatusCode.js":
/*!***************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/StatusCode.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StatusCode: () => (/* binding */ StatusCode)\n/* harmony export */ });\nvar StatusCode;\n(function (StatusCode) {\n    StatusCode[StatusCode[\"AUTHORIZATION_FAILED\"] = 1] = \"AUTHORIZATION_FAILED\";\n    StatusCode[StatusCode[\"FORBIDDEN\"] = 2] = \"FORBIDDEN\";\n    StatusCode[StatusCode[\"INTERNAL_SERVER_ERROR\"] = 3] = \"INTERNAL_SERVER_ERROR\";\n    StatusCode[StatusCode[\"RESTRICTED\"] = 4] = \"RESTRICTED\";\n})(StatusCode || (StatusCode = {}));\n//# sourceMappingURL=StatusCode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvU3RhdHVzQ29kZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQ0FBZ0M7QUFDakMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9TdGF0dXNDb2RlLmpzP2RjMmMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHZhciBTdGF0dXNDb2RlO1xuKGZ1bmN0aW9uIChTdGF0dXNDb2RlKSB7XG4gICAgU3RhdHVzQ29kZVtTdGF0dXNDb2RlW1wiQVVUSE9SSVpBVElPTl9GQUlMRURcIl0gPSAxXSA9IFwiQVVUSE9SSVpBVElPTl9GQUlMRURcIjtcbiAgICBTdGF0dXNDb2RlW1N0YXR1c0NvZGVbXCJGT1JCSURERU5cIl0gPSAyXSA9IFwiRk9SQklEREVOXCI7XG4gICAgU3RhdHVzQ29kZVtTdGF0dXNDb2RlW1wiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCJdID0gM10gPSBcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiO1xuICAgIFN0YXR1c0NvZGVbU3RhdHVzQ29kZVtcIlJFU1RSSUNURURcIl0gPSA0XSA9IFwiUkVTVFJJQ1RFRFwiO1xufSkoU3RhdHVzQ29kZSB8fCAoU3RhdHVzQ29kZSA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1TdGF0dXNDb2RlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/StatusCode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Thumb.js":
/*!**********************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Thumb.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Thumb: () => (/* binding */ Thumb)\n/* harmony export */ });\n// todo: deprecate\n// this is used by Sequence.getThumbs\nvar Thumb = /** @class */ (function () {\n    function Thumb(width, canvas) {\n        this.data = canvas;\n        this.index = canvas.index;\n        this.width = width;\n        var heightRatio = canvas.getHeight() / canvas.getWidth();\n        if (heightRatio) {\n            this.height = Math.floor(this.width * heightRatio);\n        }\n        else {\n            this.height = width;\n        }\n        this.uri = canvas.getCanonicalImageUri(width);\n        this.label = canvas.getLabel().getValue(); // todo: pass locale?\n        this.viewingHint = canvas.getViewingHint();\n    }\n    return Thumb;\n}());\n\n//# sourceMappingURL=Thumb.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVGh1bWIuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRDtBQUNuRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2dCO0FBQ2pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVGh1bWIuanM/MWIxNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0b2RvOiBkZXByZWNhdGVcbi8vIHRoaXMgaXMgdXNlZCBieSBTZXF1ZW5jZS5nZXRUaHVtYnNcbnZhciBUaHVtYiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUaHVtYih3aWR0aCwgY2FudmFzKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IGNhbnZhcztcbiAgICAgICAgdGhpcy5pbmRleCA9IGNhbnZhcy5pbmRleDtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB2YXIgaGVpZ2h0UmF0aW8gPSBjYW52YXMuZ2V0SGVpZ2h0KCkgLyBjYW52YXMuZ2V0V2lkdGgoKTtcbiAgICAgICAgaWYgKGhlaWdodFJhdGlvKSB7XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IE1hdGguZmxvb3IodGhpcy53aWR0aCAqIGhlaWdodFJhdGlvKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gd2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cmkgPSBjYW52YXMuZ2V0Q2Fub25pY2FsSW1hZ2VVcmkod2lkdGgpO1xuICAgICAgICB0aGlzLmxhYmVsID0gY2FudmFzLmdldExhYmVsKCkuZ2V0VmFsdWUoKTsgLy8gdG9kbzogcGFzcyBsb2NhbGU/XG4gICAgICAgIHRoaXMudmlld2luZ0hpbnQgPSBjYW52YXMuZ2V0Vmlld2luZ0hpbnQoKTtcbiAgICB9XG4gICAgcmV0dXJuIFRodW1iO1xufSgpKTtcbmV4cG9ydCB7IFRodW1iIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1UaHVtYi5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Thumb.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Thumbnail.js":
/*!**************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Thumbnail.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Thumbnail: () => (/* binding */ Thumbnail)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar Thumbnail = /** @class */ (function (_super) {\n    __extends(Thumbnail, _super);\n    function Thumbnail(jsonld, options) {\n        return _super.call(this, jsonld, options) || this;\n    }\n    return Thumbnail;\n}(_internal__WEBPACK_IMPORTED_MODULE_0__.Resource));\n\n//# sourceMappingURL=Thumbnail.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVGh1bWJuYWlsLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNxQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0NBQVE7QUFDVztBQUNyQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0Ly4vbm9kZV9tb2R1bGVzL21hbmlmZXN0by5qcy9kaXN0LWVzbW9kdWxlL1RodW1ibmFpbC5qcz83OTAyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgUmVzb3VyY2UgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIFRodW1ibmFpbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGh1bWJuYWlsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRodW1ibmFpbChqc29ubGQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGpzb25sZCwgb3B0aW9ucykgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFRodW1ibmFpbDtcbn0oUmVzb3VyY2UpKTtcbmV4cG9ydCB7IFRodW1ibmFpbCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VGh1bWJuYWlsLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Thumbnail.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/TreeNode.js":
/*!*************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/TreeNode.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TreeNode: () => (/* binding */ TreeNode)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n\nvar TreeNode = /** @class */ (function () {\n    function TreeNode(label, data) {\n        this.label = label;\n        this.data = data || {};\n        this.nodes = [];\n    }\n    TreeNode.prototype.addNode = function (node) {\n        this.nodes.push(node);\n        node.parentNode = this;\n    };\n    TreeNode.prototype.isCollection = function () {\n        return this.data.type === _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_0__.TreeNodeType.COLLECTION);\n    };\n    TreeNode.prototype.isManifest = function () {\n        return this.data.type === _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_0__.TreeNodeType.MANIFEST);\n    };\n    TreeNode.prototype.isRange = function () {\n        return this.data.type === _internal__WEBPACK_IMPORTED_MODULE_0__.Utils.normaliseType(_internal__WEBPACK_IMPORTED_MODULE_0__.TreeNodeType.RANGE);\n    };\n    return TreeNode;\n}());\n\n//# sourceMappingURL=TreeNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVHJlZU5vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBaUQ7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw0Q0FBSyxlQUFlLG1EQUFZO0FBQ2xFO0FBQ0E7QUFDQSxrQ0FBa0MsNENBQUssZUFBZSxtREFBWTtBQUNsRTtBQUNBO0FBQ0Esa0NBQWtDLDRDQUFLLGVBQWUsbURBQVk7QUFDbEU7QUFDQTtBQUNBLENBQUM7QUFDbUI7QUFDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9UcmVlTm9kZS5qcz8xZWFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRyZWVOb2RlVHlwZSwgVXRpbHMgfSBmcm9tIFwiLi9pbnRlcm5hbFwiO1xudmFyIFRyZWVOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRyZWVOb2RlKGxhYmVsLCBkYXRhKSB7XG4gICAgICAgIHRoaXMubGFiZWwgPSBsYWJlbDtcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YSB8fCB7fTtcbiAgICAgICAgdGhpcy5ub2RlcyA9IFtdO1xuICAgIH1cbiAgICBUcmVlTm9kZS5wcm90b3R5cGUuYWRkTm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHRoaXMubm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgbm9kZS5wYXJlbnROb2RlID0gdGhpcztcbiAgICB9O1xuICAgIFRyZWVOb2RlLnByb3RvdHlwZS5pc0NvbGxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEudHlwZSA9PT0gVXRpbHMubm9ybWFsaXNlVHlwZShUcmVlTm9kZVR5cGUuQ09MTEVDVElPTik7XG4gICAgfTtcbiAgICBUcmVlTm9kZS5wcm90b3R5cGUuaXNNYW5pZmVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS50eXBlID09PSBVdGlscy5ub3JtYWxpc2VUeXBlKFRyZWVOb2RlVHlwZS5NQU5JRkVTVCk7XG4gICAgfTtcbiAgICBUcmVlTm9kZS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS50eXBlID09PSBVdGlscy5ub3JtYWxpc2VUeXBlKFRyZWVOb2RlVHlwZS5SQU5HRSk7XG4gICAgfTtcbiAgICByZXR1cm4gVHJlZU5vZGU7XG59KCkpO1xuZXhwb3J0IHsgVHJlZU5vZGUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyZWVOb2RlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/TreeNode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/TreeNodeType.js":
/*!*****************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/TreeNodeType.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TreeNodeType: () => (/* binding */ TreeNodeType)\n/* harmony export */ });\nvar TreeNodeType;\n(function (TreeNodeType) {\n    TreeNodeType[\"COLLECTION\"] = \"collection\";\n    TreeNodeType[\"MANIFEST\"] = \"manifest\";\n    TreeNodeType[\"RANGE\"] = \"range\";\n})(TreeNodeType || (TreeNodeType = {}));\n//# sourceMappingURL=TreeNodeType.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVHJlZU5vZGVUeXBlLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxvQ0FBb0M7QUFDckMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9UcmVlTm9kZVR5cGUuanM/NTBhYyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIFRyZWVOb2RlVHlwZTtcbihmdW5jdGlvbiAoVHJlZU5vZGVUeXBlKSB7XG4gICAgVHJlZU5vZGVUeXBlW1wiQ09MTEVDVElPTlwiXSA9IFwiY29sbGVjdGlvblwiO1xuICAgIFRyZWVOb2RlVHlwZVtcIk1BTklGRVNUXCJdID0gXCJtYW5pZmVzdFwiO1xuICAgIFRyZWVOb2RlVHlwZVtcIlJBTkdFXCJdID0gXCJyYW5nZVwiO1xufSkoVHJlZU5vZGVUeXBlIHx8IChUcmVlTm9kZVR5cGUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJlZU5vZGVUeXBlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/TreeNodeType.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/Utils.js":
/*!**********************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/Utils.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Utils: () => (/* binding */ Utils)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n/* harmony import */ var _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @iiif/vocabulary/dist-commonjs */ \"(ssr)/./node_modules/@iiif/vocabulary/dist-commonjs/index.js\");\n/* harmony import */ var _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @edsilv/http-status-codes/dist-commonjs */ \"(ssr)/./node_modules/@edsilv/http-status-codes/dist-commonjs/index.js\");\n/* harmony import */ var isomorphic_unfetch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! isomorphic-unfetch */ \"(ssr)/./node_modules/isomorphic-unfetch/index.js\");\n/* harmony import */ var isomorphic_unfetch__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(isomorphic_unfetch__WEBPACK_IMPORTED_MODULE_3__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n\n\nvar Utils = /** @class */ (function () {\n    function Utils() {\n    }\n    Utils.getMediaType = function (type) {\n        type = type.toLowerCase();\n        type = type.split(\";\")[0];\n        return type.trim();\n    };\n    Utils.getImageQuality = function (profile) {\n        if (profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_1 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_2 ||\n            profile === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2) {\n            return \"native\";\n        }\n        return \"default\";\n    };\n    Utils.getInexactLocale = function (locale) {\n        if (locale.indexOf(\"-\") !== -1) {\n            return locale.substr(0, locale.indexOf(\"-\"));\n        }\n        return locale;\n    };\n    Utils.getLocalisedValue = function (resource, locale) {\n        // if the resource is not an array of translations, return the string.\n        if (!Array.isArray(resource)) {\n            return resource;\n        }\n        // test for exact match\n        for (var i = 0; i < resource.length; i++) {\n            var value_1 = resource[i];\n            var language_1 = value_1[\"@language\"];\n            if (locale === language_1) {\n                return value_1[\"@value\"];\n            }\n        }\n        // test for inexact match\n        var match = locale.substr(0, locale.indexOf(\"-\"));\n        for (var i = 0; i < resource.length; i++) {\n            var value = resource[i];\n            var language = value[\"@language\"];\n            if (language === match) {\n                return value[\"@value\"];\n            }\n        }\n        return null;\n    };\n    Utils.generateTreeNodeIds = function (treeNode, index) {\n        if (index === void 0) { index = 0; }\n        var id;\n        if (!treeNode.parentNode) {\n            id = \"0\";\n        }\n        else {\n            id = treeNode.parentNode.id + \"-\" + index;\n        }\n        treeNode.id = id;\n        for (var i = 0; i < treeNode.nodes.length; i++) {\n            var n = treeNode.nodes[i];\n            Utils.generateTreeNodeIds(n, i);\n        }\n    };\n    Utils.normaliseType = function (type) {\n        type = (type || \"\").toLowerCase();\n        if (type.indexOf(\":\") !== -1) {\n            var split = type.split(\":\");\n            return split[1];\n        }\n        return type;\n    };\n    Utils.normaliseUrl = function (url) {\n        url = url.substr(url.indexOf(\"://\"));\n        if (url.indexOf(\"#\") !== -1) {\n            url = url.split(\"#\")[0];\n        }\n        return url;\n    };\n    Utils.normalisedUrlsMatch = function (url1, url2) {\n        return Utils.normaliseUrl(url1) === Utils.normaliseUrl(url2);\n    };\n    Utils.isImageProfile = function (profile) {\n        if (Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2)) {\n            return true;\n        }\n        return false;\n    };\n    Utils.isImageServiceType = function (type) {\n        return ((type !== null &&\n            type.toLowerCase() === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceType.IMAGE_SERVICE_2.toLowerCase()) ||\n            type === _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceType.IMAGE_SERVICE_3.toLowerCase());\n    };\n    Utils.isLevel0ImageProfile = function (profile) {\n        if (Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_LEVEL_0) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)) {\n            return true;\n        }\n        return false;\n    };\n    Utils.isLevel1ImageProfile = function (profile) {\n        if (Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_LEVEL_1) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)) {\n            return true;\n        }\n        return false;\n    };\n    Utils.isLevel2ImageProfile = function (profile) {\n        if (Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_LEVEL_2) ||\n            Utils.normalisedUrlsMatch(profile, _iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2)) {\n            return true;\n        }\n        return false;\n    };\n    Utils.parseManifest = function (manifest, options) {\n        return _internal__WEBPACK_IMPORTED_MODULE_0__.Deserialiser.parse(manifest, options);\n    };\n    Utils.checkStatus = function (response) {\n        if (response.ok) {\n            return response;\n        }\n        else {\n            var error = new Error(response.statusText);\n            error.response = response;\n            return Promise.reject(error);\n        }\n    };\n    Utils.loadManifest = function (url) {\n        return new Promise(function (resolve, reject) {\n            fetch(url)\n                .then(Utils.checkStatus)\n                .then(function (r) { return r.json(); })\n                .then(function (data) {\n                resolve(data);\n            })\n                .catch(function (err) {\n                reject();\n            });\n        });\n    };\n    Utils.loadExternalResourcesAuth1 = function (resources, openContentProviderInteraction, openTokenService, getStoredAccessToken, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages) {\n        return new Promise(function (resolve, reject) {\n            var promises = resources.map(function (resource) {\n                return Utils.loadExternalResourceAuth1(resource, openContentProviderInteraction, openTokenService, getStoredAccessToken, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages);\n            });\n            Promise.all(promises)\n                .then(function () {\n                resolve(resources);\n            })[\"catch\"](function (error) {\n                reject(error);\n            });\n        });\n    };\n    Utils.loadExternalResourceAuth1 = function (resource, openContentProviderInteraction, openTokenService, getStoredAccessToken, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages) {\n        return __awaiter(this, void 0, void 0, function () {\n            var storedAccessToken;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, getStoredAccessToken(resource)];\n                    case 1:\n                        storedAccessToken = _a.sent();\n                        if (!storedAccessToken) return [3 /*break*/, 6];\n                        return [4 /*yield*/, resource.getData(storedAccessToken)];\n                    case 2:\n                        _a.sent();\n                        if (!(resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.OK)) return [3 /*break*/, 3];\n                        return [2 /*return*/, resource];\n                    case 3: \n                    // the stored token is no good for this resource\n                    return [4 /*yield*/, Utils.doAuthChain(resource, openContentProviderInteraction, openTokenService, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages)];\n                    case 4:\n                        // the stored token is no good for this resource\n                        _a.sent();\n                        _a.label = 5;\n                    case 5:\n                        if (resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.OK || resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.MOVED_TEMPORARILY) {\n                            return [2 /*return*/, resource];\n                        }\n                        throw Utils.createAuthorizationFailedError();\n                    case 6: return [4 /*yield*/, resource.getData()];\n                    case 7:\n                        _a.sent();\n                        if (!(resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.MOVED_TEMPORARILY ||\n                            resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.UNAUTHORIZED)) return [3 /*break*/, 9];\n                        return [4 /*yield*/, Utils.doAuthChain(resource, openContentProviderInteraction, openTokenService, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages)];\n                    case 8:\n                        _a.sent();\n                        _a.label = 9;\n                    case 9:\n                        if (resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.OK || resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.MOVED_TEMPORARILY) {\n                            return [2 /*return*/, resource];\n                        }\n                        throw Utils.createAuthorizationFailedError();\n                }\n            });\n        });\n    };\n    Utils.doAuthChain = function (resource, openContentProviderInteraction, openTokenService, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages) {\n        return __awaiter(this, void 0, void 0, function () {\n            var externalService, kioskService, clickThroughService, loginService, serviceToTry, lastAttempted, kioskInteraction, contentProviderInteraction, contentProviderInteraction;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // This function enters the flowchart at the < External? > junction\n                        // http://iiif.io/api/auth/1.0/#workflow-from-the-browser-client-perspective\n                        if (!resource.isAccessControlled()) {\n                            return [2 /*return*/, resource]; // no services found\n                        }\n                        externalService = resource.externalService;\n                        if (externalService) {\n                            externalService.options = resource.options;\n                        }\n                        kioskService = resource.kioskService;\n                        if (kioskService) {\n                            kioskService.options = resource.options;\n                        }\n                        clickThroughService = resource.clickThroughService;\n                        if (clickThroughService) {\n                            clickThroughService.options = resource.options;\n                        }\n                        loginService = resource.loginService;\n                        if (loginService) {\n                            loginService.options = resource.options;\n                        }\n                        if (!(!resource.isResponseHandled && resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.MOVED_TEMPORARILY)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, handleMovedTemporarily(resource)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, resource];\n                    case 2:\n                        serviceToTry = null;\n                        lastAttempted = null;\n                        // repetition of logic is left in these steps for clarity:\n                        // Looking for external pattern\n                        serviceToTry = externalService;\n                        if (!serviceToTry) return [3 /*break*/, 4];\n                        lastAttempted = serviceToTry;\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\n                    case 3:\n                        _a.sent();\n                        return [2 /*return*/, resource];\n                    case 4:\n                        // Looking for kiosk pattern\n                        serviceToTry = kioskService;\n                        if (!serviceToTry) return [3 /*break*/, 7];\n                        lastAttempted = serviceToTry;\n                        kioskInteraction = openContentProviderInteraction(serviceToTry);\n                        if (!kioskInteraction) return [3 /*break*/, 7];\n                        return [4 /*yield*/, userInteractedWithContentProvider(kioskInteraction)];\n                    case 5:\n                        _a.sent();\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\n                    case 6:\n                        _a.sent();\n                        return [2 /*return*/, resource];\n                    case 7:\n                        // The code for the next two patterns is identical (other than the profile name).\n                        // The difference is in the expected behaviour of\n                        //\n                        //    await userInteractedWithContentProvider(contentProviderInteraction);\n                        //\n                        // For clickthrough the opened window should close immediately having established\n                        // a session, whereas for login the user might spend some time entering credentials etc.\n                        // Looking for clickthrough pattern\n                        serviceToTry = clickThroughService;\n                        if (!serviceToTry) return [3 /*break*/, 11];\n                        lastAttempted = serviceToTry;\n                        return [4 /*yield*/, getContentProviderInteraction(resource, serviceToTry)];\n                    case 8:\n                        contentProviderInteraction = _a.sent();\n                        if (!contentProviderInteraction) return [3 /*break*/, 11];\n                        // should close immediately\n                        return [4 /*yield*/, userInteractedWithContentProvider(contentProviderInteraction)];\n                    case 9:\n                        // should close immediately\n                        _a.sent();\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\n                    case 10:\n                        _a.sent();\n                        return [2 /*return*/, resource];\n                    case 11:\n                        // Looking for login pattern\n                        serviceToTry = loginService;\n                        if (!serviceToTry) return [3 /*break*/, 15];\n                        lastAttempted = serviceToTry;\n                        return [4 /*yield*/, getContentProviderInteraction(resource, serviceToTry)];\n                    case 12:\n                        contentProviderInteraction = _a.sent();\n                        if (!contentProviderInteraction) return [3 /*break*/, 15];\n                        // we expect the user to spend some time interacting\n                        return [4 /*yield*/, userInteractedWithContentProvider(contentProviderInteraction)];\n                    case 13:\n                        // we expect the user to spend some time interacting\n                        _a.sent();\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\n                    case 14:\n                        _a.sent();\n                        return [2 /*return*/, resource];\n                    case 15:\n                        // nothing worked! Use the most recently tried service as the source of\n                        // messages to show to the user.\n                        if (lastAttempted) {\n                            showOutOfOptionsMessages(resource, lastAttempted);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Utils.attemptResourceWithToken = function (resource, openTokenService, authService) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenService, tokenMessage;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tokenService = authService.getService(_iiif_vocabulary_dist_commonjs__WEBPACK_IMPORTED_MODULE_1__.ServiceProfile.AUTH_1_TOKEN);\n                        if (!tokenService) return [3 /*break*/, 3];\n                        return [4 /*yield*/, openTokenService(resource, tokenService)];\n                    case 1:\n                        tokenMessage = _a.sent();\n                        if (!(tokenMessage && tokenMessage.accessToken)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, resource.getData(tokenMessage)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/, resource];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Utils.loadExternalResourcesAuth09 = function (resources, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken, handleResourceResponse, options) {\n        return new Promise(function (resolve, reject) {\n            var promises = resources.map(function (resource) {\n                return Utils.loadExternalResourceAuth09(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken, handleResourceResponse, options);\n            });\n            Promise.all(promises)\n                .then(function () {\n                resolve(resources);\n            })[\"catch\"](function (error) {\n                reject(error);\n            });\n        });\n    };\n    // IIIF auth api pre v1.0\n    // Keeping this around for now until the auth 1.0 implementation is stable\n    Utils.loadExternalResourceAuth09 = function (resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken, handleResourceResponse, options) {\n        return new Promise(function (resolve, reject) {\n            if (options && options.pessimisticAccessControl) {\n                // pessimistic: access control cookies may have been deleted.\n                // always request the access token for every access controlled info.json request\n                // returned access tokens are not stored, therefore the login window flashes for every request.\n                resource\n                    .getData()\n                    .then(function () {\n                    if (resource.isAccessControlled()) {\n                        // if the resource has a click through service, use that.\n                        if (resource.clickThroughService) {\n                            resolve(clickThrough(resource));\n                            //} else if(resource.restrictedService) {\n                            resolve(restricted(resource));\n                        }\n                        else {\n                            login(resource)\n                                .then(function () {\n                                getAccessToken(resource, true)\n                                    .then(function (token) {\n                                    resource\n                                        .getData(token)\n                                        .then(function () {\n                                        resolve(handleResourceResponse(resource));\n                                    })[\"catch\"](function (message) {\n                                        reject(Utils.createInternalServerError(message));\n                                    });\n                                })[\"catch\"](function (message) {\n                                    reject(Utils.createInternalServerError(message));\n                                });\n                            })[\"catch\"](function (message) {\n                                reject(Utils.createInternalServerError(message));\n                            });\n                        }\n                    }\n                    else {\n                        // this info.json isn't access controlled, therefore no need to request an access token.\n                        resolve(resource);\n                    }\n                })[\"catch\"](function (message) {\n                    reject(Utils.createInternalServerError(message));\n                });\n            }\n            else {\n                // optimistic: access control cookies may not have been deleted.\n                // store access tokens to avoid login window flashes.\n                // if cookies are deleted a page refresh is required.\n                // try loading the resource using an access token that matches the info.json domain.\n                // if an access token is found, request the resource using it regardless of whether it is access controlled.\n                getStoredAccessToken(resource, tokenStorageStrategy)\n                    .then(function (storedAccessToken) {\n                    if (storedAccessToken) {\n                        // try using the stored access token\n                        resource\n                            .getData(storedAccessToken)\n                            .then(function () {\n                            // if the info.json loaded using the stored access token\n                            if (resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.OK) {\n                                resolve(handleResourceResponse(resource));\n                            }\n                            else {\n                                // otherwise, load the resource data to determine the correct access control services.\n                                // if access controlled, do login.\n                                Utils.authorize(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken)\n                                    .then(function () {\n                                    resolve(handleResourceResponse(resource));\n                                })[\"catch\"](function (error) {\n                                    // if (resource.restrictedService){\n                                    //     reject(Utils.createRestrictedError());\n                                    // } else {\n                                    reject(Utils.createAuthorizationFailedError());\n                                    //}\n                                });\n                            }\n                        })[\"catch\"](function (error) {\n                            reject(Utils.createAuthorizationFailedError());\n                        });\n                    }\n                    else {\n                        Utils.authorize(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken)\n                            .then(function () {\n                            resolve(handleResourceResponse(resource));\n                        })[\"catch\"](function (error) {\n                            reject(Utils.createAuthorizationFailedError());\n                        });\n                    }\n                })[\"catch\"](function (error) {\n                    reject(Utils.createAuthorizationFailedError());\n                });\n            }\n        });\n    };\n    Utils.createError = function (name, message) {\n        var error = new Error();\n        error.message = message;\n        error.name = String(name);\n        return error;\n    };\n    Utils.createAuthorizationFailedError = function () {\n        return Utils.createError(_internal__WEBPACK_IMPORTED_MODULE_0__.StatusCode.AUTHORIZATION_FAILED, \"Authorization failed\");\n    };\n    Utils.createRestrictedError = function () {\n        return Utils.createError(_internal__WEBPACK_IMPORTED_MODULE_0__.StatusCode.RESTRICTED, \"Restricted\");\n    };\n    Utils.createInternalServerError = function (message) {\n        return Utils.createError(_internal__WEBPACK_IMPORTED_MODULE_0__.StatusCode.INTERNAL_SERVER_ERROR, message);\n    };\n    Utils.authorize = function (resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken) {\n        return new Promise(function (resolve, reject) {\n            resource.getData().then(function () {\n                if (resource.isAccessControlled()) {\n                    getStoredAccessToken(resource, tokenStorageStrategy)\n                        .then(function (storedAccessToken) {\n                        if (storedAccessToken) {\n                            // try using the stored access token\n                            resource\n                                .getData(storedAccessToken)\n                                .then(function () {\n                                if (resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.OK) {\n                                    resolve(resource); // happy path ended\n                                }\n                                else {\n                                    // the stored token is no good for this resource\n                                    Utils.showAuthInteraction(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject);\n                                }\n                            })[\"catch\"](function (message) {\n                                reject(Utils.createInternalServerError(message));\n                            });\n                        }\n                        else {\n                            // There was no stored token, but the user might have a cookie that will grant a token\n                            getAccessToken(resource, false).then(function (accessToken) {\n                                if (accessToken) {\n                                    storeAccessToken(resource, accessToken, tokenStorageStrategy)\n                                        .then(function () {\n                                        // try using the fresh access token\n                                        resource\n                                            .getData(accessToken)\n                                            .then(function () {\n                                            if (resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.OK) {\n                                                resolve(resource);\n                                            }\n                                            else {\n                                                // User has a token, but it's not good enough\n                                                Utils.showAuthInteraction(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject);\n                                            }\n                                        })[\"catch\"](function (message) {\n                                            reject(Utils.createInternalServerError(message));\n                                        });\n                                    })[\"catch\"](function (message) {\n                                        // not able to store access token\n                                        reject(Utils.createInternalServerError(message));\n                                    });\n                                }\n                                else {\n                                    // The user did not have a cookie that granted a token\n                                    Utils.showAuthInteraction(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject);\n                                }\n                            });\n                        }\n                    })[\"catch\"](function (message) {\n                        reject(Utils.createInternalServerError(message));\n                    });\n                }\n                else {\n                    // this info.json isn't access controlled, therefore there's no need to request an access token\n                    resolve(resource);\n                }\n            });\n        });\n    };\n    Utils.showAuthInteraction = function (resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject) {\n        if (resource.status === _edsilv_http_status_codes_dist_commonjs__WEBPACK_IMPORTED_MODULE_2__.MOVED_TEMPORARILY && !resource.isResponseHandled) {\n            // if the resource was redirected to a degraded version\n            // and the response hasn't been handled yet.\n            // if the client wishes to trigger a login, set resource.isResponseHandled to true\n            // and call loadExternalResources() again passing the resource.\n            resolve(resource);\n            // } else if (resource.restrictedService) {\n            //     resolve(restricted(resource));\n            //     // TODO: move to next etc\n        }\n        else if (resource.clickThroughService && !resource.isResponseHandled) {\n            // if the resource has a click through service, use that.\n            clickThrough(resource).then(function () {\n                getAccessToken(resource, true)\n                    .then(function (accessToken) {\n                    storeAccessToken(resource, accessToken, tokenStorageStrategy)\n                        .then(function () {\n                        resource\n                            .getData(accessToken)\n                            .then(function () {\n                            resolve(resource);\n                        })[\"catch\"](function (message) {\n                            reject(Utils.createInternalServerError(message));\n                        });\n                    })[\"catch\"](function (message) {\n                        reject(Utils.createInternalServerError(message));\n                    });\n                })[\"catch\"](function (message) {\n                    reject(Utils.createInternalServerError(message));\n                });\n            });\n        }\n        else {\n            // get an access token\n            login(resource).then(function () {\n                getAccessToken(resource, true)\n                    .then(function (accessToken) {\n                    storeAccessToken(resource, accessToken, tokenStorageStrategy)\n                        .then(function () {\n                        resource\n                            .getData(accessToken)\n                            .then(function () {\n                            resolve(resource);\n                        })[\"catch\"](function (message) {\n                            reject(Utils.createInternalServerError(message));\n                        });\n                    })[\"catch\"](function (message) {\n                        reject(Utils.createInternalServerError(message));\n                    });\n                })[\"catch\"](function (message) {\n                    reject(Utils.createInternalServerError(message));\n                });\n            });\n        }\n    };\n    Utils.getService = function (resource, profile) {\n        var services = this.getServices(resource);\n        for (var i = 0; i < services.length; i++) {\n            var service = services[i];\n            if (service.getProfile() === profile) {\n                return service;\n            }\n        }\n        return null;\n    };\n    Utils.getResourceById = function (parentResource, id) {\n        return (Utils.traverseAndFind(parentResource.__jsonld, \"@id\", id));\n    };\n    /**\n     * Does a depth first traversal of an Object, returning an Object that\n     * matches provided k and v arguments\n     * @example Utils.traverseAndFind({foo: 'bar'}, 'foo', 'bar')\n     */\n    Utils.traverseAndFind = function (object, k, v) {\n        if (object.hasOwnProperty(k) && object[k] === v) {\n            return object;\n        }\n        for (var i = 0; i < Object.keys(object).length; i++) {\n            if (typeof object[Object.keys(object)[i]] === \"object\") {\n                var o = Utils.traverseAndFind(object[Object.keys(object)[i]], k, v);\n                if (o != null) {\n                    return o;\n                }\n            }\n        }\n        return undefined;\n    };\n    Utils.getServices = function (resource, _a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.onlyService, onlyService = _c === void 0 ? false : _c, _d = _b.onlyServices, onlyServices = _d === void 0 ? false : _d, _e = _b.skipParentResources, skipParentResources = _e === void 0 ? false : _e;\n        var services = [];\n        // Resources can reference \"services\" on the manifest. This is a bit of a hack to just get the services from the manifest\n        // too. What would be better is if this was used as a \"Map\" of full services.\n        // So when you come across { id: '...' } without any data, you can \"lookup\" services from the manifest.\n        // I would have implemented this if I was confident that it was reliable. Instead, I opted for the safest option that\n        // should not break any existing services.\n        if (!skipParentResources &&\n            resource &&\n            resource.options &&\n            resource.options.resource &&\n            resource.options.resource !== resource) {\n            services.push.apply(services, Utils.getServices(resource.options.resource, { onlyServices: true }));\n        }\n        var service = !onlyServices\n            ? (resource.__jsonld || resource).service || []\n            : [];\n        // coerce to array\n        if (!Array.isArray(service)) {\n            service = [service];\n        }\n        if (!onlyService) {\n            // Some resources also have a `.services` property.\n            // https://iiif.io/api/presentation/3.0/#services\n            service.push.apply(service, ((resource.__jsonld || resource).services || []));\n        }\n        if (service.length === 0) {\n            return services;\n        }\n        for (var i = 0; i < service.length; i++) {\n            var s = service[i];\n            if (typeof s === \"string\") {\n                var r = this.getResourceById(resource.options.resource, s);\n                if (r) {\n                    services.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.Service(r.__jsonld || r, resource.options));\n                }\n            }\n            else {\n                services.push(new _internal__WEBPACK_IMPORTED_MODULE_0__.Service(s, resource.options));\n            }\n        }\n        return services;\n    };\n    Utils.getTemporalComponent = function (target) {\n        var temporal = /t=([^&]+)/g.exec(target);\n        var t = null;\n        if (temporal && temporal[1]) {\n            t = temporal[1].split(\",\");\n        }\n        return t;\n    };\n    return Utils;\n}());\n\n//# sourceMappingURL=Utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVXRpbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsbUJBQW1CLFNBQUksSUFBSSxTQUFJO0FBQy9CLGNBQWMsNkJBQTZCLDBCQUEwQixjQUFjLHFCQUFxQjtBQUN4RyxpQkFBaUIsb0RBQW9ELHFFQUFxRSxjQUFjO0FBQ3hKLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDLG1DQUFtQyxTQUFTO0FBQzVDLG1DQUFtQyxXQUFXLFVBQVU7QUFDeEQsMENBQTBDLGNBQWM7QUFDeEQ7QUFDQSw4R0FBOEcsT0FBTztBQUNySCxpRkFBaUYsaUJBQWlCO0FBQ2xHLHlEQUF5RCxnQkFBZ0IsUUFBUTtBQUNqRiwrQ0FBK0MsZ0JBQWdCLGdCQUFnQjtBQUMvRTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0EsVUFBVSxZQUFZLGFBQWEsU0FBUyxVQUFVO0FBQ3RELG9DQUFvQyxTQUFTO0FBQzdDO0FBQ0E7QUFDK0Q7QUFDYztBQUNpQjtBQUNsRTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwRUFBYztBQUN0Qyx3QkFBd0IsMEVBQWM7QUFDdEMsd0JBQXdCLDBFQUFjO0FBQ3RDLHdCQUF3QiwwRUFBYztBQUN0Qyx3QkFBd0IsMEVBQWM7QUFDdEMsd0JBQXdCLDBFQUFjO0FBQ3RDLHdCQUF3QiwwRUFBYztBQUN0Qyx3QkFBd0IsMEVBQWM7QUFDdEMsd0JBQXdCLDBFQUFjO0FBQ3RDLHdCQUF3QiwwRUFBYztBQUN0Qyx3QkFBd0IsMEVBQWM7QUFDdEMsd0JBQXdCLDBFQUFjO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHFCQUFxQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHFCQUFxQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwyQkFBMkI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsdUVBQVc7QUFDOUMscUJBQXFCLHVFQUFXO0FBQ2hDO0FBQ0E7QUFDQSwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdELCtDQUErQywwRUFBYztBQUM3RCwrQ0FBK0MsMEVBQWM7QUFDN0QsK0NBQStDLDBFQUFjO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG1EQUFZO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxrQkFBa0I7QUFDdkQ7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsdUVBQUU7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELHVFQUFFLHdCQUF3QixzRkFBaUI7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHNGQUFpQjtBQUNuRSxnREFBZ0QsaUZBQVk7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCx1RUFBRSx3QkFBd0Isc0ZBQWlCO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUZBQWlGLHNGQUFpQjtBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELDBFQUFjO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0EscUNBQXFDO0FBQ3JDLGlDQUFpQztBQUNqQztBQUNBLGlDQUFpQztBQUNqQyw2QkFBNkI7QUFDN0I7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCx1RUFBRTtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsaURBQVU7QUFDM0M7QUFDQTtBQUNBLGlDQUFpQyxpREFBVTtBQUMzQztBQUNBO0FBQ0EsaUNBQWlDLGlEQUFVO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCx1RUFBRTtBQUMxRCx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLHVFQUFFO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBLHlDQUF5QztBQUN6QyxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxnQ0FBZ0Msc0ZBQWlCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLHlCQUF5QjtBQUN6QixxQkFBcUI7QUFDckI7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSx5QkFBeUI7QUFDekIscUJBQXFCO0FBQ3JCO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLFdBQVc7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQ0FBZ0M7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFlBQVk7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5RkFBeUYsb0JBQW9CO0FBQzdHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9CQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyw4Q0FBTztBQUM3QztBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsOENBQU87QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2dCO0FBQ2pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvVXRpbHMuanM/Y2UxNiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xuaW1wb3J0IHsgRGVzZXJpYWxpc2VyLCBTZXJ2aWNlLCBTdGF0dXNDb2RlIH0gZnJvbSBcIi4vaW50ZXJuYWxcIjtcbmltcG9ydCB7IFNlcnZpY2VQcm9maWxlLCBTZXJ2aWNlVHlwZSB9IGZyb20gXCJAaWlpZi92b2NhYnVsYXJ5L2Rpc3QtY29tbW9uanNcIjtcbmltcG9ydCB7IE9LLCBNT1ZFRF9URU1QT1JBUklMWSwgVU5BVVRIT1JJWkVEIH0gZnJvbSBcIkBlZHNpbHYvaHR0cC1zdGF0dXMtY29kZXMvZGlzdC1jb21tb25qc1wiO1xuaW1wb3J0IFwiaXNvbW9ycGhpYy11bmZldGNoXCI7XG52YXIgVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVXRpbHMoKSB7XG4gICAgfVxuICAgIFV0aWxzLmdldE1lZGlhVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHR5cGUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHR5cGUgPSB0eXBlLnNwbGl0KFwiO1wiKVswXTtcbiAgICAgICAgcmV0dXJuIHR5cGUudHJpbSgpO1xuICAgIH07XG4gICAgVXRpbHMuZ2V0SW1hZ2VRdWFsaXR5ID0gZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgaWYgKHByb2ZpbGUgPT09IFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09NUExJQU5DRV9MRVZFTF8xIHx8XG4gICAgICAgICAgICBwcm9maWxlID09PSBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTVBMSUFOQ0VfTEVWRUxfMiB8fFxuICAgICAgICAgICAgcHJvZmlsZSA9PT0gU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT01QTElBTkNFX0xFVkVMXzEgfHxcbiAgICAgICAgICAgIHByb2ZpbGUgPT09IFNlcnZpY2VQcm9maWxlLklNQUdFXzFfQ09NUExJQU5DRV9MRVZFTF8yIHx8XG4gICAgICAgICAgICBwcm9maWxlID09PSBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTkZPUk1BTkNFX0xFVkVMXzEgfHxcbiAgICAgICAgICAgIHByb2ZpbGUgPT09IFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09ORk9STUFOQ0VfTEVWRUxfMiB8fFxuICAgICAgICAgICAgcHJvZmlsZSA9PT0gU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT05GT1JNQU5DRV9MRVZFTF8xIHx8XG4gICAgICAgICAgICBwcm9maWxlID09PSBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8xX0NPTkZPUk1BTkNFX0xFVkVMXzIgfHxcbiAgICAgICAgICAgIHByb2ZpbGUgPT09IFNlcnZpY2VQcm9maWxlLklNQUdFXzFfTEVWRUxfMSB8fFxuICAgICAgICAgICAgcHJvZmlsZSA9PT0gU2VydmljZVByb2ZpbGUuSU1BR0VfMV9QUk9GSUxFX0xFVkVMXzEgfHxcbiAgICAgICAgICAgIHByb2ZpbGUgPT09IFNlcnZpY2VQcm9maWxlLklNQUdFXzFfTEVWRUxfMiB8fFxuICAgICAgICAgICAgcHJvZmlsZSA9PT0gU2VydmljZVByb2ZpbGUuSU1BR0VfMV9QUk9GSUxFX0xFVkVMXzIpIHtcbiAgICAgICAgICAgIHJldHVybiBcIm5hdGl2ZVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcImRlZmF1bHRcIjtcbiAgICB9O1xuICAgIFV0aWxzLmdldEluZXhhY3RMb2NhbGUgPSBmdW5jdGlvbiAobG9jYWxlKSB7XG4gICAgICAgIGlmIChsb2NhbGUuaW5kZXhPZihcIi1cIikgIT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxlLnN1YnN0cigwLCBsb2NhbGUuaW5kZXhPZihcIi1cIikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2NhbGU7XG4gICAgfTtcbiAgICBVdGlscy5nZXRMb2NhbGlzZWRWYWx1ZSA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgbG9jYWxlKSB7XG4gICAgICAgIC8vIGlmIHRoZSByZXNvdXJjZSBpcyBub3QgYW4gYXJyYXkgb2YgdHJhbnNsYXRpb25zLCByZXR1cm4gdGhlIHN0cmluZy5cbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJlc291cmNlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIHRlc3QgZm9yIGV4YWN0IG1hdGNoXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzb3VyY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZV8xID0gcmVzb3VyY2VbaV07XG4gICAgICAgICAgICB2YXIgbGFuZ3VhZ2VfMSA9IHZhbHVlXzFbXCJAbGFuZ3VhZ2VcIl07XG4gICAgICAgICAgICBpZiAobG9jYWxlID09PSBsYW5ndWFnZV8xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlXzFbXCJAdmFsdWVcIl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGVzdCBmb3IgaW5leGFjdCBtYXRjaFxuICAgICAgICB2YXIgbWF0Y2ggPSBsb2NhbGUuc3Vic3RyKDAsIGxvY2FsZS5pbmRleE9mKFwiLVwiKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzb3VyY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHJlc291cmNlW2ldO1xuICAgICAgICAgICAgdmFyIGxhbmd1YWdlID0gdmFsdWVbXCJAbGFuZ3VhZ2VcIl07XG4gICAgICAgICAgICBpZiAobGFuZ3VhZ2UgPT09IG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlW1wiQHZhbHVlXCJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVXRpbHMuZ2VuZXJhdGVUcmVlTm9kZUlkcyA9IGZ1bmN0aW9uICh0cmVlTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ID09PSB2b2lkIDApIHsgaW5kZXggPSAwOyB9XG4gICAgICAgIHZhciBpZDtcbiAgICAgICAgaWYgKCF0cmVlTm9kZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZCA9IFwiMFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWQgPSB0cmVlTm9kZS5wYXJlbnROb2RlLmlkICsgXCItXCIgKyBpbmRleDtcbiAgICAgICAgfVxuICAgICAgICB0cmVlTm9kZS5pZCA9IGlkO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyZWVOb2RlLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHRyZWVOb2RlLm5vZGVzW2ldO1xuICAgICAgICAgICAgVXRpbHMuZ2VuZXJhdGVUcmVlTm9kZUlkcyhuLCBpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVXRpbHMubm9ybWFsaXNlVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHR5cGUgPSAodHlwZSB8fCBcIlwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAodHlwZS5pbmRleE9mKFwiOlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IHR5cGUuc3BsaXQoXCI6XCIpO1xuICAgICAgICAgICAgcmV0dXJuIHNwbGl0WzFdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgIH07XG4gICAgVXRpbHMubm9ybWFsaXNlVXJsID0gZnVuY3Rpb24gKHVybCkge1xuICAgICAgICB1cmwgPSB1cmwuc3Vic3RyKHVybC5pbmRleE9mKFwiOi8vXCIpKTtcbiAgICAgICAgaWYgKHVybC5pbmRleE9mKFwiI1wiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHVybCA9IHVybC5zcGxpdChcIiNcIilbMF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9O1xuICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2ggPSBmdW5jdGlvbiAodXJsMSwgdXJsMikge1xuICAgICAgICByZXR1cm4gVXRpbHMubm9ybWFsaXNlVXJsKHVybDEpID09PSBVdGlscy5ub3JtYWxpc2VVcmwodXJsMik7XG4gICAgfTtcbiAgICBVdGlscy5pc0ltYWdlUHJvZmlsZSA9IGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgIGlmIChVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09NUExJQU5DRV9MRVZFTF8wKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTVBMSUFOQ0VfTEVWRUxfMSkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMF9DT01QTElBTkNFX0xFVkVMXzIpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfQ09NUExJQU5DRV9MRVZFTF8wKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8xX0NPTVBMSUFOQ0VfTEVWRUxfMikgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMF9DT05GT1JNQU5DRV9MRVZFTF8wKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTkZPUk1BTkNFX0xFVkVMXzEpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09ORk9STUFOQ0VfTEVWRUxfMikgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT05GT1JNQU5DRV9MRVZFTF8xKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8xX0NPTkZPUk1BTkNFX0xFVkVMXzIpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfTEVWRUxfMCkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9QUk9GSUxFX0xFVkVMXzApIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfTEVWRUxfMSkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9QUk9GSUxFX0xFVkVMXzEpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfTEVWRUxfMikgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9QUk9GSUxFX0xFVkVMXzIpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzJfTEVWRUxfMCkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMl9QUk9GSUxFX0xFVkVMXzApIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzJfTEVWRUxfMSkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMl9QUk9GSUxFX0xFVkVMXzEpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzJfTEVWRUxfMikgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMl9QUk9GSUxFX0xFVkVMXzIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBVdGlscy5pc0ltYWdlU2VydmljZVR5cGUgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICByZXR1cm4gKCh0eXBlICE9PSBudWxsICYmXG4gICAgICAgICAgICB0eXBlLnRvTG93ZXJDYXNlKCkgPT09IFNlcnZpY2VUeXBlLklNQUdFX1NFUlZJQ0VfMi50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICAgICAgdHlwZSA9PT0gU2VydmljZVR5cGUuSU1BR0VfU0VSVklDRV8zLnRvTG93ZXJDYXNlKCkpO1xuICAgIH07XG4gICAgVXRpbHMuaXNMZXZlbDBJbWFnZVByb2ZpbGUgPSBmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICBpZiAoVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTVBMSUFOQ0VfTEVWRUxfMCkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT01QTElBTkNFX0xFVkVMXzApIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09ORk9STUFOQ0VfTEVWRUxfMCkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT05GT1JNQU5DRV9MRVZFTF8wKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8xX0xFVkVMXzApIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfUFJPRklMRV9MRVZFTF8wKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8yX0xFVkVMXzApIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzJfUFJPRklMRV9MRVZFTF8wKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVXRpbHMuaXNMZXZlbDFJbWFnZVByb2ZpbGUgPSBmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICBpZiAoVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTVBMSUFOQ0VfTEVWRUxfMSkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT01QTElBTkNFX0xFVkVMXzEpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09ORk9STUFOQ0VfTEVWRUxfMSkgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT05GT1JNQU5DRV9MRVZFTF8xKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8xX0xFVkVMXzEpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfUFJPRklMRV9MRVZFTF8xKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8yX0xFVkVMXzEpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzJfUFJPRklMRV9MRVZFTF8xKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVXRpbHMuaXNMZXZlbDJJbWFnZVByb2ZpbGUgPSBmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICBpZiAoVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8wX0NPTVBMSUFOQ0VfTEVWRUxfMikgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT01QTElBTkNFX0xFVkVMXzIpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzBfQ09ORk9STUFOQ0VfTEVWRUxfMikgfHxcbiAgICAgICAgICAgIFV0aWxzLm5vcm1hbGlzZWRVcmxzTWF0Y2gocHJvZmlsZSwgU2VydmljZVByb2ZpbGUuSU1BR0VfMV9DT05GT1JNQU5DRV9MRVZFTF8yKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8xX0xFVkVMXzIpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzFfUFJPRklMRV9MRVZFTF8yKSB8fFxuICAgICAgICAgICAgVXRpbHMubm9ybWFsaXNlZFVybHNNYXRjaChwcm9maWxlLCBTZXJ2aWNlUHJvZmlsZS5JTUFHRV8yX0xFVkVMXzIpIHx8XG4gICAgICAgICAgICBVdGlscy5ub3JtYWxpc2VkVXJsc01hdGNoKHByb2ZpbGUsIFNlcnZpY2VQcm9maWxlLklNQUdFXzJfUFJPRklMRV9MRVZFTF8yKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVXRpbHMucGFyc2VNYW5pZmVzdCA9IGZ1bmN0aW9uIChtYW5pZmVzdCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gRGVzZXJpYWxpc2VyLnBhcnNlKG1hbmlmZXN0LCBvcHRpb25zKTtcbiAgICB9O1xuICAgIFV0aWxzLmNoZWNrU3RhdHVzID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgZXJyb3IucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFV0aWxzLmxvYWRNYW5pZmVzdCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGZldGNoKHVybClcbiAgICAgICAgICAgICAgICAudGhlbihVdGlscy5jaGVja1N0YXR1cylcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5qc29uKCk7IH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVXRpbHMubG9hZEV4dGVybmFsUmVzb3VyY2VzQXV0aDEgPSBmdW5jdGlvbiAocmVzb3VyY2VzLCBvcGVuQ29udGVudFByb3ZpZGVySW50ZXJhY3Rpb24sIG9wZW5Ub2tlblNlcnZpY2UsIGdldFN0b3JlZEFjY2Vzc1Rva2VuLCB1c2VySW50ZXJhY3RlZFdpdGhDb250ZW50UHJvdmlkZXIsIGdldENvbnRlbnRQcm92aWRlckludGVyYWN0aW9uLCBoYW5kbGVNb3ZlZFRlbXBvcmFyaWx5LCBzaG93T3V0T2ZPcHRpb25zTWVzc2FnZXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IHJlc291cmNlcy5tYXAoZnVuY3Rpb24gKHJlc291cmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFV0aWxzLmxvYWRFeHRlcm5hbFJlc291cmNlQXV0aDEocmVzb3VyY2UsIG9wZW5Db250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbiwgb3BlblRva2VuU2VydmljZSwgZ2V0U3RvcmVkQWNjZXNzVG9rZW4sIHVzZXJJbnRlcmFjdGVkV2l0aENvbnRlbnRQcm92aWRlciwgZ2V0Q29udGVudFByb3ZpZGVySW50ZXJhY3Rpb24sIGhhbmRsZU1vdmVkVGVtcG9yYXJpbHksIHNob3dPdXRPZk9wdGlvbnNNZXNzYWdlcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc291cmNlcyk7XG4gICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVdGlscy5sb2FkRXh0ZXJuYWxSZXNvdXJjZUF1dGgxID0gZnVuY3Rpb24gKHJlc291cmNlLCBvcGVuQ29udGVudFByb3ZpZGVySW50ZXJhY3Rpb24sIG9wZW5Ub2tlblNlcnZpY2UsIGdldFN0b3JlZEFjY2Vzc1Rva2VuLCB1c2VySW50ZXJhY3RlZFdpdGhDb250ZW50UHJvdmlkZXIsIGdldENvbnRlbnRQcm92aWRlckludGVyYWN0aW9uLCBoYW5kbGVNb3ZlZFRlbXBvcmFyaWx5LCBzaG93T3V0T2ZPcHRpb25zTWVzc2FnZXMpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHN0b3JlZEFjY2Vzc1Rva2VuO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBnZXRTdG9yZWRBY2Nlc3NUb2tlbihyZXNvdXJjZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yZWRBY2Nlc3NUb2tlbiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3RvcmVkQWNjZXNzVG9rZW4pIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzb3VyY2UuZ2V0RGF0YShzdG9yZWRBY2Nlc3NUb2tlbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXNvdXJjZS5zdGF0dXMgPT09IE9LKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVzb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc3RvcmVkIHRva2VuIGlzIG5vIGdvb2QgZm9yIHRoaXMgcmVzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgVXRpbHMuZG9BdXRoQ2hhaW4ocmVzb3VyY2UsIG9wZW5Db250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbiwgb3BlblRva2VuU2VydmljZSwgdXNlckludGVyYWN0ZWRXaXRoQ29udGVudFByb3ZpZGVyLCBnZXRDb250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbiwgaGFuZGxlTW92ZWRUZW1wb3JhcmlseSwgc2hvd091dE9mT3B0aW9uc01lc3NhZ2VzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzdG9yZWQgdG9rZW4gaXMgbm8gZ29vZCBmb3IgdGhpcyByZXNvdXJjZVxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA1O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2Uuc3RhdHVzID09PSBPSyB8fCByZXNvdXJjZS5zdGF0dXMgPT09IE1PVkVEX1RFTVBPUkFSSUxZKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlc291cmNlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IFV0aWxzLmNyZWF0ZUF1dGhvcml6YXRpb25GYWlsZWRFcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlc291cmNlLmdldERhdGEoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlc291cmNlLnN0YXR1cyA9PT0gTU9WRURfVEVNUE9SQVJJTFkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZS5zdGF0dXMgPT09IFVOQVVUSE9SSVpFRCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgVXRpbHMuZG9BdXRoQ2hhaW4ocmVzb3VyY2UsIG9wZW5Db250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbiwgb3BlblRva2VuU2VydmljZSwgdXNlckludGVyYWN0ZWRXaXRoQ29udGVudFByb3ZpZGVyLCBnZXRDb250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbiwgaGFuZGxlTW92ZWRUZW1wb3JhcmlseSwgc2hvd091dE9mT3B0aW9uc01lc3NhZ2VzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc291cmNlLnN0YXR1cyA9PT0gT0sgfHwgcmVzb3VyY2Uuc3RhdHVzID09PSBNT1ZFRF9URU1QT1JBUklMWSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBVdGlscy5jcmVhdGVBdXRob3JpemF0aW9uRmFpbGVkRXJyb3IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVdGlscy5kb0F1dGhDaGFpbiA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgb3BlbkNvbnRlbnRQcm92aWRlckludGVyYWN0aW9uLCBvcGVuVG9rZW5TZXJ2aWNlLCB1c2VySW50ZXJhY3RlZFdpdGhDb250ZW50UHJvdmlkZXIsIGdldENvbnRlbnRQcm92aWRlckludGVyYWN0aW9uLCBoYW5kbGVNb3ZlZFRlbXBvcmFyaWx5LCBzaG93T3V0T2ZPcHRpb25zTWVzc2FnZXMpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGV4dGVybmFsU2VydmljZSwga2lvc2tTZXJ2aWNlLCBjbGlja1Rocm91Z2hTZXJ2aWNlLCBsb2dpblNlcnZpY2UsIHNlcnZpY2VUb1RyeSwgbGFzdEF0dGVtcHRlZCwga2lvc2tJbnRlcmFjdGlvbiwgY29udGVudFByb3ZpZGVySW50ZXJhY3Rpb24sIGNvbnRlbnRQcm92aWRlckludGVyYWN0aW9uO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiBlbnRlcnMgdGhlIGZsb3djaGFydCBhdCB0aGUgPCBFeHRlcm5hbD8gPiBqdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cDovL2lpaWYuaW8vYXBpL2F1dGgvMS4wLyN3b3JrZmxvdy1mcm9tLXRoZS1icm93c2VyLWNsaWVudC1wZXJzcGVjdGl2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNvdXJjZS5pc0FjY2Vzc0NvbnRyb2xsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNvdXJjZV07IC8vIG5vIHNlcnZpY2VzIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbFNlcnZpY2UgPSByZXNvdXJjZS5leHRlcm5hbFNlcnZpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZXJuYWxTZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxTZXJ2aWNlLm9wdGlvbnMgPSByZXNvdXJjZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAga2lvc2tTZXJ2aWNlID0gcmVzb3VyY2Uua2lvc2tTZXJ2aWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtpb3NrU2VydmljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpb3NrU2VydmljZS5vcHRpb25zID0gcmVzb3VyY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrVGhyb3VnaFNlcnZpY2UgPSByZXNvdXJjZS5jbGlja1Rocm91Z2hTZXJ2aWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWNrVGhyb3VnaFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGlja1Rocm91Z2hTZXJ2aWNlLm9wdGlvbnMgPSByZXNvdXJjZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9naW5TZXJ2aWNlID0gcmVzb3VyY2UubG9naW5TZXJ2aWNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2luU2VydmljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2luU2VydmljZS5vcHRpb25zID0gcmVzb3VyY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFyZXNvdXJjZS5pc1Jlc3BvbnNlSGFuZGxlZCAmJiByZXNvdXJjZS5zdGF0dXMgPT09IE1PVkVEX1RFTVBPUkFSSUxZKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBoYW5kbGVNb3ZlZFRlbXBvcmFyaWx5KHJlc291cmNlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VUb1RyeSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0QXR0ZW1wdGVkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcGV0aXRpb24gb2YgbG9naWMgaXMgbGVmdCBpbiB0aGVzZSBzdGVwcyBmb3IgY2xhcml0eTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvb2tpbmcgZm9yIGV4dGVybmFsIHBhdHRlcm5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VUb1RyeSA9IGV4dGVybmFsU2VydmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VydmljZVRvVHJ5KSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RBdHRlbXB0ZWQgPSBzZXJ2aWNlVG9Ucnk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBVdGlscy5hdHRlbXB0UmVzb3VyY2VXaXRoVG9rZW4ocmVzb3VyY2UsIG9wZW5Ub2tlblNlcnZpY2UsIHNlcnZpY2VUb1RyeSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVzb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb29raW5nIGZvciBraW9zayBwYXR0ZXJuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlVG9UcnkgPSBraW9za1NlcnZpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlcnZpY2VUb1RyeSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0QXR0ZW1wdGVkID0gc2VydmljZVRvVHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAga2lvc2tJbnRlcmFjdGlvbiA9IG9wZW5Db250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbihzZXJ2aWNlVG9UcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFraW9za0ludGVyYWN0aW9uKSByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHVzZXJJbnRlcmFjdGVkV2l0aENvbnRlbnRQcm92aWRlcihraW9za0ludGVyYWN0aW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFV0aWxzLmF0dGVtcHRSZXNvdXJjZVdpdGhUb2tlbihyZXNvdXJjZSwgb3BlblRva2VuU2VydmljZSwgc2VydmljZVRvVHJ5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBjb2RlIGZvciB0aGUgbmV4dCB0d28gcGF0dGVybnMgaXMgaWRlbnRpY2FsIChvdGhlciB0aGFuIHRoZSBwcm9maWxlIG5hbWUpLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGRpZmZlcmVuY2UgaXMgaW4gdGhlIGV4cGVjdGVkIGJlaGF2aW91ciBvZlxuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGF3YWl0IHVzZXJJbnRlcmFjdGVkV2l0aENvbnRlbnRQcm92aWRlcihjb250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIGNsaWNrdGhyb3VnaCB0aGUgb3BlbmVkIHdpbmRvdyBzaG91bGQgY2xvc2UgaW1tZWRpYXRlbHkgaGF2aW5nIGVzdGFibGlzaGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhIHNlc3Npb24sIHdoZXJlYXMgZm9yIGxvZ2luIHRoZSB1c2VyIG1pZ2h0IHNwZW5kIHNvbWUgdGltZSBlbnRlcmluZyBjcmVkZW50aWFscyBldGMuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb29raW5nIGZvciBjbGlja3Rocm91Z2ggcGF0dGVyblxuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZVRvVHJ5ID0gY2xpY2tUaHJvdWdoU2VydmljZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VydmljZVRvVHJ5KSByZXR1cm4gWzMgLypicmVhayovLCAxMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0QXR0ZW1wdGVkID0gc2VydmljZVRvVHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZ2V0Q29udGVudFByb3ZpZGVySW50ZXJhY3Rpb24ocmVzb3VyY2UsIHNlcnZpY2VUb1RyeSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudFByb3ZpZGVySW50ZXJhY3Rpb24pIHJldHVybiBbMyAvKmJyZWFrKi8sIDExXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3VsZCBjbG9zZSBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdXNlckludGVyYWN0ZWRXaXRoQ29udGVudFByb3ZpZGVyKGNvbnRlbnRQcm92aWRlckludGVyYWN0aW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3VsZCBjbG9zZSBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgVXRpbHMuYXR0ZW1wdFJlc291cmNlV2l0aFRva2VuKHJlc291cmNlLCBvcGVuVG9rZW5TZXJ2aWNlLCBzZXJ2aWNlVG9UcnkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb29raW5nIGZvciBsb2dpbiBwYXR0ZXJuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlVG9UcnkgPSBsb2dpblNlcnZpY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlcnZpY2VUb1RyeSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEF0dGVtcHRlZCA9IHNlcnZpY2VUb1RyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGdldENvbnRlbnRQcm92aWRlckludGVyYWN0aW9uKHJlc291cmNlLCBzZXJ2aWNlVG9UcnkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQcm92aWRlckludGVyYWN0aW9uID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZW50UHJvdmlkZXJJbnRlcmFjdGlvbikgcmV0dXJuIFszIC8qYnJlYWsqLywgMTVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgZXhwZWN0IHRoZSB1c2VyIHRvIHNwZW5kIHNvbWUgdGltZSBpbnRlcmFjdGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdXNlckludGVyYWN0ZWRXaXRoQ29udGVudFByb3ZpZGVyKGNvbnRlbnRQcm92aWRlckludGVyYWN0aW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBleHBlY3QgdGhlIHVzZXIgdG8gc3BlbmQgc29tZSB0aW1lIGludGVyYWN0aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBVdGlscy5hdHRlbXB0UmVzb3VyY2VXaXRoVG9rZW4ocmVzb3VyY2UsIG9wZW5Ub2tlblNlcnZpY2UsIHNlcnZpY2VUb1RyeSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlc291cmNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmcgd29ya2VkISBVc2UgdGhlIG1vc3QgcmVjZW50bHkgdHJpZWQgc2VydmljZSBhcyB0aGUgc291cmNlIG9mXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtZXNzYWdlcyB0byBzaG93IHRvIHRoZSB1c2VyLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RBdHRlbXB0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93T3V0T2ZPcHRpb25zTWVzc2FnZXMocmVzb3VyY2UsIGxhc3RBdHRlbXB0ZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFV0aWxzLmF0dGVtcHRSZXNvdXJjZVdpdGhUb2tlbiA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgb3BlblRva2VuU2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRva2VuU2VydmljZSwgdG9rZW5NZXNzYWdlO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5TZXJ2aWNlID0gYXV0aFNlcnZpY2UuZ2V0U2VydmljZShTZXJ2aWNlUHJvZmlsZS5BVVRIXzFfVE9LRU4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b2tlblNlcnZpY2UpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgb3BlblRva2VuU2VydmljZShyZXNvdXJjZSwgdG9rZW5TZXJ2aWNlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuTWVzc2FnZSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRva2VuTWVzc2FnZSAmJiB0b2tlbk1lc3NhZ2UuYWNjZXNzVG9rZW4pKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlc291cmNlLmdldERhdGEodG9rZW5NZXNzYWdlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFV0aWxzLmxvYWRFeHRlcm5hbFJlc291cmNlc0F1dGgwOSA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIHRva2VuU3RvcmFnZVN0cmF0ZWd5LCBjbGlja1Rocm91Z2gsIHJlc3RyaWN0ZWQsIGxvZ2luLCBnZXRBY2Nlc3NUb2tlbiwgc3RvcmVBY2Nlc3NUb2tlbiwgZ2V0U3RvcmVkQWNjZXNzVG9rZW4sIGhhbmRsZVJlc291cmNlUmVzcG9uc2UsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IHJlc291cmNlcy5tYXAoZnVuY3Rpb24gKHJlc291cmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFV0aWxzLmxvYWRFeHRlcm5hbFJlc291cmNlQXV0aDA5KHJlc291cmNlLCB0b2tlblN0b3JhZ2VTdHJhdGVneSwgY2xpY2tUaHJvdWdoLCByZXN0cmljdGVkLCBsb2dpbiwgZ2V0QWNjZXNzVG9rZW4sIHN0b3JlQWNjZXNzVG9rZW4sIGdldFN0b3JlZEFjY2Vzc1Rva2VuLCBoYW5kbGVSZXNvdXJjZVJlc3BvbnNlLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgUHJvbWlzZS5hbGwocHJvbWlzZXMpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzb3VyY2VzKTtcbiAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8vIElJSUYgYXV0aCBhcGkgcHJlIHYxLjBcbiAgICAvLyBLZWVwaW5nIHRoaXMgYXJvdW5kIGZvciBub3cgdW50aWwgdGhlIGF1dGggMS4wIGltcGxlbWVudGF0aW9uIGlzIHN0YWJsZVxuICAgIFV0aWxzLmxvYWRFeHRlcm5hbFJlc291cmNlQXV0aDA5ID0gZnVuY3Rpb24gKHJlc291cmNlLCB0b2tlblN0b3JhZ2VTdHJhdGVneSwgY2xpY2tUaHJvdWdoLCByZXN0cmljdGVkLCBsb2dpbiwgZ2V0QWNjZXNzVG9rZW4sIHN0b3JlQWNjZXNzVG9rZW4sIGdldFN0b3JlZEFjY2Vzc1Rva2VuLCBoYW5kbGVSZXNvdXJjZVJlc3BvbnNlLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnBlc3NpbWlzdGljQWNjZXNzQ29udHJvbCkge1xuICAgICAgICAgICAgICAgIC8vIHBlc3NpbWlzdGljOiBhY2Nlc3MgY29udHJvbCBjb29raWVzIG1heSBoYXZlIGJlZW4gZGVsZXRlZC5cbiAgICAgICAgICAgICAgICAvLyBhbHdheXMgcmVxdWVzdCB0aGUgYWNjZXNzIHRva2VuIGZvciBldmVyeSBhY2Nlc3MgY29udHJvbGxlZCBpbmZvLmpzb24gcmVxdWVzdFxuICAgICAgICAgICAgICAgIC8vIHJldHVybmVkIGFjY2VzcyB0b2tlbnMgYXJlIG5vdCBzdG9yZWQsIHRoZXJlZm9yZSB0aGUgbG9naW4gd2luZG93IGZsYXNoZXMgZm9yIGV2ZXJ5IHJlcXVlc3QuXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgLmdldERhdGEoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZS5pc0FjY2Vzc0NvbnRyb2xsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIHJlc291cmNlIGhhcyBhIGNsaWNrIHRocm91Z2ggc2VydmljZSwgdXNlIHRoYXQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UuY2xpY2tUaHJvdWdoU2VydmljZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY2xpY2tUaHJvdWdoKHJlc291cmNlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy99IGVsc2UgaWYocmVzb3VyY2UucmVzdHJpY3RlZFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3RyaWN0ZWQocmVzb3VyY2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2luKHJlc291cmNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEFjY2Vzc1Rva2VuKHJlc291cmNlLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXREYXRhKHRva2VuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGhhbmRsZVJlc291cmNlUmVzcG9uc2UocmVzb3VyY2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvcihtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZUludGVybmFsU2VydmVyRXJyb3IobWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChVdGlscy5jcmVhdGVJbnRlcm5hbFNlcnZlckVycm9yKG1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgaW5mby5qc29uIGlzbid0IGFjY2VzcyBjb250cm9sbGVkLCB0aGVyZWZvcmUgbm8gbmVlZCB0byByZXF1ZXN0IGFuIGFjY2VzcyB0b2tlbi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvcihtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBvcHRpbWlzdGljOiBhY2Nlc3MgY29udHJvbCBjb29raWVzIG1heSBub3QgaGF2ZSBiZWVuIGRlbGV0ZWQuXG4gICAgICAgICAgICAgICAgLy8gc3RvcmUgYWNjZXNzIHRva2VucyB0byBhdm9pZCBsb2dpbiB3aW5kb3cgZmxhc2hlcy5cbiAgICAgICAgICAgICAgICAvLyBpZiBjb29raWVzIGFyZSBkZWxldGVkIGEgcGFnZSByZWZyZXNoIGlzIHJlcXVpcmVkLlxuICAgICAgICAgICAgICAgIC8vIHRyeSBsb2FkaW5nIHRoZSByZXNvdXJjZSB1c2luZyBhbiBhY2Nlc3MgdG9rZW4gdGhhdCBtYXRjaGVzIHRoZSBpbmZvLmpzb24gZG9tYWluLlxuICAgICAgICAgICAgICAgIC8vIGlmIGFuIGFjY2VzcyB0b2tlbiBpcyBmb3VuZCwgcmVxdWVzdCB0aGUgcmVzb3VyY2UgdXNpbmcgaXQgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIGl0IGlzIGFjY2VzcyBjb250cm9sbGVkLlxuICAgICAgICAgICAgICAgIGdldFN0b3JlZEFjY2Vzc1Rva2VuKHJlc291cmNlLCB0b2tlblN0b3JhZ2VTdHJhdGVneSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0b3JlZEFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdG9yZWRBY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJ5IHVzaW5nIHRoZSBzdG9yZWQgYWNjZXNzIHRva2VuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXREYXRhKHN0b3JlZEFjY2Vzc1Rva2VuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgaW5mby5qc29uIGxvYWRlZCB1c2luZyB0aGUgc3RvcmVkIGFjY2VzcyB0b2tlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZS5zdGF0dXMgPT09IE9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaGFuZGxlUmVzb3VyY2VSZXNwb25zZShyZXNvdXJjZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlLCBsb2FkIHRoZSByZXNvdXJjZSBkYXRhIHRvIGRldGVybWluZSB0aGUgY29ycmVjdCBhY2Nlc3MgY29udHJvbCBzZXJ2aWNlcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgYWNjZXNzIGNvbnRyb2xsZWQsIGRvIGxvZ2luLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVdGlscy5hdXRob3JpemUocmVzb3VyY2UsIHRva2VuU3RvcmFnZVN0cmF0ZWd5LCBjbGlja1Rocm91Z2gsIHJlc3RyaWN0ZWQsIGxvZ2luLCBnZXRBY2Nlc3NUb2tlbiwgc3RvcmVBY2Nlc3NUb2tlbiwgZ2V0U3RvcmVkQWNjZXNzVG9rZW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGhhbmRsZVJlc291cmNlUmVzcG9uc2UocmVzb3VyY2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIChyZXNvdXJjZS5yZXN0cmljdGVkU2VydmljZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZVJlc3RyaWN0ZWRFcnJvcigpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlQXV0aG9yaXphdGlvbkZhaWxlZEVycm9yKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZUF1dGhvcml6YXRpb25GYWlsZWRFcnJvcigpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuYXV0aG9yaXplKHJlc291cmNlLCB0b2tlblN0b3JhZ2VTdHJhdGVneSwgY2xpY2tUaHJvdWdoLCByZXN0cmljdGVkLCBsb2dpbiwgZ2V0QWNjZXNzVG9rZW4sIHN0b3JlQWNjZXNzVG9rZW4sIGdldFN0b3JlZEFjY2Vzc1Rva2VuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGhhbmRsZVJlc291cmNlUmVzcG9uc2UocmVzb3VyY2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZUF1dGhvcml6YXRpb25GYWlsZWRFcnJvcigpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZUF1dGhvcml6YXRpb25GYWlsZWRFcnJvcigpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVdGlscy5jcmVhdGVFcnJvciA9IGZ1bmN0aW9uIChuYW1lLCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBlcnJvciA9IG5ldyBFcnJvcigpO1xuICAgICAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgZXJyb3IubmFtZSA9IFN0cmluZyhuYW1lKTtcbiAgICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH07XG4gICAgVXRpbHMuY3JlYXRlQXV0aG9yaXphdGlvbkZhaWxlZEVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVXRpbHMuY3JlYXRlRXJyb3IoU3RhdHVzQ29kZS5BVVRIT1JJWkFUSU9OX0ZBSUxFRCwgXCJBdXRob3JpemF0aW9uIGZhaWxlZFwiKTtcbiAgICB9O1xuICAgIFV0aWxzLmNyZWF0ZVJlc3RyaWN0ZWRFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFV0aWxzLmNyZWF0ZUVycm9yKFN0YXR1c0NvZGUuUkVTVFJJQ1RFRCwgXCJSZXN0cmljdGVkXCIpO1xuICAgIH07XG4gICAgVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5jcmVhdGVFcnJvcihTdGF0dXNDb2RlLklOVEVSTkFMX1NFUlZFUl9FUlJPUiwgbWVzc2FnZSk7XG4gICAgfTtcbiAgICBVdGlscy5hdXRob3JpemUgPSBmdW5jdGlvbiAocmVzb3VyY2UsIHRva2VuU3RvcmFnZVN0cmF0ZWd5LCBjbGlja1Rocm91Z2gsIHJlc3RyaWN0ZWQsIGxvZ2luLCBnZXRBY2Nlc3NUb2tlbiwgc3RvcmVBY2Nlc3NUb2tlbiwgZ2V0U3RvcmVkQWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHJlc291cmNlLmdldERhdGEoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UuaXNBY2Nlc3NDb250cm9sbGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0U3RvcmVkQWNjZXNzVG9rZW4ocmVzb3VyY2UsIHRva2VuU3RvcmFnZVN0cmF0ZWd5KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0b3JlZEFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcmVkQWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cnkgdXNpbmcgdGhlIHN0b3JlZCBhY2Nlc3MgdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0RGF0YShzdG9yZWRBY2Nlc3NUb2tlbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2Uuc3RhdHVzID09PSBPSykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNvdXJjZSk7IC8vIGhhcHB5IHBhdGggZW5kZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzdG9yZWQgdG9rZW4gaXMgbm8gZ29vZCBmb3IgdGhpcyByZXNvdXJjZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2hvd0F1dGhJbnRlcmFjdGlvbihyZXNvdXJjZSwgdG9rZW5TdG9yYWdlU3RyYXRlZ3ksIGNsaWNrVGhyb3VnaCwgcmVzdHJpY3RlZCwgbG9naW4sIGdldEFjY2Vzc1Rva2VuLCBzdG9yZUFjY2Vzc1Rva2VuLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvcihtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSB3YXMgbm8gc3RvcmVkIHRva2VuLCBidXQgdGhlIHVzZXIgbWlnaHQgaGF2ZSBhIGNvb2tpZSB0aGF0IHdpbGwgZ3JhbnQgYSB0b2tlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEFjY2Vzc1Rva2VuKHJlc291cmNlLCBmYWxzZSkudGhlbihmdW5jdGlvbiAoYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9yZUFjY2Vzc1Rva2VuKHJlc291cmNlLCBhY2Nlc3NUb2tlbiwgdG9rZW5TdG9yYWdlU3RyYXRlZ3kpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyeSB1c2luZyB0aGUgZnJlc2ggYWNjZXNzIHRva2VuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldERhdGEoYWNjZXNzVG9rZW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc291cmNlLnN0YXR1cyA9PT0gT0spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlciBoYXMgYSB0b2tlbiwgYnV0IGl0J3Mgbm90IGdvb2QgZW5vdWdoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVdGlscy5zaG93QXV0aEludGVyYWN0aW9uKHJlc291cmNlLCB0b2tlblN0b3JhZ2VTdHJhdGVneSwgY2xpY2tUaHJvdWdoLCByZXN0cmljdGVkLCBsb2dpbiwgZ2V0QWNjZXNzVG9rZW4sIHN0b3JlQWNjZXNzVG9rZW4sIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChVdGlscy5jcmVhdGVJbnRlcm5hbFNlcnZlckVycm9yKG1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBub3QgYWJsZSB0byBzdG9yZSBhY2Nlc3MgdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvcihtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSB1c2VyIGRpZCBub3QgaGF2ZSBhIGNvb2tpZSB0aGF0IGdyYW50ZWQgYSB0b2tlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2hvd0F1dGhJbnRlcmFjdGlvbihyZXNvdXJjZSwgdG9rZW5TdG9yYWdlU3RyYXRlZ3ksIGNsaWNrVGhyb3VnaCwgcmVzdHJpY3RlZCwgbG9naW4sIGdldEFjY2Vzc1Rva2VuLCBzdG9yZUFjY2Vzc1Rva2VuLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChVdGlscy5jcmVhdGVJbnRlcm5hbFNlcnZlckVycm9yKG1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGluZm8uanNvbiBpc24ndCBhY2Nlc3MgY29udHJvbGxlZCwgdGhlcmVmb3JlIHRoZXJlJ3Mgbm8gbmVlZCB0byByZXF1ZXN0IGFuIGFjY2VzcyB0b2tlblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc291cmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVdGlscy5zaG93QXV0aEludGVyYWN0aW9uID0gZnVuY3Rpb24gKHJlc291cmNlLCB0b2tlblN0b3JhZ2VTdHJhdGVneSwgY2xpY2tUaHJvdWdoLCByZXN0cmljdGVkLCBsb2dpbiwgZ2V0QWNjZXNzVG9rZW4sIHN0b3JlQWNjZXNzVG9rZW4sIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBpZiAocmVzb3VyY2Uuc3RhdHVzID09PSBNT1ZFRF9URU1QT1JBUklMWSAmJiAhcmVzb3VyY2UuaXNSZXNwb25zZUhhbmRsZWQpIHtcbiAgICAgICAgICAgIC8vIGlmIHRoZSByZXNvdXJjZSB3YXMgcmVkaXJlY3RlZCB0byBhIGRlZ3JhZGVkIHZlcnNpb25cbiAgICAgICAgICAgIC8vIGFuZCB0aGUgcmVzcG9uc2UgaGFzbid0IGJlZW4gaGFuZGxlZCB5ZXQuXG4gICAgICAgICAgICAvLyBpZiB0aGUgY2xpZW50IHdpc2hlcyB0byB0cmlnZ2VyIGEgbG9naW4sIHNldCByZXNvdXJjZS5pc1Jlc3BvbnNlSGFuZGxlZCB0byB0cnVlXG4gICAgICAgICAgICAvLyBhbmQgY2FsbCBsb2FkRXh0ZXJuYWxSZXNvdXJjZXMoKSBhZ2FpbiBwYXNzaW5nIHRoZSByZXNvdXJjZS5cbiAgICAgICAgICAgIHJlc29sdmUocmVzb3VyY2UpO1xuICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChyZXNvdXJjZS5yZXN0cmljdGVkU2VydmljZSkge1xuICAgICAgICAgICAgLy8gICAgIHJlc29sdmUocmVzdHJpY3RlZChyZXNvdXJjZSkpO1xuICAgICAgICAgICAgLy8gICAgIC8vIFRPRE86IG1vdmUgdG8gbmV4dCBldGNcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZXNvdXJjZS5jbGlja1Rocm91Z2hTZXJ2aWNlICYmICFyZXNvdXJjZS5pc1Jlc3BvbnNlSGFuZGxlZCkge1xuICAgICAgICAgICAgLy8gaWYgdGhlIHJlc291cmNlIGhhcyBhIGNsaWNrIHRocm91Z2ggc2VydmljZSwgdXNlIHRoYXQuXG4gICAgICAgICAgICBjbGlja1Rocm91Z2gocmVzb3VyY2UpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldEFjY2Vzc1Rva2VuKHJlc291cmNlLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmVBY2Nlc3NUb2tlbihyZXNvdXJjZSwgYWNjZXNzVG9rZW4sIHRva2VuU3RvcmFnZVN0cmF0ZWd5KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0RGF0YShhY2Nlc3NUb2tlbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZUludGVybmFsU2VydmVyRXJyb3IobWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChVdGlscy5jcmVhdGVJbnRlcm5hbFNlcnZlckVycm9yKG1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvcihtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGdldCBhbiBhY2Nlc3MgdG9rZW5cbiAgICAgICAgICAgIGxvZ2luKHJlc291cmNlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZXRBY2Nlc3NUb2tlbihyZXNvdXJjZSwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3JlQWNjZXNzVG9rZW4ocmVzb3VyY2UsIGFjY2Vzc1Rva2VuLCB0b2tlblN0b3JhZ2VTdHJhdGVneSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldERhdGEoYWNjZXNzVG9rZW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChVdGlscy5jcmVhdGVJbnRlcm5hbFNlcnZlckVycm9yKG1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoVXRpbHMuY3JlYXRlSW50ZXJuYWxTZXJ2ZXJFcnJvcihtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFV0aWxzLmNyZWF0ZUludGVybmFsU2VydmVyRXJyb3IobWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFV0aWxzLmdldFNlcnZpY2UgPSBmdW5jdGlvbiAocmVzb3VyY2UsIHByb2ZpbGUpIHtcbiAgICAgICAgdmFyIHNlcnZpY2VzID0gdGhpcy5nZXRTZXJ2aWNlcyhyZXNvdXJjZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VydmljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gc2VydmljZXNbaV07XG4gICAgICAgICAgICBpZiAoc2VydmljZS5nZXRQcm9maWxlKCkgPT09IHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFV0aWxzLmdldFJlc291cmNlQnlJZCA9IGZ1bmN0aW9uIChwYXJlbnRSZXNvdXJjZSwgaWQpIHtcbiAgICAgICAgcmV0dXJuIChVdGlscy50cmF2ZXJzZUFuZEZpbmQocGFyZW50UmVzb3VyY2UuX19qc29ubGQsIFwiQGlkXCIsIGlkKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEb2VzIGEgZGVwdGggZmlyc3QgdHJhdmVyc2FsIG9mIGFuIE9iamVjdCwgcmV0dXJuaW5nIGFuIE9iamVjdCB0aGF0XG4gICAgICogbWF0Y2hlcyBwcm92aWRlZCBrIGFuZCB2IGFyZ3VtZW50c1xuICAgICAqIEBleGFtcGxlIFV0aWxzLnRyYXZlcnNlQW5kRmluZCh7Zm9vOiAnYmFyJ30sICdmb28nLCAnYmFyJylcbiAgICAgKi9cbiAgICBVdGlscy50cmF2ZXJzZUFuZEZpbmQgPSBmdW5jdGlvbiAob2JqZWN0LCBrLCB2KSB7XG4gICAgICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkoaykgJiYgb2JqZWN0W2tdID09PSB2KSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgT2JqZWN0LmtleXMob2JqZWN0KS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmplY3RbT2JqZWN0LmtleXMob2JqZWN0KVtpXV0gPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IFV0aWxzLnRyYXZlcnNlQW5kRmluZChvYmplY3RbT2JqZWN0LmtleXMob2JqZWN0KVtpXV0sIGssIHYpO1xuICAgICAgICAgICAgICAgIGlmIChvICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBVdGlscy5nZXRTZXJ2aWNlcyA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgX2EpIHtcbiAgICAgICAgdmFyIF9iID0gX2EgPT09IHZvaWQgMCA/IHt9IDogX2EsIF9jID0gX2Iub25seVNlcnZpY2UsIG9ubHlTZXJ2aWNlID0gX2MgPT09IHZvaWQgMCA/IGZhbHNlIDogX2MsIF9kID0gX2Iub25seVNlcnZpY2VzLCBvbmx5U2VydmljZXMgPSBfZCA9PT0gdm9pZCAwID8gZmFsc2UgOiBfZCwgX2UgPSBfYi5za2lwUGFyZW50UmVzb3VyY2VzLCBza2lwUGFyZW50UmVzb3VyY2VzID0gX2UgPT09IHZvaWQgMCA/IGZhbHNlIDogX2U7XG4gICAgICAgIHZhciBzZXJ2aWNlcyA9IFtdO1xuICAgICAgICAvLyBSZXNvdXJjZXMgY2FuIHJlZmVyZW5jZSBcInNlcnZpY2VzXCIgb24gdGhlIG1hbmlmZXN0LiBUaGlzIGlzIGEgYml0IG9mIGEgaGFjayB0byBqdXN0IGdldCB0aGUgc2VydmljZXMgZnJvbSB0aGUgbWFuaWZlc3RcbiAgICAgICAgLy8gdG9vLiBXaGF0IHdvdWxkIGJlIGJldHRlciBpcyBpZiB0aGlzIHdhcyB1c2VkIGFzIGEgXCJNYXBcIiBvZiBmdWxsIHNlcnZpY2VzLlxuICAgICAgICAvLyBTbyB3aGVuIHlvdSBjb21lIGFjcm9zcyB7IGlkOiAnLi4uJyB9IHdpdGhvdXQgYW55IGRhdGEsIHlvdSBjYW4gXCJsb29rdXBcIiBzZXJ2aWNlcyBmcm9tIHRoZSBtYW5pZmVzdC5cbiAgICAgICAgLy8gSSB3b3VsZCBoYXZlIGltcGxlbWVudGVkIHRoaXMgaWYgSSB3YXMgY29uZmlkZW50IHRoYXQgaXQgd2FzIHJlbGlhYmxlLiBJbnN0ZWFkLCBJIG9wdGVkIGZvciB0aGUgc2FmZXN0IG9wdGlvbiB0aGF0XG4gICAgICAgIC8vIHNob3VsZCBub3QgYnJlYWsgYW55IGV4aXN0aW5nIHNlcnZpY2VzLlxuICAgICAgICBpZiAoIXNraXBQYXJlbnRSZXNvdXJjZXMgJiZcbiAgICAgICAgICAgIHJlc291cmNlICYmXG4gICAgICAgICAgICByZXNvdXJjZS5vcHRpb25zICYmXG4gICAgICAgICAgICByZXNvdXJjZS5vcHRpb25zLnJlc291cmNlICYmXG4gICAgICAgICAgICByZXNvdXJjZS5vcHRpb25zLnJlc291cmNlICE9PSByZXNvdXJjZSkge1xuICAgICAgICAgICAgc2VydmljZXMucHVzaC5hcHBseShzZXJ2aWNlcywgVXRpbHMuZ2V0U2VydmljZXMocmVzb3VyY2Uub3B0aW9ucy5yZXNvdXJjZSwgeyBvbmx5U2VydmljZXM6IHRydWUgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZXJ2aWNlID0gIW9ubHlTZXJ2aWNlc1xuICAgICAgICAgICAgPyAocmVzb3VyY2UuX19qc29ubGQgfHwgcmVzb3VyY2UpLnNlcnZpY2UgfHwgW11cbiAgICAgICAgICAgIDogW107XG4gICAgICAgIC8vIGNvZXJjZSB0byBhcnJheVxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc2VydmljZSkpIHtcbiAgICAgICAgICAgIHNlcnZpY2UgPSBbc2VydmljZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvbmx5U2VydmljZSkge1xuICAgICAgICAgICAgLy8gU29tZSByZXNvdXJjZXMgYWxzbyBoYXZlIGEgYC5zZXJ2aWNlc2AgcHJvcGVydHkuXG4gICAgICAgICAgICAvLyBodHRwczovL2lpaWYuaW8vYXBpL3ByZXNlbnRhdGlvbi8zLjAvI3NlcnZpY2VzXG4gICAgICAgICAgICBzZXJ2aWNlLnB1c2guYXBwbHkoc2VydmljZSwgKChyZXNvdXJjZS5fX2pzb25sZCB8fCByZXNvdXJjZSkuc2VydmljZXMgfHwgW10pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VydmljZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlcztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlcnZpY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzID0gc2VydmljZVtpXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHZhciByID0gdGhpcy5nZXRSZXNvdXJjZUJ5SWQocmVzb3VyY2Uub3B0aW9ucy5yZXNvdXJjZSwgcyk7XG4gICAgICAgICAgICAgICAgaWYgKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZXMucHVzaChuZXcgU2VydmljZShyLl9fanNvbmxkIHx8IHIsIHJlc291cmNlLm9wdGlvbnMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXJ2aWNlcy5wdXNoKG5ldyBTZXJ2aWNlKHMsIHJlc291cmNlLm9wdGlvbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VydmljZXM7XG4gICAgfTtcbiAgICBVdGlscy5nZXRUZW1wb3JhbENvbXBvbmVudCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdmFyIHRlbXBvcmFsID0gL3Q9KFteJl0rKS9nLmV4ZWModGFyZ2V0KTtcbiAgICAgICAgdmFyIHQgPSBudWxsO1xuICAgICAgICBpZiAodGVtcG9yYWwgJiYgdGVtcG9yYWxbMV0pIHtcbiAgICAgICAgICAgIHQgPSB0ZW1wb3JhbFsxXS5zcGxpdChcIixcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICByZXR1cm4gVXRpbHM7XG59KCkpO1xuZXhwb3J0IHsgVXRpbHMgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVV0aWxzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/Utils.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Annotation: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Annotation),\n/* harmony export */   AnnotationBody: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationBody),\n/* harmony export */   AnnotationList: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationList),\n/* harmony export */   AnnotationPage: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.AnnotationPage),\n/* harmony export */   Canvas: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Canvas),\n/* harmony export */   Collection: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Collection),\n/* harmony export */   Deserialiser: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Deserialiser),\n/* harmony export */   Duration: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Duration),\n/* harmony export */   IIIFResource: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.IIIFResource),\n/* harmony export */   JSONLDResource: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.JSONLDResource),\n/* harmony export */   LabelValuePair: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.LabelValuePair),\n/* harmony export */   LanguageMap: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.LanguageMap),\n/* harmony export */   LocalizedValue: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.LocalizedValue),\n/* harmony export */   Manifest: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Manifest),\n/* harmony export */   ManifestResource: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.ManifestResource),\n/* harmony export */   ManifestType: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.ManifestType),\n/* harmony export */   PropertyValue: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.PropertyValue),\n/* harmony export */   Range: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Range),\n/* harmony export */   Rendering: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Rendering),\n/* harmony export */   Resource: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Resource),\n/* harmony export */   Sequence: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Sequence),\n/* harmony export */   Service: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Service),\n/* harmony export */   Size: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Size),\n/* harmony export */   StatusCode: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.StatusCode),\n/* harmony export */   Thumb: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Thumb),\n/* harmony export */   Thumbnail: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Thumbnail),\n/* harmony export */   TreeNode: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.TreeNode),\n/* harmony export */   TreeNodeType: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.TreeNodeType),\n/* harmony export */   Utils: () => (/* reexport safe */ _internal__WEBPACK_IMPORTED_MODULE_0__.Utils),\n/* harmony export */   loadManifest: () => (/* binding */ loadManifest),\n/* harmony export */   parseManifest: () => (/* binding */ parseManifest)\n/* harmony export */ });\n/* harmony import */ var _internal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\");\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Utils */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Utils.js\");\n\n\nvar loadManifest = function (url) {\n    return _Utils__WEBPACK_IMPORTED_MODULE_1__.Utils.loadManifest(url);\n};\nvar parseManifest = function (manifest, options) {\n    return _Utils__WEBPACK_IMPORTED_MODULE_1__.Utils.parseManifest(manifest, options);\n};\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTJCO0FBQ0s7QUFDekI7QUFDUCxXQUFXLHlDQUFLO0FBQ2hCO0FBQ087QUFDUCxXQUFXLHlDQUFLO0FBQ2hCO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC8uL25vZGVfbW9kdWxlcy9tYW5pZmVzdG8uanMvZGlzdC1lc21vZHVsZS9pbmRleC5qcz9lZGM3Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCAqIGZyb20gXCIuL2ludGVybmFsXCI7XG5pbXBvcnQgeyBVdGlscyB9IGZyb20gXCIuL1V0aWxzXCI7XG5leHBvcnQgdmFyIGxvYWRNYW5pZmVzdCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICByZXR1cm4gVXRpbHMubG9hZE1hbmlmZXN0KHVybCk7XG59O1xuZXhwb3J0IHZhciBwYXJzZU1hbmlmZXN0ID0gZnVuY3Rpb24gKG1hbmlmZXN0LCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIFV0aWxzLnBhcnNlTWFuaWZlc3QobWFuaWZlc3QsIG9wdGlvbnMpO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js":
/*!*************************************************************!*\
  !*** ./node_modules/manifesto.js/dist-esmodule/internal.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Annotation: () => (/* reexport safe */ _Annotation__WEBPACK_IMPORTED_MODULE_4__.Annotation),\n/* harmony export */   AnnotationBody: () => (/* reexport safe */ _AnnotationBody__WEBPACK_IMPORTED_MODULE_5__.AnnotationBody),\n/* harmony export */   AnnotationList: () => (/* reexport safe */ _AnnotationList__WEBPACK_IMPORTED_MODULE_6__.AnnotationList),\n/* harmony export */   AnnotationPage: () => (/* reexport safe */ _AnnotationPage__WEBPACK_IMPORTED_MODULE_7__.AnnotationPage),\n/* harmony export */   Canvas: () => (/* reexport safe */ _Canvas__WEBPACK_IMPORTED_MODULE_8__.Canvas),\n/* harmony export */   Collection: () => (/* reexport safe */ _Collection__WEBPACK_IMPORTED_MODULE_9__.Collection),\n/* harmony export */   Deserialiser: () => (/* reexport safe */ _Serialisation__WEBPACK_IMPORTED_MODULE_19__.Deserialiser),\n/* harmony export */   Duration: () => (/* reexport safe */ _Duration__WEBPACK_IMPORTED_MODULE_10__.Duration),\n/* harmony export */   IIIFResource: () => (/* reexport safe */ _IIIFResource__WEBPACK_IMPORTED_MODULE_3__.IIIFResource),\n/* harmony export */   JSONLDResource: () => (/* reexport safe */ _JSONLDResource__WEBPACK_IMPORTED_MODULE_0__.JSONLDResource),\n/* harmony export */   LabelValuePair: () => (/* reexport safe */ _LabelValuePair__WEBPACK_IMPORTED_MODULE_11__.LabelValuePair),\n/* harmony export */   LanguageMap: () => (/* reexport safe */ _LanguageMap__WEBPACK_IMPORTED_MODULE_12__.LanguageMap),\n/* harmony export */   LocalizedValue: () => (/* reexport safe */ _PropertyValue__WEBPACK_IMPORTED_MODULE_13__.LocalizedValue),\n/* harmony export */   Manifest: () => (/* reexport safe */ _Manifest__WEBPACK_IMPORTED_MODULE_14__.Manifest),\n/* harmony export */   ManifestResource: () => (/* reexport safe */ _ManifestResource__WEBPACK_IMPORTED_MODULE_1__.ManifestResource),\n/* harmony export */   ManifestType: () => (/* reexport safe */ _ManifestType__WEBPACK_IMPORTED_MODULE_15__.ManifestType),\n/* harmony export */   PropertyValue: () => (/* reexport safe */ _PropertyValue__WEBPACK_IMPORTED_MODULE_13__.PropertyValue),\n/* harmony export */   Range: () => (/* reexport safe */ _Range__WEBPACK_IMPORTED_MODULE_16__.Range),\n/* harmony export */   Rendering: () => (/* reexport safe */ _Rendering__WEBPACK_IMPORTED_MODULE_17__.Rendering),\n/* harmony export */   Resource: () => (/* reexport safe */ _Resource__WEBPACK_IMPORTED_MODULE_2__.Resource),\n/* harmony export */   Sequence: () => (/* reexport safe */ _Sequence__WEBPACK_IMPORTED_MODULE_18__.Sequence),\n/* harmony export */   Service: () => (/* reexport safe */ _Service__WEBPACK_IMPORTED_MODULE_20__.Service),\n/* harmony export */   Size: () => (/* reexport safe */ _Size__WEBPACK_IMPORTED_MODULE_21__.Size),\n/* harmony export */   StatusCode: () => (/* reexport safe */ _StatusCode__WEBPACK_IMPORTED_MODULE_22__.StatusCode),\n/* harmony export */   Thumb: () => (/* reexport safe */ _Thumb__WEBPACK_IMPORTED_MODULE_23__.Thumb),\n/* harmony export */   Thumbnail: () => (/* reexport safe */ _Thumbnail__WEBPACK_IMPORTED_MODULE_24__.Thumbnail),\n/* harmony export */   TreeNode: () => (/* reexport safe */ _TreeNode__WEBPACK_IMPORTED_MODULE_25__.TreeNode),\n/* harmony export */   TreeNodeType: () => (/* reexport safe */ _TreeNodeType__WEBPACK_IMPORTED_MODULE_26__.TreeNodeType),\n/* harmony export */   Utils: () => (/* reexport safe */ _Utils__WEBPACK_IMPORTED_MODULE_27__.Utils)\n/* harmony export */ });\n/* harmony import */ var _JSONLDResource__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./JSONLDResource */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/JSONLDResource.js\");\n/* harmony import */ var _ManifestResource__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ManifestResource */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/ManifestResource.js\");\n/* harmony import */ var _Resource__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Resource */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Resource.js\");\n/* harmony import */ var _IIIFResource__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./IIIFResource */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/IIIFResource.js\");\n/* harmony import */ var _Annotation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Annotation */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Annotation.js\");\n/* harmony import */ var _AnnotationBody__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AnnotationBody */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationBody.js\");\n/* harmony import */ var _AnnotationList__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AnnotationList */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationList.js\");\n/* harmony import */ var _AnnotationPage__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./AnnotationPage */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/AnnotationPage.js\");\n/* harmony import */ var _Canvas__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Canvas */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Canvas.js\");\n/* harmony import */ var _Collection__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Collection */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Collection.js\");\n/* harmony import */ var _Duration__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Duration */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Duration.js\");\n/* harmony import */ var _LabelValuePair__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./LabelValuePair */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/LabelValuePair.js\");\n/* harmony import */ var _LanguageMap__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./LanguageMap */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/LanguageMap.js\");\n/* harmony import */ var _PropertyValue__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./PropertyValue */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/PropertyValue.js\");\n/* harmony import */ var _Manifest__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Manifest */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Manifest.js\");\n/* harmony import */ var _ManifestType__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./ManifestType */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/ManifestType.js\");\n/* harmony import */ var _Range__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Range */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Range.js\");\n/* harmony import */ var _Rendering__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Rendering */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Rendering.js\");\n/* harmony import */ var _Sequence__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Sequence */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Sequence.js\");\n/* harmony import */ var _Serialisation__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./Serialisation */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Serialisation.js\");\n/* harmony import */ var _Service__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./Service */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Service.js\");\n/* harmony import */ var _Size__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./Size */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Size.js\");\n/* harmony import */ var _StatusCode__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./StatusCode */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/StatusCode.js\");\n/* harmony import */ var _Thumb__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./Thumb */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Thumb.js\");\n/* harmony import */ var _Thumbnail__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./Thumbnail */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Thumbnail.js\");\n/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./TreeNode */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/TreeNode.js\");\n/* harmony import */ var _TreeNodeType__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./TreeNodeType */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/TreeNodeType.js\");\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./Utils */ \"(ssr)/./node_modules/manifesto.js/dist-esmodule/Utils.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceMappingURL=internal.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvaW50ZXJuYWwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWlDO0FBQ0U7QUFDUjtBQUNJO0FBQ0Y7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNJO0FBQ0Y7QUFDTTtBQUNIO0FBQ0U7QUFDTDtBQUNJO0FBQ1A7QUFDSTtBQUNEO0FBQ0s7QUFDTjtBQUNIO0FBQ007QUFDTDtBQUNJO0FBQ0Q7QUFDSTtBQUNQO0FBQ3hCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVhY3QvLi9ub2RlX21vZHVsZXMvbWFuaWZlc3RvLmpzL2Rpc3QtZXNtb2R1bGUvaW50ZXJuYWwuanM/MmY3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tIFwiLi9KU09OTERSZXNvdXJjZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vTWFuaWZlc3RSZXNvdXJjZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vUmVzb3VyY2VcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0lJSUZSZXNvdXJjZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQW5ub3RhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQW5ub3RhdGlvbkJvZHlcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0Fubm90YXRpb25MaXN0XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9Bbm5vdGF0aW9uUGFnZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQ2FudmFzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9Db2xsZWN0aW9uXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9EdXJhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vTGFiZWxWYWx1ZVBhaXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0xhbmd1YWdlTWFwXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9Qcm9wZXJ0eVZhbHVlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9NYW5pZmVzdFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vTWFuaWZlc3RUeXBlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9SYW5nZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vUmVuZGVyaW5nXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXF1ZW5jZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VyaWFsaXNhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2l6ZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3RhdHVzQ29kZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vVGh1bWJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1RodW1ibmFpbFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vVHJlZU5vZGVcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1RyZWVOb2RlVHlwZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vVXRpbHNcIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWludGVybmFsLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/manifesto.js/dist-esmodule/internal.js\n");

/***/ })

};
;